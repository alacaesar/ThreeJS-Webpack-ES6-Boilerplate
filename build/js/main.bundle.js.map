{"version":3,"sources":["webpack://threejs-es6-webpack-boilerplate/./src/js/data/config.js","webpack://threejs-es6-webpack-boilerplate/./src/js/utils/detector.js","webpack://threejs-es6-webpack-boilerplate/./src/js/app/vars.js","webpack://threejs-es6-webpack-boilerplate/./src/js/app/components/renderer.js","webpack://threejs-es6-webpack-boilerplate/./src/js/app/components/camera.js","webpack://threejs-es6-webpack-boilerplate/./src/js/app/components/light.js","webpack://threejs-es6-webpack-boilerplate/./src/js/app/components/controls.js","webpack://threejs-es6-webpack-boilerplate/./src/js/app/events.js","webpack://threejs-es6-webpack-boilerplate/./src/js/utils/bufferGeometryUtils.js","webpack://threejs-es6-webpack-boilerplate/./src/js/app/fx.js","webpack://threejs-es6-webpack-boilerplate/./src/js/app/elements/globe.js","webpack://threejs-es6-webpack-boilerplate/./src/js/app/elements/earth.js","webpack://threejs-es6-webpack-boilerplate/./src/js/app/elements/stars.js","webpack://threejs-es6-webpack-boilerplate/./src/js/app/loaders/GLTFLoader.js","webpack://threejs-es6-webpack-boilerplate/./src/js/app/components/material.js","webpack://threejs-es6-webpack-boilerplate/./src/js/app/elements/rectLight.js","webpack://threejs-es6-webpack-boilerplate/./src/js/app/elements/platform.js","webpack://threejs-es6-webpack-boilerplate/./src/js/app/overlay.js","webpack://threejs-es6-webpack-boilerplate/./src/js/app/timeline.js","webpack://threejs-es6-webpack-boilerplate/./src/js/app/main.js","webpack://threejs-es6-webpack-boilerplate/./src/js/app/helpers/FilmGrainShader.js","webpack://threejs-es6-webpack-boilerplate/./src/js/app/helpers/LensDistortionShader.js","webpack://threejs-es6-webpack-boilerplate/./src/js/app.js","webpack://threejs-es6-webpack-boilerplate/./src/js/utils/orbitControls.js"],"names":["isDev","isShowingStats","isLoaded","isTweening","isRotating","isMouseMoving","isMouseOver","maxAnisotropy","dpr","easing","TWEEN","duration","model","selected","initialTypes","type","models","path","scale","texture","imageFiles","name","image","mesh","enableHelper","wireframe","translucent","material","color","emissive","colors","current","r","g","b","day","night","globe","fog","near","fog2","camera","fov","far","aspect","posX","posY","posZ","platformCamera","controls","autoRotate","autoRotateSpeed","rotateSpeed","zoomSpeed","minDistance","maxDistance","minPolarAngle","Math","PI","maxPolarAngle","minAzimuthAngle","Infinity","maxAzimuthAngle","enableDamping","dampingFactor","enableZoom","target","x","y","z","ambientLight","enabled","directionalLight","intensity","shadow","helperEnabled","bias","mapWidth","mapHeight","top","right","bottom","left","pointLight","distance","hemiLight","groundColor","canvas","window","CanvasRenderingContext2D","webgl","document","createElement","WebGLRenderingContext","getContext","e","workers","Worker","fileapi","File","FileReader","FileList","Blob","getWebGLErrorMessage","element","id","style","fontFamily","fontSize","fontWeight","textAlign","background","padding","width","margin","this","innerHTML","join","addGetWebGLMessage","parameters","parent","undefined","body","appendChild","isPaused","isPauseLoopFunctions","isMouseActive","isCutActive","platformIsInitialized","isGlobeActive","globeRadius","loopFunctions","mouseCoords","localPlanes","windowSize","height","currentMilestone","textures","milestones","coords","lat","lng","city","year","title","description","sound","time","Renderer","scene","container","threeRenderer","THREE","antialias","outputEncoding","setClearColor","setPixelRatio","devicePixelRatio","localClippingEnabled","domElement","shadowMap","Config","capabilities","getMaxAnisotropy","updateSize","addEventListener","vars","offsetWidth","offsetHeight","setSize","clear","clearDepth","render","Camera","renderer","threeCamera","position","set","updateProjectionMatrix","Light","init","visible","castShadow","mapSize","directionalLightHelper","lightName","add","Controls","orbitControls","OrbitControls","threeControls","audio","equilizer","statueInside","readTimer","dots","bip","ambient","promise","musicBtn","j","audioPaused","pointer","mouseXY","selectedID","Events","main","then","_","pause","error","classList","contains","play","onMouseMoveHandler","querySelector","btns","querySelectorAll","i","length","btn","buttonClickSwitcher","buttonHoverHandler","forEach","setAttribute","onAudioClick","onMouseDownHandler","clientX","clientY","handleIntersects","setFromCamera","intersects","intersectObjects","object","remove","markerClickHandler","_this","c","getAttribute","backClickHandler","nextClickHandler","startClickHandler","introStartClickHandler","musicClickHandler","readMoreClickHandler","closeAboutClickHandler","anime","targets","constant","complete","volume","setTimeout","DIRECTION","milestone","Number","isInteger","random","coeff","update","count","words","tickTime","setInterval","cssText","clearInterval","n","parseInt","gotoMilestone","handleTransition","BufferGeometryUtils","computeTangents","geometry","index","attributes","normal","uv","indices","array","positions","normals","uvs","nVertices","tangent","BufferAttribute","Float32Array","tangents","tan1","tan2","Vector3","vA","vB","vC","uvA","Vector2","uvB","uvC","sdir","tdir","groups","start","il","group","jl","handleTriangle","w","t","test","tmp","tmp2","n2","handleVertex","console","a","fromArray","sub","isFinite","copy","multiplyScalar","addScaledVector","v","dot","normalize","crossVectors","mergeBufferGeometries","geometries","useGroups","isIndexed","attributesUsed","Set","Object","keys","morphAttributesUsed","morphAttributes","morphTargetsRelative","mergedGeometry","BufferGeometry","offset","attributesCount","has","push","size","userData","mergedUserData","addGroup","indexOffset","mergedIndex","getX","setIndex","mergedAttribute","mergeBufferAttributes","numMorphTargets","morphAttributesToMerge","mergedMorphAttribute","TypedArray","itemSize","normalized","arrayLength","attribute","isInterleavedBufferAttribute","constructor","interleaveAttributes","stride","l","interleavedBuffer","InterleavedBuffer","res","getters","setters","iba","InterleavedBufferAttribute","k","estimateBytesUsed","mem","attr","BYTES_PER_ELEMENT","getIndex","mergeVertices","tolerance","max","EPSILON","hashToIndex","vertexCount","nextIndex","attributeNames","attrArrays","morphAttrsArrays","newIndices","morphAttr","Array","fill","map","decimalShift","log10","shiftMultiplier","pow","hash","newarray","newMorphArrays","getterFunc","m","ml","result","clone","oldAttribute","buffer","oldMorphAttribute","morphAttribute","toTrianglesDrawMode","drawMode","TrianglesDrawMode","warn","TriangleFanDrawMode","TriangleStripDrawMode","numberOfTriangles","newGeometry","clearGroups","hasWebGL","gl","convertFlatCoordsToSphereCoords","globeWidth","globeHeight","latitude","longitude","radius","cos","sin","isPointInsideCircle","centerX","centerY","pX","pY","removeFromLoop","fx","splice","blob","ring","ring2","ring3","localPlane","clouds","earthBall","matrix","markers","simplex","SimplexNoise","flies","Globe","blobGeometry","blobMaterial","emissiveIntensity","transparent","opacity","depthTest","depthWrite","flatShading","roughness","metalness","reflectivity","side","rotation","pointGeometry","pointGeometry2","pointMaterial","clippingPlanes","clipShadows","data","point","makeTranslation","applyMatrix4","globeShape","addMarker","children","_m","uniforms","value","obj","marker","grassMaterial","color1","color2","needsUpdate","vertexShader","fragmentShader","latRad","lonRad","sphere","light","light1","light2","light3","light4","basePositionAttribute","positionAttribute","vertex","vertexIndex","fromBufferAttribute","ratio","noise3D","setXYZ","computeBoundingSphere","Earth","mapTexture","load","rotate","elevMap","waterMap","cloudsTexture","bumpMap","bumpScale","specularMap","specular","animateEarth","stars","Stars","star","GLTFLoader","manager","Loader","dracoLoader","ddsLoader","GLTFRegistry","objects","get","key","removeAll","prototype","assign","create","url","onLoad","onProgress","onError","resourcePath","scope","LoaderUtils","itemStart","_onError","itemError","itemEnd","loader","FileLoader","setPath","setResponseType","crossOrigin","setWithCredentials","parse","gltf","setDRACOLoader","setDDSLoader","content","extensions","Uint8Array","BINARY_EXTENSION_HEADER_MAGIC","EXTENSIONS","KHR_BINARY_GLTF","GLTFBinaryExtension","json","JSON","asset","version","Error","extensionsUsed","extensionName","extensionsRequired","KHR_LIGHTS_PUNCTUAL","GLTFLightsExtension","KHR_MATERIALS_CLEARCOAT","GLTFMaterialsClearcoatExtension","KHR_MATERIALS_UNLIT","GLTFMaterialsUnlitExtension","KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS","GLTFMaterialsPbrSpecularGlossinessExtension","KHR_DRACO_MESH_COMPRESSION","GLTFDracoMeshCompressionExtension","MSFT_TEXTURE_DDS","GLTFTextureDDSExtension","KHR_TEXTURE_TRANSFORM","GLTFTextureTransformExtension","KHR_MESH_QUANTIZATION","GLTFMeshQuantizationExtension","indexOf","GLTFParser","extension","lightDefs","lights","loadLight","lightIndex","lightNode","lightDef","Color","range","DirectionalLight","PointLight","SpotLight","spot","innerConeAngle","outerConeAngle","angle","penumbra","decay","Promise","resolve","getMaterialType","MeshBasicMaterial","extendParams","materialParams","materialDef","parser","pending","metallicRoughness","pbrMetallicRoughness","isArray","baseColorFactor","baseColorTexture","assignTexture","all","MeshPhysicalMaterial","clearcoatFactor","clearcoat","clearcoatTexture","clearcoatRoughnessFactor","clearcoatRoughness","clearcoatRoughnessTexture","clearcoatNormalTexture","clearcoatNormalScale","BINARY_EXTENSION_CHUNK_TYPES","headerView","DataView","header","magic","slice","getUint32","chunkView","chunkIndex","byteLength","chunkLength","chunkType","contentArray","byteOffset","preload","GLTFMeshStandardSGMaterial","params","MeshStandardMaterial","isGLTFSpecularGlossinessMaterial","specularMapParsFragmentChunk","glossinessMapParsFragmentChunk","specularMapFragmentChunk","glossinessMapFragmentChunk","lightPhysicalFragmentChunk","setHex","glossiness","glossinessMap","_extraUniforms","onBeforeCompile","shader","uniformName","replace","defineProperties","defines","USE_GLOSSINESSMAP","USE_ROUGHNESSMAP","metalnessMap","roughnessMap","setValues","specularGlossinessParams","pbrSpecularGlossiness","diffuseFactor","diffuseTexture","glossinessFactor","specularFactor","specularGlossinessTexture","specGlossMapDef","createMaterial","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissiveMap","normalMap","normalMapType","TangentSpaceNormalMap","normalScale","displacementMap","displacementScale","displacementBias","alphaMap","envMap","envMapIntensity","refractionRatio","GLTFCubicSplineInterpolant","parameterPositions","sampleValues","sampleSize","resultBuffer","Interpolant","decodePrimitive","primitive","bufferViewIndex","bufferView","gltfAttributeMap","threeAttributeMap","attributeNormalizedMap","attributeTypeMap","attributeName","threeAttributeName","ATTRIBUTES","toLowerCase","accessorDef","accessors","componentType","WEBGL_COMPONENT_TYPES","getDependency","decodeDracoFile","extendTexture","transform","repeat","texCoord","source","copySampleValue_","values","valueSize","beforeStart_","afterEnd_","interpolate_","i1","t0","t1","stride2","stride3","td","p","pp","ppp","offset1","offset0","s2","s3","s0","s1","p0","m0","p1","m1","WEBGL_CONSTANTS","5120","Int8Array","5121","5122","Int16Array","5123","Uint16Array","5125","Uint32Array","5126","WEBGL_FILTERS","9728","NearestFilter","9729","LinearFilter","9984","NearestMipmapNearestFilter","9985","LinearMipmapNearestFilter","9986","NearestMipmapLinearFilter","9987","LinearMipmapLinearFilter","WEBGL_WRAPPINGS","33071","ClampToEdgeWrapping","33648","MirroredRepeatWrapping","10497","RepeatWrapping","WEBGL_TYPE_SIZES","SCALAR","VEC2","VEC3","VEC4","MAT2","MAT3","MAT4","POSITION","NORMAL","TANGENT","TEXCOORD_0","TEXCOORD_1","COLOR_0","WEIGHTS_0","JOINTS_0","PATH_PROPERTIES","translation","weights","INTERPOLATION","CUBICSPLINE","LINEAR","InterpolateLinear","STEP","InterpolateDiscrete","ALPHA_MODES","MIME_TYPE_FORMATS","RGBAFormat","RGBFormat","resolveURL","addUnknownExtensionsToUserData","knownExtensions","objectDef","gltfExtensions","assignExtrasToUserData","gltfDef","extras","updateMorphTargets","meshDef","morphTargetInfluences","targetNames","morphTargetDictionary","createAttributesKey","attributesKey","sort","options","cache","primitiveCache","textureLoader","TextureLoader","setCrossOrigin","fileLoader","addPrimitiveAttributes","primitiveDef","assignAttributeAccessor","accessorIndex","accessor","gltfAttributeName","box","Box3","min","maxDisplacement","vector","setX","abs","setY","setZ","expandByVector","boundingBox","Sphere","getCenter","center","distanceTo","boundingSphere","computeBounds","hasMorphPosition","hasMorphNormal","pendingPositionAccessors","pendingNormalAccessors","pendingAccessor","morphPositions","morphNormals","addMorphTargets","markDefs","getDependencies","dependencies","scenes","animations","cameras","nodeDefs","nodes","skinDefs","skins","meshDefs","meshes","meshReferences","meshUses","skinIndex","skinLength","joints","isBone","nodeIndex","nodeLength","nodeDef","skin","isSkinnedMesh","cacheKey","dependency","loadScene","loadNode","loadMesh","loadAccessor","loadBufferView","loadBuffer","loadMaterial","loadTexture","loadSkin","loadAnimation","loadCamera","defs","def","bufferIndex","bufferDef","buffers","uri","reject","bufferViewDef","bufferViews","sparse","pendingBufferViews","bufferAttribute","elementBytes","itemBytes","byteStride","ibSlice","floor","ibCacheKey","ib","itemSizeIndices","TypedArrayIndices","byteOffsetIndices","byteOffsetValues","sparseIndices","sparseValues","setW","textureIndex","URL","self","webkitURL","textureDef","textureExtensions","sourceURI","images","isObjectURL","mimeType","createObjectURL","getHandler","revokeObjectURL","flipY","format","sampler","samplers","magFilter","minFilter","wrapS","wrapT","mapName","mapDef","isCompressedTexture","assignFinalMaterial","useVertexTangents","useVertexColors","useFlatShading","useSkinning","useMorphTargets","useMorphNormals","isPoints","uuid","pointsMaterial","PointsMaterial","Material","sizeAttenuation","isLine","lineMaterial","LineBasicMaterial","cachedMaterial","skinning","vertexTangents","vertexColors","morphTargets","uv2","materialIndex","materialType","materials","materialExtensions","sgExtension","kmuExtension","metallicFactor","roughnessFactor","metallicRoughnessTexture","doubleSided","DoubleSide","alphaMode","alphaTest","alphaCutoff","normalTexture","occlusionTexture","strength","emissiveFactor","emissiveTexture","clearcoatExtension","encoding","sRGBEncoding","loadGeometries","primitives","createDracoPrimitive","dracoExtension","geometryPromise","mode","cached","meshIndex","FrontSide","results","SkinnedMesh","Mesh","skinWeight","normalizeSkinWeights","LineSegments","Line","LineLoop","Points","Group","cameraIndex","cameraDef","PerspectiveCamera","MathUtils","yfov","aspectRatio","znear","zfar","OrthographicCamera","xmag","ymag","skinDef","skinEntry","inverseBindMatrices","animationIndex","animationDef","pendingNodes","pendingInputAccessors","pendingOutputAccessors","pendingSamplers","pendingTargets","channels","channel","node","input","output","inputAccessors","outputAccessors","tracks","inputAccessor","outputAccessor","TypedKeyframeTrack","updateMatrix","matrixAutoUpdate","NumberKeyframeTrack","QuaternionKeyframeTrack","VectorKeyframeTrack","targetName","interpolation","traverse","isMesh","outputArray","scaled","track","createInterpolant","times","getValueSize","isInterpolantFactoryMethodGLTFCubicSpline","AnimationClip","instanceNum","o","Bone","Object3D","PropertyBinding","Matrix4","quaternion","buildNodeHierachy","nodeId","parentObject","pendingJoints","jointNodes","bones","boneInverses","jointNode","mat","bind","Skeleton","matrixWorld","child","sceneIndex","sceneDef","nodeIds","basic","standard","wire","RectLight","config","lightBox","rectLight","rectLightMesh","rectLightMeshBack","rectBox","platformConfig","lightConfig","mixer","variants","platform","h","s","modelHolderObject","Platform","landGeometry","landMaterial","land","addGrass","addFireflies","addModel","removeModel","clip","clipAction","animateModel","animateFlies","delta","saplingGeometry","row","noise2D","grass","segment","alpha","place","events","curtain","Overlay","getElementById","initText","initGlobe","ID","textWrappers","text","textContent","split","replaceAll","arr","ul","li","an","milestoneClickHandler","inside","texts","svg","stones","loop","translateY","delay","el","h2","bubble","innerText","_h","getBoundingClientRect","div","callback","section","animate","about","ps","scaleY","sections","composer","composer2","renderPass","renderPass2","distortPass","grainPass","fxaaPass","Timeline","overlay","preloader","fixSections","intro","earth","animateGlobe","startGlobe","animateCurtain","loaded","total","filename","addEarth","includes","FilmGrainShader","tDiffuse","noiseOffset","LensDistortionShader","BAND_MODE","CHROMA_SAMPLES","baseIor","bandOffset","jitterIntensity","jitterOffset","enableNoise","noiseSpeed","noiseIntensity","enableDistortion","samples","exposure","bloomStrength","bloomThreshold","bloomRadius","activeScene","composers","Main","clock","startColor","scene2","RenderPass","ShaderPass","FXAAShader","EffectComposer","innerWidth","innerHeight","addPass","timeline","wrapDuration","K","lookAt","dispose","getDelta","Date","now","vec","requestAnimationFrame","Detector","module","exports","MOUSE","OrbitConstraint","minZoom","maxZoom","theta","phi","quat","quatInverse","lastPosition","lastQuaternion","EPS","phiDelta","thetaDelta","panOffset","zoomChanged","getPolarAngle","getAzimuthalAngle","rotateLeft","rotateUp","panLeft","te","elements","panUp","pan","deltaX","deltaY","screenWidth","screenHeight","targetDistance","tan","dollyIn","dollyScale","zoom","dollyOut","Quaternion","setFromUnitVectors","up","inverse","applyQuaternion","atan2","sqrt","distanceToSquared","constraint","defineProperty","enableRotate","enablePan","keyPanSpeed","enableKeys","LEFT","UP","RIGHT","BOTTOM","mouseButtons","ORBIT","ZOOM","MIDDLE","PAN","rotateStart","rotateEnd","rotateDelta","panStart","panEnd","panDelta","dollyStart","dollyEnd","dollyDelta","STATE","state","target0","position0","zoom0","changeEvent","startEvent","endEvent","clientWidth","clientHeight","getZoomScale","onMouseDown","event","preventDefault","button","onMouseMove","onMouseUp","dispatchEvent","subVectors","removeEventListener","onMouseWheel","stopPropagation","wheelDelta","detail","onKeyDown","keyCode","touchstart","touches","pageX","pageY","dx","dy","touchmove","touchend","contextmenu","reset","EventDispatcher","noZoom","noRotate","noPan","noKeys","staticMoving","dynamicDampingFactor"],"mappings":"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","file":"main.bundle.js","sourcesContent":["import TWEEN from '@tweenjs/tween.js';\n\n// This object contains the state of the app\nexport default {\n  isDev: false,\n  isShowingStats: false,\n  isLoaded: false,\n  isTweening: false,\n  isRotating: false,\n  isMouseMoving: false,\n  isMouseOver: false,\n  maxAnisotropy: 1,\n  dpr: 1,\n  easing: TWEEN.Easing.Quadratic.InOut,\n  duration: 500,\n  model: {\n    selected: 0,\n    initialTypes: ['gltf', 'box', 'object'],\n    type: 'gltf'\n  },\n  models: [\n    {\n      path: './assets/models/BoxAnimated.gltf',\n      scale: 20,\n      type: 'gltf'\n    },\n    {\n      path: './assets/models/duck.gltf',\n      scale: 20,\n      type: 'box'\n    },\n    {\n      path: './assets/models/Teapot.json',\n      scale: 20,\n      type: 'object'\n    }\n  ],\n  texture: {\n    path: './assets/textures/',\n    imageFiles: [\n      { name: 'UV', image: 'UV_Grid_Sm.jpg' }\n    ]\n  },\n  mesh: {\n    enableHelper: false,\n    wireframe: false,\n    translucent: false,\n    material: {\n      color: 0xffffff,\n      emissive: 0xffffff\n    }\n  },\n  colors:{\n    current: {r:79, g:161, b:216},\n    day: {r:79, g:161, b:216},\n    night: {r:21, g:17, b:31},\n    globe: {r:0, g:61, b:178}\n  },\n  fog: {\n    color: 0x003DB2,\n    near: 0.002\n  },\n  fog2: {\n    color: 0x002B7E,\n    near: 0.004\n  },\n  camera: {\n    fov: 45,\n    near: 1,\n    far: 3000,\n    aspect: 1,\n    posX: 0,\n    posY: 0,\n    posZ: 300\n  },\n  platformCamera:{\n    posX: 0,\n    posY: 0,\n    posZ: 60\n  },\n  controls: {\n    autoRotate: false,\n    autoRotateSpeed: -0.5,\n    rotateSpeed: 0.5,\n    zoomSpeed: 0.8,\n    minDistance: 160,\n    maxDistance: 400,\n    minPolarAngle: Math.PI / 5,\n    maxPolarAngle: Math.PI / 2,\n    minAzimuthAngle: -Infinity,\n    maxAzimuthAngle: Infinity,\n    enableDamping: true,\n    dampingFactor: 0.5,\n    enableZoom: true,\n    target: {\n      x: 0,\n      y: 0,\n      z: 0\n    }\n  },\n  ambientLight: {\n    enabled: true,\n    color: 0x333333\n  },\n  directionalLight: {\n    enabled: true,\n    color: 0xf0f0f0,\n    intensity: 0.2,\n    x: -75,\n    y: 180,\n    z: 150\n  },\n  shadow: {\n    enabled: true,\n    helperEnabled: false,\n    bias: 0,\n    mapWidth: 2048,\n    mapHeight: 2048,\n    near: 250,\n    far: 400,\n    top: 100,\n    right: 100,\n    bottom: -100,\n    left: -100\n  },\n  pointLight: {\n    enabled: true,\n    color: 0xffffff,\n    intensity: 0.34,\n    distance: 115,\n    x: 0,\n    y: 0,\n    z: 0\n  },\n  hemiLight: {\n    enabled: true,\n    color: 0xc8c8c8,\n    groundColor: 0xffffff,\n    intensity: 0.55,\n    x: 0,\n    y: 0,\n    z: 0\n  }\n};\n","/**\n * @author alteredq / http://alteredqualia.com/\n * @author mr.doob / http://mrdoob.com/\n */\n\nexport default {\n  canvas: !!window.CanvasRenderingContext2D,\n  webgl: (function() {\n    try {\n      var canvas = document.createElement('canvas');\n\n      return !!(window.WebGLRenderingContext && (canvas.getContext('webgl') || canvas.getContext('experimental-webgl')));\n    } catch(e) {\n      return false;\n    }\n  })(),\n\n  workers: !!window.Worker,\n  fileapi: window.File && window.FileReader && window.FileList && window.Blob,\n\n  getWebGLErrorMessage: function() {\n    var element = document.createElement('div');\n    element.id = 'webgl-error-message';\n    element.style.fontFamily = 'monospace';\n    element.style.fontSize = '13px';\n    element.style.fontWeight = 'normal';\n    element.style.textAlign = 'center';\n    element.style.background = '#fff';\n    element.style.color = '#000';\n    element.style.padding = '1.5em';\n    element.style.width = '400px';\n    element.style.margin = '5em auto 0';\n\n    if(!this.webgl) {\n      element.innerHTML = window.WebGLRenderingContext ? [\n        'Your graphics card does not seem to support <a href=\"http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation\" style=\"color:#000000\">WebGL</a>.<br />',\n        'Find out how to get it <a href=\"http://get.webgl.org/\" style=\"color:#000000\">here</a>.'\n      ].join('\\n') : [\n        'Your browser does not seem to support <a href=\"http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation\" style=\"color:#000000\">WebGL</a>.<br/>',\n        'Find out how to get it <a href=\"http://get.webgl.org/\" style=\"color:#000000\">here</a>.'\n      ].join('\\n');\n    }\n\n    return element;\n  },\n\n  addGetWebGLMessage: function(parameters) {\n    var parent, id, element;\n\n    parameters = parameters || {};\n\n    parent = parameters.parent !== undefined ? parameters.parent : document.body;\n    id = parameters.id !== undefined ? parameters.id : 'oldie';\n\n    element = this.getWebGLErrorMessage();\n    element.id = id;\n\n    parent.appendChild(element);\n  }\n};\n","\nvar vars = {\n  isPaused: false,\n  isPauseLoopFunctions: false,\n  isMouseActive: false,\n  isCutActive: false,\n  platformIsInitialized: false,\n  isGlobeActive: false,\n\n  globeRadius:100,\n  loopFunctions: [],\n  mouseCoords: {x:0, y:0},\n  localPlanes: [],\n\n  windowSize:{width:0, height:0},\n\n  currentMilestone: null,\n\n  // loaded textures will be stored here.\n  textures:[],\n\n  // default paths stored here\n  path:{\n    textures: '/assets/textures/',\n  },\n\n  milestones: [\n    {\n      id: 0,\n      coords:{lat:42.296928, lng:-71.291862},\n      city:'Wellesley',\n      year: '2011',\n      model: '11_The-start.glb',\n      title: 'Where it all <$began$>',\n      description: 'Founded in 2011 with a focus on mobile technology solutions, Mobiquity continuously adapted in response to client needs and evolving technology.',\n      sound: '/vo/VO_Milestone_011.mp3',\n      time:9,\n    },\n    {\n      id: 1,\n      coords:{lat:47.606209, lng:-122.332069},\n      city:'Seattle',\n      year: '2011',\n      model: '03_AWS.glb',\n      title: 'From partnership to <$events$> <$partner$>',\n      description: 'Mobiquity has worked with AWS as an APN Premier Consulting Partner since 2011 to deliver 100% cloud-based innovation to its clients, including design & dev of the AWS re:Invent app since 2016.',\n      sound: '/vo/VO_Milestone_003.mp3',\n      time:15,\n    },\n    {\n      id: 2,\n      coords:{lat:38.63028, lng:-90.20031},\n      city:'St Louis, MO',\n      year: '2012',\n      model: '01_Self-service-kiosk.glb',\n      title: 'Panera self-service kiosks',\n      description: 'Panera wanted to set the new digital standard for quick service restaurants. Mobiquity helped them create an omnichannel eCommerce platform and introduced self-service kiosks & mobile ordering.',\n      sound: '/vo/VO_Milestone_001.mp3',\n      time:11,\n    },\n    {\n      id: 3,\n      coords:{lat:23.022505, lng:72.571365},\n      city:'Ahmedabad',\n      year: '2015',\n      model: '12_Expansion-overseas.glb',\n      title: 'Going <$global$>',\n      description: 'With the acquisitions of Xaton and Morgan Clark, Mobiquity extended its operations into Europe & India.',\n      sound: '/vo/VO_Milestone_012.mp3',\n      time:6,\n    },\n    {\n      id: 4,\n      coords:{lat:50.850346, lng:4.351721},\n      city:'Amsterdam',\n      year: '2016',\n      model: '05_Cloud-based-protection.glb',\n      title: 'Cloud-based fraud <$protection$>',\n      description: 'Surepay introduced an IBAN name check to fight fraudulent payment transactions in the Netherlands with an AWS cloud-based mobile solution built using Mobiquity’s Digital Traction Model.',\n      sound: '/vo/VO_Milestone_005.mp3',\n      time:10,\n    },\n    {\n      id: 5,\n      coords:{lat:37.774929, lng:-122.419418},\n      city:'San Francisco',\n      year: '2017',\n      model: '02_World_s-first-digital-pill.glb',\n      title: 'Patient health goes <$digital$>',\n      description: 'Otsuka worked with Mobiquity to design and develop a breakthrough drug-device combination product. Its new data on drug consumption helps patients, caregivers & families stay informed.',\n      sound: '/vo/VO_Milestone_002.mp3',\n      time: 11,\n    },\n    {\n      id: 6,\n      coords:{lat:52.344718, lng:9.799318},\n      city:'Amsterdam',\n      year: '2018',\n      model: '06_Digital-Traction.glb',\n      title: 'Accelerating Innovation with <$Digtial$> <$Traction$>',\n      description: 'A large European bank establishes an innovation factory with Mobiquity, using its Digital Traction Model, that has since worked on 15+ value propositions over the course of 3 years.',\n      sound: '/vo/VO_Milestone_006.mp3',\n      time:11,\n    },\n    {\n      id: 7,\n      coords:{lat:14.604847, lng:120.77997},\n      city:'Manila',\n      year: '2018',\n      model: '08_BPI.glb',\n      title: 'A <$Better$> Digital Banking Experience',\n      description: 'BPI engaged Mobiquity to go live with an online portal and mobile banking offering. BPI Online has hit the 4 million+ mark for enrolled users, and it experienced a transaction surge of 87% in 2019.',\n      sound: '/vo/VO_Milestone_008.mp3',\n      time:14,\n    },\n    {\n      id: 8,\n      coords:{lat:35.794325, lng:-78.642417},\n      city:'North Carolina',\n      year: '2018',\n      model: '09_Alexa.glb',\n      title: '<$Talking$> Turkey in the kitchen',\n      description: 'Butterball worked with Mobiquity to design and launch a multi-modal Amazon Alexa skill that provides a voice channel for US consumers to find answers to their most common turkey topics.',\n      sound: '/vo/VO_Milestone_009.mp3',\n      time:10,\n    },\n    {\n      id: 9,\n      coords:{lat:-13.545140, lng:-58.819939},\n      city:'Latin America',\n      year: '2018',\n      model: '10_Secure-Scalalble-Payments.glb',\n      title: 'Secure, Scalable Payments Gateway',\n      description: 'To ensure scalable access to data services & micropayment processing for 30M+ users, a large LatAm telecom worked with Mobiquity to create a digital engagement platform & payment gateway.',\n      sound: '/vo/VO_Milestone_010.mp3',\n      time:11,\n    },\n    {\n      id: 10,\n      coords:{lat:26.0667001, lng:50.557701},\n      city:'Manama',\n      year: '2019',\n      model: '04_ILA.glb',\n      title: 'Launch of <$ila$> <$Bank$>',\n      description: 'Bank ABC partnered with Mobiquity from strategy & idea inception through to implementation & the launch of Ila Bank; the first digital, mobile-only bank in Bahrain.',\n      sound: '/vo/VO_Milestone_004.mp3',\n      time:10,\n    },\n    {\n      id: 11,\n      coords:{lat:53.219383, lng:6.566502},\n      city:'Amsterdam',\n      year: '2019',\n      model: '13_500-employees.glb',\n      title: '500 employees',\n      description: 'Celebrations across the offices marked the significance of Mobiquity\\'s 500th employee.',\n      sound: '/vo/VO_Milestone_013.mp3',\n      time:5,\n    },\n    {\n      id: 12,\n      coords:{lat:13.08268, lng:80.270721},\n      city:'Chennai',\n      year: '2019',\n      model: '15_Hexaware.glb',\n      title: 'Hello, <$Hexaware$>',\n      description: 'In 2019, Mobiquity is acquired by Hexaware Technologies to accelerate the IT engineering services firm\\'s offering around customer experience transformation.',\n      sound: '/vo/VO_Milestone_015.mp3',\n      time:10,\n    },\n    {\n      id: 13,\n      coords:{lat:41.203323, lng:-77.194527},\n      city:'Pennsylvania',\n      year: '2020',\n      model: '07_Wawa.glb',\n      title: 'Taking convenience to the <$next$> <$level$>',\n      description: 'A customer since 2013, Wawa worked with Mobiquity to deliver improved convenience during the covid pandemic by rolling out additional mobile app features, like curbside & in-app delivery.',\n      sound: '/vo/VO_Milestone_007.mp3',\n      time:11,\n    },\n    {\n      id: 14,\n      coords:{lat:19.039624, lng:72.988701},\n      city:'Mumbai',\n      year: '2020',\n      model: '18_1000-employees.glb',\n      title: '1000 employees',\n      description: 'With the addition of Hexaware Interactive folks to the Mobiquity team, we cross the 1,000 people mark.',\n      sound: '/vo/VO_Milestone_018.mp3',\n      time: 6,\n    },\n    {\n      id: 15,\n      coords:{lat:49.838994, lng:8.691392},\n      city:'Amsterdam',\n      year: '2021',\n      model: '14_Mobster-Award.glb',\n      title: 'We celebrate <$Mobstars!$>',\n      description: 'From Mobstar awards to Digital First Awards, Mobiquity celebrates and thanks our colleages for their contributions to our clients and our communities.',\n      sound: '/vo/VO_Milestone_014.mp3',\n      time:8,\n    },\n    {\n      id: 16,\n      coords:{lat:-33.860097, lng:151.222226},\n      city:'Sydney',\n      year: '2021',\n      model: '16_Setting-foot-outback.glb',\n      title: 'Setting foot in the outback',\n      description: 'Mobiquity hires its first employee in Australia in 2021, marking its expanision into the region.',\n      sound: '/vo/VO_Milestone_016.mp3',\n      time:7,\n    },\n    {\n      id: 17,\n      coords:{lat:39.830555, lng:-75.111105},\n      city:'Philadelphia',\n      year: '2021',\n      model: '17_Awards.glb',\n      title: 'And the <$award$> goes to...',\n      description: 'From Top Consulting Firm to diversity inclusion awards, partner awards and analyst recognitions, the word gets out that Mobiquity is a great place to work.',\n      sound: '/vo/VO_Milestone_017.mp3',\n      time:10,\n    },\n    {\n      id: 18,\n      coords:{lat:18.232057, lng:74.017494},\n      city:'Pune',\n      year: '2021',\n      model: '19_India.glb',\n      title: 'We keep expanding in <$India$>',\n      description: 'In 2021, Mobiquity opens its third location in India and announces plans to double its footprint in the country. We now have offices in Ahmedabad, Pune and Hyderabad.',\n      sound: '/vo/VO_Milestone_019.mp3',\n      time:11,\n    },\n    {\n      id: 19,\n      //coords:{lat:40.779371, lng:-74.064078},\n      coords:{lat:-33.924870, lng:18.424055},\n      city:'Cape Town',\n      year: '2021',\n      model: '20_Next-frontiers.glb',\n      title: 'The next <$frontier$>',\n      description: 'Mobiquity marks its 10 year anniversary with a renewed focus on digital products and sets course to help brands achieve brand gravity in the digital space.',\n      sound: '/vo/VO_Milestone_020.mp3',\n      time:10,\n    },\n  ],\n\n}\n\nexport default vars;\n","import * as THREE from 'three';\n\nimport Config from '../../data/config';\nimport vars from '../vars';\n\n// Main webGL renderer class\nexport default class Renderer {\n  constructor(scene, container) {\n    // Properties\n    this.scene = scene;\n    this.container = container;\n\n    // Create WebGL renderer and set its antialias\n    this.threeRenderer = new THREE.WebGLRenderer({antialias: true});\n    this.threeRenderer.outputEncoding = THREE.sRGBEncoding;\n\n    // Set clear color to fog to enable fog or to hex color for no fog\n    this.threeRenderer.setClearColor(scene.fog.color);\n    this.threeRenderer.setPixelRatio(window.devicePixelRatio); // For retina\n\n    /*\n    var globalPlane = new THREE.Plane( new THREE.Vector3( - 1, 0, 0 ), 0);\n    this.threeRenderer.clippingPlanes = [ globalPlane ];\n    */\n    this.threeRenderer.localClippingEnabled = true;\n\n    // Appends canvas\n    container.appendChild(this.threeRenderer.domElement);\n\n    // Shadow map options\n    this.threeRenderer.shadowMap.enabled = true;\n    this.threeRenderer.shadowMap.type = THREE.PCFSoftShadowMap;\n\n    // Get anisotropy for textures\n    Config.maxAnisotropy = this.threeRenderer.capabilities.getMaxAnisotropy();\n\n    // Initial size update set to canvas container\n    this.updateSize();\n\n    // Listeners\n    document.addEventListener('DOMContentLoaded', () => this.updateSize(), false);\n    window.addEventListener('resize', () => this.updateSize(), false);\n  }\n\n  updateSize() {\n    vars.windowSize = {width:this.container.offsetWidth, height:this.container.offsetHeight};\n    this.threeRenderer.setSize(this.container.offsetWidth, this.container.offsetHeight);\n  }\n\n  render(scene, camera) {\n    // Renders scene to canvas target\n    //this.threeRenderer.autoClear = true;\n    this.threeRenderer.clear();\n    this.threeRenderer.clearDepth();\n    this.threeRenderer.render(scene, camera);\n  }\n}\n","import * as THREE from 'three';\n\nimport Config from '../../data/config';\n\n// Class that creates and updates the main camera\nexport default class Camera {\n  constructor(renderer) {\n    const width = renderer.domElement.width;\n    const height = renderer.domElement.height;\n\n    // Create and position a Perspective Camera\n    this.threeCamera = new THREE.PerspectiveCamera(Config.camera.fov, width / height, Config.camera.near, Config.camera.far);\n    this.threeCamera.position.set(Config.camera.posX, Config.camera.posY, Config.camera.posZ);\n\n    // Initial sizing\n    this.updateSize(renderer);\n    \n    // Listeners\n    window.addEventListener('resize', () => this.updateSize(renderer), false);\n  }\n\n  updateSize(renderer) {\n    // Update camera aspect ratio with window aspect ratio\n    this.threeCamera.aspect = renderer.domElement.width / renderer.domElement.height;\n\n    // Always call updateProjectionMatrix on camera change\n    this.threeCamera.updateProjectionMatrix();\n  }\n}\n","import * as THREE from 'three';\n\nimport Config from '../../data/config';\n\n// Sets up and places all lights in scene\nexport default class Light {\n  constructor(scene) {\n    this.scene = scene;\n\n    this.init();\n  }\n\n  init() {\n    // Ambient\n    this.ambientLight = new THREE.AmbientLight(Config.ambientLight.color);\n    this.ambientLight.visible = Config.ambientLight.enabled;\n\n    // Point light\n    this.pointLight = new THREE.PointLight(Config.pointLight.color, Config.pointLight.intensity, Config.pointLight.distance);\n    this.pointLight.position.set(Config.pointLight.x, Config.pointLight.y, Config.pointLight.z);\n    this.pointLight.visible = Config.pointLight.enabled;\n\n    // Directional light\n    this.directionalLight = new THREE.DirectionalLight(Config.directionalLight.color, Config.directionalLight.intensity);\n    this.directionalLight.position.set(Config.directionalLight.x, Config.directionalLight.y, Config.directionalLight.z);\n    this.directionalLight.visible = Config.directionalLight.enabled;\n\n    // Shadow map\n    this.directionalLight.castShadow = Config.shadow.enabled;\n    this.directionalLight.shadow.bias = Config.shadow.bias;\n    this.directionalLight.shadow.camera.near = Config.shadow.near;\n    this.directionalLight.shadow.camera.far = Config.shadow.far;\n    this.directionalLight.shadow.camera.left = Config.shadow.left;\n    this.directionalLight.shadow.camera.right = Config.shadow.right;\n    this.directionalLight.shadow.camera.top = Config.shadow.top;\n    this.directionalLight.shadow.camera.bottom = Config.shadow.bottom;\n    this.directionalLight.shadow.mapSize.width = Config.shadow.mapWidth;\n    this.directionalLight.shadow.mapSize.height = Config.shadow.mapHeight;\n\n    // Shadow camera helper\n    if(Config.isDev) {\n      this.directionalLightHelper = new THREE.CameraHelper(this.directionalLight.shadow.camera);\n      this.directionalLightHelper.visible = Config.shadow.helperEnabled;\n    }\n    // Hemisphere light\n    this.hemiLight = new THREE.HemisphereLight(Config.hemiLight.color, Config.hemiLight.groundColor, Config.hemiLight.intensity);\n    this.hemiLight.position.set(Config.hemiLight.x, Config.hemiLight.y, Config.hemiLight.z);\n    this.hemiLight.visible = Config.hemiLight.enabled;\n  }\n\n  place(lightName) {\n    switch(lightName) {\n      case 'ambient':\n        this.scene.add(this.ambientLight);\n        break;\n\n      case 'directional':\n        this.scene.add(this.directionalLight);\n        if(Config.isDev) {\n          this.scene.add(this.directionalLightHelper);\n        }\n        break;\n\n      case 'point':\n        this.scene.add(this.pointLight);\n        break;\n\n      case 'hemi':\n        this.scene.add(this.hemiLight);\n        break;\n    }\n  }\n}\n","import * as THREE from 'three';\n\nimport OrbitControls from '../../utils/orbitControls';\nimport Config from '../../data/config';\n\n// Controls based on orbit controls\nexport default class Controls {\n  constructor(camera, container) {\n    // Orbit controls first needs to pass in THREE to constructor\n    const orbitControls = new OrbitControls(THREE);\n    this.threeControls = new orbitControls(camera, container);\n\n    this.init();\n  }\n\n  init() {\n    this.threeControls.target.set(Config.controls.target.x, Config.controls.target.y, Config.controls.target.z);\n    this.threeControls.autoRotate = Config.controls.autoRotate;\n    this.threeControls.autoRotateSpeed = Config.controls.autoRotateSpeed;\n    this.threeControls.rotateSpeed = Config.controls.rotateSpeed;\n    this.threeControls.zoomSpeed = Config.controls.zoomSpeed;\n    this.threeControls.minDistance = Config.controls.minDistance;\n    this.threeControls.maxDistance = Config.controls.maxDistance;\n    this.threeControls.minPolarAngle = Config.controls.minPolarAngle;\n    this.threeControls.maxPolarAngle = Config.controls.maxPolarAngle;\n    this.threeControls.enableDamping = Config.controls.enableDamping;\n    this.threeControls.enableZoom = Config.controls.enableZoom;\n    this.threeControls.dampingFactor = Config.controls.dampingFactor;\n  }\n}\n","import * as THREE from 'three';\nimport anime, { timeline } from \"animejs\";\nimport vars from \"./vars\";\n\nlet audio, equilizer, statueInside, readTimer, j = 0, audioPaused = true;\n\nlet pointer = new THREE.Raycaster(),\n    mouseXY = new THREE.Vector2(),\n    selected = null,\n    selectedID = null,\n    dots;\n\nlet bip, ambient, promise, musicBtn;\n\n// Controls based on orbit controls\nexport default class Events {\n  constructor(main) {\n    // do nothing;\n    this.main = main;\n  }\n\n  init(main) {\n\n    window.addEventListener(\"blur\", () => {\n      vars.isPaused = true;\n      if (promise !== undefined) {\n        promise.then(_ => {\n          ambient.pause();\n        }).catch(error => {\n          // do nothing\n        });\n      }\n    } );\n    window.addEventListener(\"focus\", () => {\n        vars.isPaused = false; \n        main.render();\n        if(!musicBtn.classList.contains(\"paused\")){\n          ambient.play();\n        }\n    } );\n\n    document.addEventListener(\"mousemove\", (e)=> this.onMouseMoveHandler(e), false);\n    bip = document.querySelector(\"audio.bip\");\n\n    let btns = document.querySelectorAll(\"button\");\n\n    for(var i=0; i<btns.length; ++i){\n      let btn = btns[i];\n      btn.addEventListener(\"click\", (e)=> this.buttonClickSwitcher(e), false );\n      btn.addEventListener(\"mouseenter\", (e)=> this.buttonHoverHandler(e), false);\n    }\n\n    musicBtn = document.querySelector(\"button.music\");\n    ambient = document.querySelector(\"audio.ambient\");\n    audio = document.querySelector(\"audio.vo\");\n    equilizer = document.querySelector(\".equilizer\");\n    equilizer.querySelectorAll(\"animate\").forEach(element => { element.setAttribute(\"repeatCount\", \"0\"); });\n    statueInside = document.querySelector(\".statue .inside\");\n    statueInside.addEventListener(\"click\", (e)=> this.onAudioClick(e), false );\n\n    main.container.addEventListener('click', (e)=> this.onMouseDownHandler(e), false);\n\n    dots = document.querySelectorAll(\"ul.milestones li\");\n\n  }\n\n  buttonHoverHandler(e){\n    promise = bip.play();\n    if (promise !== undefined) {\n      promise.then(_ => {\n        // Autoplay started!\n      }).catch(error => {\n        // Autoplay was prevented.\n        // Show a \"Play\" button so that user can start playback.\n      });\n    }\n  }\n\n  onMouseMoveHandler(e){\n    vars.mouseCoords = {x:e.clientX/vars.windowSize.width, y:e.clientY/vars.windowSize.height};\n    if(vars.isGlobeActive) this.handleIntersects(e);\n  }\n\n  handleIntersects(e){\n    mouseXY.set(\n      (e.clientX / vars.windowSize.width) * 2 - 1,\n      - (e.clientY / vars.windowSize.height) * 2+1\n    );\n\n    pointer.setFromCamera( mouseXY, vars.main.camera.threeCamera );\n\n    var intersects = pointer.intersectObjects( vars.main.globe.markers.children, true );\n    if( intersects.length > 0){\n      selected = intersects[0].object;\n      if( selectedID != selected.name){\n        selectedID = selected.name;\n        dots.forEach(element => {element.classList.remove(\"hover\"); });\n        dots[selected.name].classList.add(\"hover\");\n        this.buttonHoverHandler();\n      }\n    }else{\n      dots.forEach(element => {element.classList.remove(\"hover\"); });\n      selected = null;\n      selectedID = null;\n    }\n  }\n\n  onMouseDownHandler(){\n    if(selected != null){\n      this.markerClickHandler(selected.name);\n      selected = null;\n    }\n  }\n\n  buttonClickSwitcher(e){\n    let _this = this;\n    let c = e.target.getAttribute(\"id\");\n    bip.play();\n    switch(c){\n      case \"backBtn\" :\n        _this.backClickHandler();\n      break;\n      case \"nextBtn\" :\n        _this.nextClickHandler(\"NEXT\");\n      break;\n      case \"previousBtn\" :\n        _this.nextClickHandler(\"PREV\");\n      break;\n      case \"startBtn\" :\n        _this.startClickHandler();\n      break;\n      case \"introStartBtn\" :\n        _this.introStartClickHandler();\n      break;\n      case \"musicBtn\" :\n        _this.musicClickHandler();\n      break;\n      case \"readMoreBtn\" :\n        _this.readMoreClickHandler();\n      break;\n      case \"closeAboutBtn\" :\n        _this.closeAboutClickHandler();\n      break;\n    }\n  }\n\n  readMoreClickHandler(){\n    vars.isPaused = true;\n    vars.overlay.animateAbout();\n  }\n\n  closeAboutClickHandler(){\n    vars.isPaused = false;\n    vars.overlay.animateAboutClose();\n    vars.main.render();\n  }\n\n  musicClickHandler(){\n    if(musicBtn.classList.contains(\"paused\")){\n      musicBtn.classList.remove(\"paused\");\n      ambient.play();\n    }else{\n      musicBtn.classList.add(\"paused\");\n      ambient.pause();\n    }\n  }\n\n  introStartClickHandler(){\n    vars.isCutActive = false;\n    anime.timeline().add({\n      targets:vars.localPlanes,\n      constant: -500,\n      duration: 1000,\n      easing: \"easeInOutCubic\"\n    }).add({\n      targets:vars.localPlanes[1],\n      constant: 500,\n      duration: 1000,\n      easing: \"easeInOutCubic\",\n      complete:()=>{\n        vars.main.earth.dispose();\n      }\n    }, 0).add({\n      targets:vars.main.camera.threeCamera.position,\n      z: 340,\n      duration: 2000,\n      easing: \"easeInOutCubic\"\n    }, 0);\n\n    vars.main.timeline.goto.globe();\n\n    ambient.volume = .50;\n    ambient.play();\n    musicBtn.classList.remove(\"paused\");\n\n    setTimeout(()=>{\n      vars.main.globe.addMarkers();\n      setTimeout(()=>{ \n        vars.main.globe.showMarkers();\n        vars.main.controls.threeControls.enabled = true;\n        vars.isGlobeActive = true;\n      }, 1000);\n    }, 2000);\n  }\n\n  startClickHandler(){\n    vars.overlay.startGlobe();\n  }\n\n  nextClickHandler(DIRECTION){\n\n    j = 0;\n\n    vars.isMouseActive = false;\n    vars.isPauseLoopFunctions = true;\n\n    let milestone;\n\n    if(DIRECTION == \"NEXT\"){\n      milestone = vars.currentMilestone.id < vars.milestones.length-1 ? \n      vars.milestones[vars.currentMilestone.id+1] :\n      vars.milestones[0];\n    }else if(DIRECTION == \"PREV\"){\n      milestone = vars.currentMilestone.id > 0 ? \n      vars.milestones[vars.currentMilestone.id-1] :\n      vars.milestones[vars.milestones.length-1];\n    }else if(Number.isInteger(DIRECTION)){\n      milestone = vars.milestones[DIRECTION];\n    }\n\n    vars.currentMilestone = milestone;\n    vars.overlay.initCurtain(milestone);\n\n    anime({\n      targets: vars.main.platform.scene.rotation,\n      y:(Math.random() - .5) * 200 * THREE.Math.DEG2RAD,\n      x: Math.random() * 100 * THREE.Math.DEG2RAD,\n      easing: 'easeInOutExpo',\n      duration:2000, \n    });\n    \n    vars.main.warp(\"IN\", ()=>{\n      vars.main.timeline.goto.curtain();\n      setTimeout(() => {\n        vars.overlay.initStatue();\n        vars.main.resetPlatform();\n        vars.main.platform.addModel();\n        vars.overlay.animateCurtain(\"OUT\", ()=>{\n\n          vars.main.warp(\"OUT\", ()=>{\n            vars.main.timeline.goto.section();\n            vars.isMouseActive = true;\n            vars.isPauseLoopFunctions = false;\n          });\n        });\n      }, 1000);\n    });\n  }\n\n  backClickHandler(){\n    let milestone = vars.currentMilestone;\n\n    vars.isMouseActive = false;\n    vars.isPauseLoopFunctions = true;\n\n    vars.main.warp(\"RIN\", ()=>{\n      vars.main.flipScene(0);\n      vars.main.disposePlatform();\n\n      var altitude = 100;\n      var coeff = 1+ altitude/(vars.globeRadius + 12);\n\n      vars.main.camera.threeCamera.position.set( milestone.position.x * coeff, milestone.position.y * coeff, milestone.position.z * coeff);\n      vars.main.camera.threeCamera.lookAt(0, 0, 0);\n\n      vars.main.warp(\"ROUT\", ()=>{\n\n        var altitude = 200;\n        var coeff = 1+ altitude/(vars.globeRadius + 12);\n\n        anime({\n          targets:vars.main.camera.threeCamera.position,\n          x: milestone.position.x * coeff,\n          y: milestone.position.y * coeff,\n          z: milestone.position.z * coeff,\n          duration:2000,\n          easing: 'easeOutCubic',\n          update: ()=>{ vars.main.camera.threeCamera.lookAt(0, 0, 0); },\n        })\n\n        vars.isMouseActive = true;\n        vars.isPauseLoopFunctions = false;\n        vars.isGlobeActive = true;\n\n        vars.main.timeline.goto.globe();\n      });\n    });\n  }\n\n  onAudioClick(e){\n\n    if(audioPaused){\n\n      audioPaused = false;\n\n      let count = statueInside.querySelector(\"p.off\").getAttribute(\"data-count\");\n      let words = statueInside.querySelectorAll(\"p.off span.letter\");\n      let time = vars.currentMilestone.time;\n      let tickTime = (time*0.92)/count;\n\n      audio.play();\n      equilizer.querySelectorAll(\"animate\").forEach(element => { element.setAttribute(\"repeatCount\", \"indefinite\"); });\n\n      statueInside.classList.add(\"cursor-pause\");\n      statueInside.classList.remove(\"cursor-play\");\n\n      readTimer = setInterval(()=>{ \n        words[j].style.cssText = \"opacity:1\";\n        if(j < words.length - 1){ \n          j++; \n        }else{\n          clearInterval(readTimer);\n          statueInside.classList.remove(\"cursor-pause\");\n          statueInside.classList.add(\"cursor-play\");\n          equilizer.querySelectorAll(\"animate\").forEach(element => { element.setAttribute(\"repeatCount\", \"0\"); });\n          j=0;\n          audioPaused = true;\n        }\n      \n      }, tickTime * 1000);\n\n    }else{\n      audioPaused = true;\n      audio.pause();\n      equilizer.querySelectorAll(\"animate\").forEach(element => { element.setAttribute(\"repeatCount\", \"0\"); });\n      clearInterval(readTimer);\n      statueInside.classList.remove(\"cursor-pause\");\n      statueInside.classList.add(\"cursor-play\");\n    }\n  }\n\n  /* global handlers */\n  milestoneClickHandler(n){\n\n    let id = parseInt(n.target.getAttribute(\"id\"));\n\n    j = 0;\n\n    if(vars.isGlobeActive == false && id != vars.currentMilestone.id){\n      this.nextClickHandler(id);\n    }\n    else if(vars.isGlobeActive == true){\n      if(vars.currentMilestone == null){\n        this.startClickHandler();\n      }\n      this.gotoMilestone(id);\n      vars.isGlobeActive = false;\n    }\n  }\n\n  markerClickHandler(id){\n    if(vars.currentMilestone == null){\n      this.startClickHandler();\n    }\n    this.gotoMilestone(id);\n  }\n\n  gotoMilestone(id){\n    let _this = this;\n    let milestone = vars.milestones[id];\n\n    j = 0;\n    this.startClickHandler();\n\n    vars.currentMilestone = milestone;\n\n    document.body.classList.add(\"hold\");\n\n    vars.overlay.initStatue();\n    vars.overlay.initCurtain(milestone);\n\n    vars.isMouseActive = false;\n    vars.isPauseLoopFunctions = true;\n\n    var altitude = 100;\n    var coeff = 1+ altitude/(vars.globeRadius + 12);\n\n    anime.timeline().add({\n      targets: vars.main.camera.threeCamera.position,\n      x: milestone.position.x * coeff,\n      y: milestone.position.y * coeff,\n      z: milestone.position.z * coeff,\n      duration:3000,\n      easing: 'easeInOutCubic',\n      update: ()=>{ vars.main.camera.threeCamera.lookAt(0, 0, 0); },\n      complete: ()=>{\n        _this.handleTransition();\n        vars.isGlobeActive = false;\n      }\n    }).add({\n      targets: vars.main.scene.rotation,\n      x:0,\n      y:0,\n      easing: 'easeInOutCubic',\n      duration:3000,\n    }, 0);\n  }\n\n  handleTransition(){\n    vars.main.warp(\"IN\", ()=>{\n      vars.main.timeline.goto.curtain();\n      setTimeout(() => {\n        vars.main.flipScene(1);\n        vars.main.initPlatform();\n        setTimeout(()=>{\n          vars.overlay.animateCurtain(\"OUT\", ()=>{\n\n            anime({\n              targets: vars.main.platform.scene.rotation,\n              y:[(Math.random() - .5) * 200 * THREE.Math.DEG2RAD, 0],\n              x:[30 * THREE.Math.DEG2RAD, 0],\n              easing: 'easeInOutExpo',\n              duration:5000, \n            });\n\n            vars.main.warp(\"OUT\", ()=>{\n              vars.main.timeline.goto.section();\n              vars.isMouseActive = true;\n              vars.isPauseLoopFunctions = false;\n            });\n          });\n        }, 555);\n      }, 1000);\n\n      //\n\n    });\n  }\n\n}\n","/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nimport {\n  BufferAttribute,\n  BufferGeometry,\n  InterleavedBuffer,\n  InterleavedBufferAttribute,\n  TriangleFanDrawMode,\n  TriangleStripDrawMode,\n  TrianglesDrawMode,\n  Vector2,\n  Vector3,\n} from 'three';\n\nvar BufferGeometryUtils = {\n  computeTangents: function (geometry) {\n    var index = geometry.index;\n    var attributes = geometry.attributes;\n\n    // based on http://www.terathon.com/code/tangent.html\n    // (per vertex tangents)\n\n    if (\n      index === null ||\n      attributes.position === undefined ||\n      attributes.normal === undefined ||\n      attributes.uv === undefined\n    ) {\n      console.error(\n        'THREE.BufferGeometryUtils: .computeTangents() failed. Missing required attributes (index, position, normal or uv)'\n      );\n      return;\n    }\n\n    var indices = index.array;\n    var positions = attributes.position.array;\n    var normals = attributes.normal.array;\n    var uvs = attributes.uv.array;\n\n    var nVertices = positions.length / 3;\n\n    if (attributes.tangent === undefined) {\n      geometry.setAttribute('tangent', new BufferAttribute(new Float32Array(4 * nVertices), 4));\n    }\n\n    var tangents = attributes.tangent.array;\n\n    var tan1 = [],\n      tan2 = [];\n\n    for (var i = 0; i < nVertices; i++) {\n      tan1[i] = new Vector3();\n      tan2[i] = new Vector3();\n    }\n\n    var vA = new Vector3(),\n      vB = new Vector3(),\n      vC = new Vector3(),\n      uvA = new Vector2(),\n      uvB = new Vector2(),\n      uvC = new Vector2(),\n      sdir = new Vector3(),\n      tdir = new Vector3();\n\n    function handleTriangle(a, b, c) {\n      vA.fromArray(positions, a * 3);\n      vB.fromArray(positions, b * 3);\n      vC.fromArray(positions, c * 3);\n\n      uvA.fromArray(uvs, a * 2);\n      uvB.fromArray(uvs, b * 2);\n      uvC.fromArray(uvs, c * 2);\n\n      vB.sub(vA);\n      vC.sub(vA);\n\n      uvB.sub(uvA);\n      uvC.sub(uvA);\n\n      var r = 1.0 / (uvB.x * uvC.y - uvC.x * uvB.y);\n\n      // silently ignore degenerate uv triangles having coincident or colinear vertices\n\n      if (!isFinite(r)) return;\n\n      sdir.copy(vB).multiplyScalar(uvC.y).addScaledVector(vC, -uvB.y).multiplyScalar(r);\n      tdir.copy(vC).multiplyScalar(uvB.x).addScaledVector(vB, -uvC.x).multiplyScalar(r);\n\n      tan1[a].add(sdir);\n      tan1[b].add(sdir);\n      tan1[c].add(sdir);\n\n      tan2[a].add(tdir);\n      tan2[b].add(tdir);\n      tan2[c].add(tdir);\n    }\n\n    var groups = geometry.groups;\n\n    if (groups.length === 0) {\n      groups = [\n        {\n          start: 0,\n          count: indices.length,\n        },\n      ];\n    }\n\n    for (var i = 0, il = groups.length; i < il; ++i) {\n      var group = groups[i];\n\n      var start = group.start;\n      var count = group.count;\n\n      for (var j = start, jl = start + count; j < jl; j += 3) {\n        handleTriangle(indices[j + 0], indices[j + 1], indices[j + 2]);\n      }\n    }\n\n    var tmp = new Vector3(),\n      tmp2 = new Vector3();\n    var n = new Vector3(),\n      n2 = new Vector3();\n    var w, t, test;\n\n    function handleVertex(v) {\n      n.fromArray(normals, v * 3);\n      n2.copy(n);\n\n      t = tan1[v];\n\n      // Gram-Schmidt orthogonalize\n\n      tmp.copy(t);\n      tmp.sub(n.multiplyScalar(n.dot(t))).normalize();\n\n      // Calculate handedness\n\n      tmp2.crossVectors(n2, t);\n      test = tmp2.dot(tan2[v]);\n      w = test < 0.0 ? -1.0 : 1.0;\n\n      tangents[v * 4] = tmp.x;\n      tangents[v * 4 + 1] = tmp.y;\n      tangents[v * 4 + 2] = tmp.z;\n      tangents[v * 4 + 3] = w;\n    }\n\n    for (var i = 0, il = groups.length; i < il; ++i) {\n      var group = groups[i];\n\n      var start = group.start;\n      var count = group.count;\n\n      for (var j = start, jl = start + count; j < jl; j += 3) {\n        handleVertex(indices[j + 0]);\n        handleVertex(indices[j + 1]);\n        handleVertex(indices[j + 2]);\n      }\n    }\n  },\n\n  /**\n   * @param  {Array<BufferGeometry>} geometries\n   * @param  {Boolean} useGroups\n   * @return {BufferGeometry}\n   */\n  mergeBufferGeometries: function (geometries, useGroups) {\n    var isIndexed = geometries[0].index !== null;\n\n    var attributesUsed = new Set(Object.keys(geometries[0].attributes));\n    var morphAttributesUsed = new Set(Object.keys(geometries[0].morphAttributes));\n\n    var attributes = {};\n    var morphAttributes = {};\n\n    var morphTargetsRelative = geometries[0].morphTargetsRelative;\n\n    var mergedGeometry = new BufferGeometry();\n\n    var offset = 0;\n\n    for (var i = 0; i < geometries.length; ++i) {\n      var geometry = geometries[i];\n      var attributesCount = 0;\n\n      // ensure that all geometries are indexed, or none\n\n      if (isIndexed !== (geometry.index !== null)) {\n        console.error(\n          'THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index ' +\n          i +\n          '. All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them.'\n        );\n        return null;\n      }\n\n      // gather attributes, exit early if they're different\n\n      for (var name in geometry.attributes) {\n        if (!attributesUsed.has(name)) {\n          console.error(\n            'THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index ' +\n            i +\n            '. All geometries must have compatible attributes; make sure \"' +\n            name +\n            '\" attribute exists among all geometries, or in none of them.'\n          );\n          return null;\n        }\n\n        if (attributes[name] === undefined) attributes[name] = [];\n\n        attributes[name].push(geometry.attributes[name]);\n\n        attributesCount++;\n      }\n\n      // ensure geometries have the same number of attributes\n\n      if (attributesCount !== attributesUsed.size) {\n        console.error(\n          'THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index ' +\n          i +\n          '. Make sure all geometries have the same number of attributes.'\n        );\n        return null;\n      }\n\n      // gather morph attributes, exit early if they're different\n\n      if (morphTargetsRelative !== geometry.morphTargetsRelative) {\n        console.error(\n          'THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index ' +\n          i +\n          '. .morphTargetsRelative must be consistent throughout all geometries.'\n        );\n        return null;\n      }\n\n      for (var name in geometry.morphAttributes) {\n        if (!morphAttributesUsed.has(name)) {\n          console.error(\n            'THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index ' +\n            i +\n            '.  .morphAttributes must be consistent throughout all geometries.'\n          );\n          return null;\n        }\n\n        if (morphAttributes[name] === undefined) morphAttributes[name] = [];\n\n        morphAttributes[name].push(geometry.morphAttributes[name]);\n      }\n\n      // gather .userData\n\n      mergedGeometry.userData.mergedUserData = mergedGeometry.userData.mergedUserData || [];\n      mergedGeometry.userData.mergedUserData.push(geometry.userData);\n\n      if (useGroups) {\n        var count;\n\n        if (isIndexed) {\n          count = geometry.index.count;\n        } else if (geometry.attributes.position !== undefined) {\n          count = geometry.attributes.position.count;\n        } else {\n          console.error(\n            'THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index ' +\n            i +\n            '. The geometry must have either an index or a position attribute'\n          );\n          return null;\n        }\n\n        mergedGeometry.addGroup(offset, count, i);\n\n        offset += count;\n      }\n    }\n\n    // merge indices\n\n    if (isIndexed) {\n      var indexOffset = 0;\n      var mergedIndex = [];\n\n      for (var i = 0; i < geometries.length; ++i) {\n        var index = geometries[i].index;\n\n        for (var j = 0; j < index.count; ++j) {\n          mergedIndex.push(index.getX(j) + indexOffset);\n        }\n\n        indexOffset += geometries[i].attributes.position.count;\n      }\n\n      mergedGeometry.setIndex(mergedIndex);\n    }\n\n    // merge attributes\n\n    for (var name in attributes) {\n      var mergedAttribute = this.mergeBufferAttributes(attributes[name]);\n\n      if (!mergedAttribute) {\n        console.error(\n          'THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the ' +\n          name +\n          ' attribute.'\n        );\n        return null;\n      }\n\n      mergedGeometry.setAttribute(name, mergedAttribute);\n    }\n\n    // merge morph attributes\n\n    for (var name in morphAttributes) {\n      var numMorphTargets = morphAttributes[name][0].length;\n\n      if (numMorphTargets === 0) break;\n\n      mergedGeometry.morphAttributes = mergedGeometry.morphAttributes || {};\n      mergedGeometry.morphAttributes[name] = [];\n\n      for (var i = 0; i < numMorphTargets; ++i) {\n        var morphAttributesToMerge = [];\n\n        for (var j = 0; j < morphAttributes[name].length; ++j) {\n          morphAttributesToMerge.push(morphAttributes[name][j][i]);\n        }\n\n        var mergedMorphAttribute = this.mergeBufferAttributes(morphAttributesToMerge);\n\n        if (!mergedMorphAttribute) {\n          console.error(\n            'THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the ' +\n            name +\n            ' morphAttribute.'\n          );\n          return null;\n        }\n\n        mergedGeometry.morphAttributes[name].push(mergedMorphAttribute);\n      }\n    }\n\n    return mergedGeometry;\n  },\n\n  /**\n   * @param {Array<BufferAttribute>} attributes\n   * @return {BufferAttribute}\n   */\n  mergeBufferAttributes: function (attributes) {\n    var TypedArray;\n    var itemSize;\n    var normalized;\n    var arrayLength = 0;\n\n    for (var i = 0; i < attributes.length; ++i) {\n      var attribute = attributes[i];\n\n      if (attribute.isInterleavedBufferAttribute) {\n        console.error(\n          'THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported.'\n        );\n        return null;\n      }\n\n      if (TypedArray === undefined) TypedArray = attribute.array.constructor;\n      if (TypedArray !== attribute.array.constructor) {\n        console.error(\n          'THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes.'\n        );\n        return null;\n      }\n\n      if (itemSize === undefined) itemSize = attribute.itemSize;\n      if (itemSize !== attribute.itemSize) {\n        console.error(\n          'THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes.'\n        );\n        return null;\n      }\n\n      if (normalized === undefined) normalized = attribute.normalized;\n      if (normalized !== attribute.normalized) {\n        console.error(\n          'THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes.'\n        );\n        return null;\n      }\n\n      arrayLength += attribute.array.length;\n    }\n\n    var array = new TypedArray(arrayLength);\n    var offset = 0;\n\n    for (var i = 0; i < attributes.length; ++i) {\n      array.set(attributes[i].array, offset);\n\n      offset += attributes[i].array.length;\n    }\n\n    return new BufferAttribute(array, itemSize, normalized);\n  },\n\n  /**\n   * @param {Array<BufferAttribute>} attributes\n   * @return {Array<InterleavedBufferAttribute>}\n   */\n  interleaveAttributes: function (attributes) {\n    // Interleaves the provided attributes into an InterleavedBuffer and returns\n    // a set of InterleavedBufferAttributes for each attribute\n    var TypedArray;\n    var arrayLength = 0;\n    var stride = 0;\n\n    // calculate the the length and type of the interleavedBuffer\n    for (var i = 0, l = attributes.length; i < l; ++i) {\n      var attribute = attributes[i];\n\n      if (TypedArray === undefined) TypedArray = attribute.array.constructor;\n      if (TypedArray !== attribute.array.constructor) {\n        console.error('AttributeBuffers of different types cannot be interleaved');\n        return null;\n      }\n\n      arrayLength += attribute.array.length;\n      stride += attribute.itemSize;\n    }\n\n    // Create the set of buffer attributes\n    var interleavedBuffer = new InterleavedBuffer(new TypedArray(arrayLength), stride);\n    var offset = 0;\n    var res = [];\n    var getters = ['getX', 'getY', 'getZ', 'getW'];\n    var setters = ['setX', 'setY', 'setZ', 'setW'];\n\n    for (var j = 0, l = attributes.length; j < l; j++) {\n      var attribute = attributes[j];\n      var itemSize = attribute.itemSize;\n      var count = attribute.count;\n      var iba = new InterleavedBufferAttribute(\n        interleavedBuffer,\n        itemSize,\n        offset,\n        attribute.normalized\n      );\n      res.push(iba);\n\n      offset += itemSize;\n\n      // Move the data for each attribute into the new interleavedBuffer\n      // at the appropriate offset\n      for (var c = 0; c < count; c++) {\n        for (var k = 0; k < itemSize; k++) {\n          iba[setters[k]](c, attribute[getters[k]](c));\n        }\n      }\n    }\n\n    return res;\n  },\n\n  /**\n   * @param {Array<BufferGeometry>} geometry\n   * @return {number}\n   */\n  estimateBytesUsed: function (geometry) {\n    // Return the estimated memory used by this geometry in bytes\n    // Calculate using itemSize, count, and BYTES_PER_ELEMENT to account\n    // for InterleavedBufferAttributes.\n    var mem = 0;\n    for (var name in geometry.attributes) {\n      var attr = geometry.getAttribute(name);\n      mem += attr.count * attr.itemSize * attr.array.BYTES_PER_ELEMENT;\n    }\n\n    var indices = geometry.getIndex();\n    mem += indices ? indices.count * indices.itemSize * indices.array.BYTES_PER_ELEMENT : 0;\n    return mem;\n  },\n\n  /**\n   * @param {BufferGeometry} geometry\n   * @param {number} tolerance\n   * @return {BufferGeometry>}\n   */\n  mergeVertices: function (geometry, tolerance = 1e-4) {\n    tolerance = Math.max(tolerance, Number.EPSILON);\n\n    // Generate an index buffer if the geometry doesn't have one, or optimize it\n    // if it's already available.\n    var hashToIndex = {};\n    var indices = geometry.getIndex();\n    var positions = geometry.getAttribute('position');\n    var vertexCount = indices ? indices.count : positions.count;\n\n    // next value for triangle indices\n    var nextIndex = 0;\n\n    // attributes and new attribute arrays\n    var attributeNames = Object.keys(geometry.attributes);\n    var attrArrays = {};\n    var morphAttrsArrays = {};\n    var newIndices = [];\n    var getters = ['getX', 'getY', 'getZ', 'getW'];\n\n    // initialize the arrays\n    for (var i = 0, l = attributeNames.length; i < l; i++) {\n      var name = attributeNames[i];\n\n      attrArrays[name] = [];\n\n      var morphAttr = geometry.morphAttributes[name];\n      if (morphAttr) {\n        morphAttrsArrays[name] = new Array(morphAttr.length).fill().map(() => []);\n      }\n    }\n\n    // convert the error tolerance to an amount of decimal places to truncate to\n    var decimalShift = Math.log10(1 / tolerance);\n    var shiftMultiplier = Math.pow(10, decimalShift);\n    for (var i = 0; i < vertexCount; i++) {\n      var index = indices ? indices.getX(i) : i;\n\n      // Generate a hash for the vertex attributes at the current index 'i'\n      var hash = '';\n      for (var j = 0, l = attributeNames.length; j < l; j++) {\n        var name = attributeNames[j];\n        var attribute = geometry.getAttribute(name);\n        var itemSize = attribute.itemSize;\n\n        for (var k = 0; k < itemSize; k++) {\n          // double tilde truncates the decimal value\n          hash += `${~~(attribute[getters[k]](index) * shiftMultiplier)},`;\n        }\n      }\n\n      // Add another reference to the vertex if it's already\n      // used by another index\n      if (hash in hashToIndex) {\n        newIndices.push(hashToIndex[hash]);\n      } else {\n        // copy data to the new index in the attribute arrays\n        for (var j = 0, l = attributeNames.length; j < l; j++) {\n          var name = attributeNames[j];\n          var attribute = geometry.getAttribute(name);\n          var morphAttr = geometry.morphAttributes[name];\n          var itemSize = attribute.itemSize;\n          var newarray = attrArrays[name];\n          var newMorphArrays = morphAttrsArrays[name];\n\n          for (var k = 0; k < itemSize; k++) {\n            var getterFunc = getters[k];\n            newarray.push(attribute[getterFunc](index));\n\n            if (morphAttr) {\n              for (var m = 0, ml = morphAttr.length; m < ml; m++) {\n                newMorphArrays[m].push(morphAttr[m][getterFunc](index));\n              }\n            }\n          }\n        }\n\n        hashToIndex[hash] = nextIndex;\n        newIndices.push(nextIndex);\n        nextIndex++;\n      }\n    }\n\n    // Generate typed arrays from new attribute arrays and update\n    // the attributeBuffers\n    const result = geometry.clone();\n    for (var i = 0, l = attributeNames.length; i < l; i++) {\n      var name = attributeNames[i];\n      var oldAttribute = geometry.getAttribute(name);\n\n      var buffer = new oldAttribute.array.constructor(attrArrays[name]);\n      var attribute = new BufferAttribute(buffer, oldAttribute.itemSize, oldAttribute.normalized);\n\n      result.setAttribute(name, attribute);\n\n      // Update the attribute arrays\n      if (name in morphAttrsArrays) {\n        for (var j = 0; j < morphAttrsArrays[name].length; j++) {\n          var oldMorphAttribute = geometry.morphAttributes[name][j];\n\n          var buffer = new oldMorphAttribute.array.constructor(morphAttrsArrays[name][j]);\n          var morphAttribute = new BufferAttribute(\n            buffer,\n            oldMorphAttribute.itemSize,\n            oldMorphAttribute.normalized\n          );\n          result.morphAttributes[name][j] = morphAttribute;\n        }\n      }\n    }\n\n    // indices\n\n    result.setIndex(newIndices);\n\n    return result;\n  },\n\n  /**\n   * @param {BufferGeometry} geometry\n   * @param {number} drawMode\n   * @return {BufferGeometry>}\n   */\n  toTrianglesDrawMode: function (geometry, drawMode) {\n    if (drawMode === TrianglesDrawMode) {\n      console.warn(\n        'THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles.'\n      );\n      return geometry;\n    }\n\n    if (drawMode === TriangleFanDrawMode || drawMode === TriangleStripDrawMode) {\n      var index = geometry.getIndex();\n\n      // generate index if not present\n\n      if (index === null) {\n        var indices = [];\n\n        var position = geometry.getAttribute('position');\n\n        if (position !== undefined) {\n          for (var i = 0; i < position.count; i++) {\n            indices.push(i);\n          }\n\n          geometry.setIndex(indices);\n          index = geometry.getIndex();\n        } else {\n          console.error(\n            'THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible.'\n          );\n          return geometry;\n        }\n      }\n\n      //\n\n      var numberOfTriangles = index.count - 2;\n      var newIndices = [];\n\n      if (drawMode === TriangleFanDrawMode) {\n        // gl.TRIANGLE_FAN\n\n        for (var i = 1; i <= numberOfTriangles; i++) {\n          newIndices.push(index.getX(0));\n          newIndices.push(index.getX(i));\n          newIndices.push(index.getX(i + 1));\n        }\n      } else {\n        // gl.TRIANGLE_STRIP\n\n        for (var i = 0; i < numberOfTriangles; i++) {\n          if (i % 2 === 0) {\n            newIndices.push(index.getX(i));\n            newIndices.push(index.getX(i + 1));\n            newIndices.push(index.getX(i + 2));\n          } else {\n            newIndices.push(index.getX(i + 2));\n            newIndices.push(index.getX(i + 1));\n            newIndices.push(index.getX(i));\n          }\n        }\n      }\n\n      if (newIndices.length / 3 !== numberOfTriangles) {\n        console.error(\n          'THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.'\n        );\n      }\n\n      // build final geometry\n\n      var newGeometry = geometry.clone();\n      newGeometry.setIndex(newIndices);\n      newGeometry.clearGroups();\n\n      return newGeometry;\n    }\n\n    console.error('THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:', drawMode);\n    return geometry;\n  },\n};\n\nexport { BufferGeometryUtils };\n","import vars from \"./vars\";\n\nvar fx = {\n\n  // Check if browser supports WebGL\n  hasWebGL: () => {\n    var canvas = document.createElement(\"canvas\");\n    const gl =\n          canvas.getContext(\"webgl\") || canvas.getContext(\"experimental-webgl\");\n    if (gl && gl instanceof WebGLRenderingContext) {\n      return true;\n    } \n    return false;\n        \n  },\n\n  // Convert Flat Coordinates to Sphere Coordinates\n  convertFlatCoordsToSphereCoords: (x, y, globeRadius, globeWidth, globeHeight) => {\n    let latitude = ((x - globeWidth) / globeWidth) * -180;\n    let longitude = ((y - globeHeight) / globeHeight) * -90;\n    latitude = (latitude * Math.PI) / 180;\n    longitude = (longitude * Math.PI) / 180;\n    const radius = Math.cos(longitude) * globeRadius;\n\n    return {\n      x: Math.cos(latitude) * radius,\n      y: Math.sin(longitude) * globeRadius,\n      z: Math.sin(latitude) * radius\n    };\n  },\n\n  //check if point is inside a circle\n  isPointInsideCircle(centerX, centerY, radius, pX, pY) {\n    var dist_points = (centerX - pX) * (centerX - pX) + (centerY - pY) * (centerY - pY);\n    radius *= radius;\n    if (dist_points < radius) {\n      return true;\n    }\n    return false;\n  },\n\n  removeFromLoop: (fx) => {\n    const loopFunctions = vars.loopFunctions;\n    for (var i in loopFunctions)\n      if (loopFunctions[i][1] === fx) loopFunctions.splice(i, 1);\n  },\n}\n\nexport default fx;\n","// Global imports -\nimport * as THREE from 'three';\nimport { BufferGeometryUtils } from '../../utils/bufferGeometryUtils';\nimport SimplexNoise from 'simplex-noise';\nimport anime from 'animejs';\n\nimport fx from '../fx';\nimport vars from '../vars';\n\nimport * as data from '../../data/points.json';\n\nconst matrix = new THREE.Matrix4();\n\nconst markers = new THREE.Object3D();\n\nconst simplex = new SimplexNoise();\nvar blob, ring, ring2, ring3;\n\nconst globe = new THREE.Object3D();\nconst flies = new THREE.Object3D();\n\nvar localPlane;\n\nexport default class Globe {\n  constructor(main) {\n    if (fx.hasWebGL()) {\n      this.init(main);\n    }\n\n    this.markers = markers;\n  }\n  \n  init(main) {\n\n    this.scene = main.scene;\n\n    const blobGeometry = new THREE.IcosahedronGeometry( vars.globeRadius - 2, 10 );\n    blobGeometry.setAttribute(\"basePosition\", new THREE.BufferAttribute().copy(blobGeometry.attributes.position));\n    var blobMaterial = new THREE.MeshPhysicalMaterial({\n      color: 0x000957,\n      emissive: 0x002B7E,\n      emissiveIntensity:.1,\n      transparent:true,\n      opacity:1,\n      depthTest: true,\n      depthWrite: true,\n      flatShading:true,\n      roughness:.8,\n      metalness:.2,\n      reflectivity:1.95,\n    });\n    blob = new THREE.Mesh( blobGeometry, blobMaterial );\n    globe.add( blob );\n        \n    ring = new THREE.Mesh(\n      new THREE.CylinderGeometry( vars.globeRadius *2.4, vars.globeRadius *2.4, 1, 36, 1, true),\n      new THREE.MeshBasicMaterial( {color:0xFFFFFF, side:THREE.DoubleSide, transparent:true, opacity:.2 })\n    );\n    ring.rotation.set(30 * THREE.Math.DEG2RAD, 0, 45 * THREE.Math.DEG2RAD);\n    globe.add(ring);\n\n    ring2 = new THREE.Mesh(\n      new THREE.CylinderGeometry( vars.globeRadius * 3.3, vars.globeRadius * 3.3, 1, 36, 1, true),\n      new THREE.MeshBasicMaterial( {color:0x38B0FF, side:THREE.DoubleSide, transparent:true, opacity:.2 })\n    );\n    ring2.rotation.set(-45 * THREE.Math.DEG2RAD, 0, -30 * THREE.Math.DEG2RAD);\n    globe.add(ring2);\n\n    ring3 = new THREE.Mesh(\n      new THREE.CylinderGeometry( vars.globeRadius * 3.5, vars.globeRadius *3.5, 1, 36, 1, true),\n      new THREE.MeshBasicMaterial( {color:0x38B0FF, side:THREE.DoubleSide, transparent:true, opacity:.4 })\n    );\n    ring3.rotation.set(-15 * THREE.Math.DEG2RAD, 0, 10 * THREE.Math.DEG2RAD);\n    globe.add(ring3);\n\n    //vars.loopFunctions.push([this.animatePositions, \"ANIMATE_EARTH\", 0]);\n        \n    localPlane = new THREE.Plane( new THREE.Vector3( 1, -0.1, 0 ), -100);\n    vars.localPlanes[1] = localPlane;\n\n    this.mergedGeometry = new THREE.BufferGeometry();\n    this.pointGeometry = new THREE.SphereBufferGeometry(.4,1,1);\n    this.pointGeometry2 = new THREE.SphereBufferGeometry(.7,1,1);\n    this.pointMaterial = new THREE.MeshBasicMaterial({\n      color:0x9D92F3,\n      clippingPlanes: [localPlane],\n      clipShadows: true,\n    });\n    //this.pointMaterial = new THREE.MeshBasicMaterial({color:\"#9145B6\"});\n\n    const geometries = [];\n    for (const point of data.points) {\n      const { x, y, z } = fx.convertFlatCoordsToSphereCoords(\n        point.x,\n        point.y,\n        vars.globeRadius + 0,\n        2040,\n        1000\n      );\n\n      if (x && y && z) {\n        matrix.makeTranslation( x, y, z );\n\n        const k = Math.random() > .25 ? \n          geometries.push(this.pointGeometry.clone().applyMatrix4(matrix))\n          : geometries.push(this.pointGeometry2.clone().applyMatrix4(matrix));\n\n      }\n    }\n\n    this.mergedGeometry = BufferGeometryUtils.mergeBufferGeometries(geometries);\n    this.globeShape = new THREE.Mesh(this.mergedGeometry, this.pointMaterial);\n    //this.globeShape.rotation.y = -40 * THREE.Math.DEG2RAD;\n    globe.add(this.globeShape);\n\n    /*\n    for(var i=0; i<vars.milestones.length; ++i){\n      this.addMarker(vars.milestones[i].coords, i);\n    }\n    */\n    globe.add(markers);\n\n    //this.addFireflies(main);\n\n    //vars.loopFunctions.push([this.animateGlobe, \"ANIMATE_EARTH\", 0]);\n\n    this.scene.add(globe);\n\n  }\n\n  addMarkers(){\n\n    for(var i=0; i<vars.milestones.length; ++i){\n      this.addMarker(vars.milestones[i].coords, i);\n    }\n    globe.add(markers);\n  }\n\n  showMarkers(){\n    for(var i=0; i<markers.children.length; ++i){\n      let _m = markers.children[i];\n      anime({\n        targets: _m.children[1].material.uniforms.opacity,\n        value: 0.4,\n        duration: 3000,\n      });\n    }\n  }\n\n  addMarker(obj, i){\n    this.marker = new THREE.Object3D();\n\n    const grassMaterial = new THREE.ShaderMaterial({\n      side:THREE.DoubleSide,\n      transparent:true,\n      depthTest:false,\n      uniforms: {\n        color1: {\n          value: new THREE.Color(0x38B0FF)\n        },\n        color2: {\n          value: new THREE.Color(0x003DB2)\n        },\n        opacity: {\n          value: 0.0\n        },\n        needsUpdate: true,\n      },\n      vertexShader: `\n                varying vec2 vUv;\n            \n                void main() {\n                  vUv = uv;\n                  gl_Position = projectionMatrix * modelViewMatrix * vec4(position,1.0);\n                }\n              `,\n      fragmentShader: `\n                uniform vec3 color1;\n                uniform vec3 color2;\n                uniform float opacity;\n              \n                varying vec2 vUv;\n                \n                void main() {\n                  \n                  gl_FragColor = vec4(mix(color1, color2, vUv.y), opacity);\n                }\n              `\n    });\n\n    const mesh = new THREE.Mesh(\n      new THREE.CylinderGeometry(1, 3, 24, 16, 1, true),\n      grassMaterial\n    )\n    mesh.name = i;\n\n    var latRad = obj.lat * (Math.PI / 180);\n    var lonRad = -obj.lng * (Math.PI / 180);\n    var r = vars.globeRadius + 12;\n        \n    this.marker.position.set(\n      Math.cos(latRad) * Math.cos(lonRad) * r, \n      Math.sin(latRad) * r, \n      Math.cos(latRad) * Math.sin(lonRad) * r\n    );\n    this.marker.rotation.set(0.0, -lonRad, latRad - Math.PI * 0.5);\n\n    const sphere = new THREE.SphereGeometry( .2, 3, 3 );\n    const light = new THREE.PointLight( 0x009AFF, 2, 25 );\n    light.add( new THREE.Mesh( sphere, new THREE.MeshBasicMaterial( { color: 0x009AFF } ) ) );\n    light.position.set(0, 5, 0);\n    this.marker.add(light);\n\n    vars.milestones[i].position = this.marker.position;\n\n    this.marker.add(mesh);\n\n    markers.add(this.marker);\n\n  }\n\n  addFireflies(main){\n\n    this.scene = main.scene;\n\n    const sphere = new THREE.SphereGeometry( .4, 3, 3 );\n\n    const v =  vars.globeRadius * .6;\n\n    //lights\n    const light1 = new THREE.PointLight( 0xff0040, 2, 30 );\n    light1.add( new THREE.Mesh( sphere, new THREE.MeshBasicMaterial( { color: 0xff0040 } ) ) );\n    light1.position.set(v, v, -v);\n    flies.add( light1 );\n\n    const light2 = new THREE.PointLight( 0x0040ff, 2, 30 );\n    light2.add( new THREE.Mesh( sphere, new THREE.MeshBasicMaterial( { color: 0x0040ff } ) ) );\n    light2.position.set(-v, -v, -v);\n    flies.add( light2 );\n\n    const light3 = new THREE.PointLight( 0x80ff80, 2, 30 );\n    light3.add( new THREE.Mesh( sphere, new THREE.MeshBasicMaterial( { color: 0x80ff80 } ) ) );\n    light3.position.set(v, -v, v);\n    flies.add( light3 );\n\n    const light4 = new THREE.PointLight( 0xffaa00, 2, 30 );\n    light4.add( new THREE.Mesh( sphere, new THREE.MeshBasicMaterial( { color: 0xffaa00 } ) ) );\n    light4.position.set(-v, v, v);\n    flies.add( light4 );\n\n    flies.position.y = 0;\n\n    this.scene.add( flies );\n\n    //vars.loopFunctions.push([this.animateFlies, \"ANIMATE_FLIES\"]);\n  }\n\n  animateFlies(time){\n\n    flies.rotation.y += .003;\n    flies.rotation.x += .002;\n\n    /*\n        \n        time = time * 0.0005;\n        \n        let light1 = flies.children[0];\n        let light2 = flies.children[1];\n        let light3 = flies.children[2];\n        let light4 = flies.children[3];\n\n        let radius = vars.globeRadius;\n\n        light1.position.x = Math.sin( time * 0.7 ) * radius;\n        light1.position.y = Math.sin( time * 0.5 ) * radius;\n        light1.position.z = Math.cos( time * 0.3 ) * radius;\n\n        light2.position.x = Math.cos( time * 0.3 ) * radius;\n        light2.position.y = Math.sin( time * 0.5 ) * radius;\n        light2.position.z = Math.sin( time * 0.7 ) * radius;\n\n        light3.position.x = Math.sin( time * 0.7 ) * radius;\n        light3.position.y = Math.cos( time * 0.3 ) * radius;\n        light3.position.z = Math.sin( time * 0.5 ) * radius;\n\n        light4.position.x = Math.sin( time * 0.3 ) * radius;\n        light4.position.y = Math.cos( time * 0.7 ) * radius;\n        light4.position.z = Math.sin( time * 0.5 ) * radius;\n\n        */\n  }\n\n  animatePositions(a){\n    const basePositionAttribute = blob.geometry.getAttribute(\"basePosition\");\n    const positionAttribute = blob.geometry.getAttribute( 'position' );\n    const newPositionAttribute = [];\n    const vertex = new THREE.Vector3();\n\n    for ( let vertexIndex = 0; vertexIndex < positionAttribute.count; vertexIndex++ ) {\n\n      vertex.fromBufferAttribute( basePositionAttribute, vertexIndex );\n\n      var perlin = simplex.noise3D(\n        vertex.x * 0.0095 + a * 0.0002,\n        vertex.y * 0.0095 + a * 0.0004,\n        vertex.z * 0.0095 );\n\n      //var ratio = perlin * 0.4 * ( mouse.y + 0.1 ) + 0.8;\n      var ratio = perlin * 0.4 * 0.1 + 0.8;\n      vertex.multiplyScalar( ratio );\n\n      positionAttribute.setXYZ(vertexIndex, vertex.x, vertex.y, vertex.z);\n\n    }\n\n    blob.geometry.attributes.position.needsUpdate = true; // required after the first render\n    blob.geometry.computeBoundingSphere();\n\n    //ring.rotation.y -= 0.001;\n    //ring2.rotation.y += 0.002;\n  }\n\n  animateGlobe(){\n    globe.rotation.y += .0008;\n  }\n\n}\n","// Global imports -\nimport anime from 'animejs';\nimport * as THREE from 'three';\nimport vars from '../vars';\nimport fx from '../fx';\n\nlet clouds, earthBall;\nvar localPlane;\n\nexport default class Earth {\n  constructor(main) {\n    this.init(main);\n  }\n  \n  init(main) {\n\n    this.scene = main.scene;\n\n    this.object = new THREE.Object3D();\n        \n    localPlane = new THREE.Plane( new THREE.Vector3( -1, 0.1, 0 ), 100);\n    vars.localPlanes[0] = localPlane;\n\n    var geometry = new THREE.SphereGeometry(vars.globeRadius, 32, 32);\n\n    const mapTexture = new THREE.TextureLoader().load( '/assets/textures/map2.jpg' );\n    mapTexture.matrix.rotate(.2);\n    const elevMap = new THREE.TextureLoader().load( '/assets/textures/elevation2.jpg' );\n    const waterMap = new THREE.TextureLoader().load( 'assets/textures/water.png' );\n    const cloudsTexture = new THREE.TextureLoader().load( 'assets/textures/clouds.png' );\n\n    var material = new THREE.MeshPhongMaterial({\n      map: mapTexture,\n      bumpMap: elevMap,\n      bumpScale: .005,\n      specularMap: waterMap,\n      specular: new THREE.Color( 0xDDDDDD ),\n      clippingPlanes: [localPlane],\n      clipShadows: true,\n    });\n\n    earthBall = new THREE.Mesh(geometry, material);\n    clouds = new THREE.Mesh(\n      new THREE.SphereGeometry(vars.globeRadius + 5, 32, 32),\n      new THREE.MeshStandardMaterial({\n        map: cloudsTexture,\n        transparent: true,\n        roughness: .9,\n        clippingPlanes: [localPlane],\n        clipShadows: true,\n      })\n    );\n\n    this.object.add(earthBall);\n    this.object.add(clouds);\n\n    this.object.rotation.y = 140 * THREE.Math.DEG2RAD; \n    this.object.position.z = -800;\n\n    this.scene.add(this.object);\n\n    vars.loopFunctions.push([this.animateEarth, \"ANIMATE_EARTH\", 0]);\n\n    return this.object;\n  }\n\n  dispose(){\n    fx.removeFromLoop(\"ANIMATE_EARTH\");\n\n    var parent = this.object;\n    for (var i = parent.children.length - 1; i >= 0; i--) {\n        parent.remove(parent.children[i]);\n    }\n    this.scene.remove(this.object);\n\n  }\n\n  animateEarth(){\n    clouds.rotation.y += -.0007;\n    //earthBall.rotation.y += -.0004;\n  }\n}\n","// Global imports -\nimport * as THREE from 'three';\nimport vars from '../vars';\n\nconst stars = [];\nconst radius = 250;\nlet sphere;\n\nexport default class Stars {\n  constructor(main) {\n    this.init(main);\n  }\n  \n  init(main) {\n\n    this.scene = main.scene;\n\n    for ( var z= -radius; z < radius; z+=10 ) {\n\n      var geometry   = new THREE.SphereGeometry(0.4, 3, 3)\n      var material = new THREE.MeshPhongMaterial( {color: 0xFFFFFF} );\n      sphere = new THREE.Mesh(geometry, material)\n\n      sphere.position.x = Math.random() * radius - (radius*.5);\n      sphere.position.y = Math.random() * radius - (radius*.5);\n\n      sphere.position.z = z;\n\n      sphere.scale.x = sphere.scale.y = 2;\n\n      this.scene.add( sphere );\n      stars.push(sphere); \n    }\n\n    //vars.loopFunctions.push([this.animate, \"ANIMATE_STARS\"]);\n  }\n\n  animate(){\n        \n        \n    for(var i=0; i<stars.length; i++) {\n\t\t\t\n      const star = stars[i]; \n      star.position.z +=  i/10;\n\t\t\t\t\n      if(star.position.z>radius) star.position.z-=radius*2; \n\t\t\t\n    }\n        \n    //sphere.rotation.y += 1;\n  }\n}\n","/**\n * @author Rich Tibbett / https://github.com/richtr\n * @author mrdoob / http://mrdoob.com/\n * @author Tony Parisi / http://www.tonyparisi.com/\n * @author Takahiro / https://github.com/takahirox\n * @author Don McCurdy / https://www.donmccurdy.com\n */\n\nimport {\n  AnimationClip,\n  Bone,\n  Box3,\n  BufferAttribute,\n  BufferGeometry,\n  ClampToEdgeWrapping,\n  Color,\n  DirectionalLight,\n  DoubleSide,\n  FileLoader,\n  FrontSide,\n  Group,\n  InterleavedBuffer,\n  InterleavedBufferAttribute,\n  Interpolant,\n  InterpolateDiscrete,\n  InterpolateLinear,\n  Line,\n  LineBasicMaterial,\n  LineLoop,\n  LineSegments,\n  LinearFilter,\n  LinearMipmapLinearFilter,\n  LinearMipmapNearestFilter,\n  Loader,\n  LoaderUtils,\n  Material,\n  MathUtils,\n  Matrix4,\n  Mesh,\n  MeshBasicMaterial,\n  MeshPhysicalMaterial,\n  MeshStandardMaterial,\n  MirroredRepeatWrapping,\n  NearestFilter,\n  NearestMipmapLinearFilter,\n  NearestMipmapNearestFilter,\n  NumberKeyframeTrack,\n  Object3D,\n  OrthographicCamera,\n  PerspectiveCamera,\n  PointLight,\n  Points,\n  PointsMaterial,\n  PropertyBinding,\n  QuaternionKeyframeTrack,\n  RGBAFormat,\n  RGBFormat,\n  RepeatWrapping,\n  Skeleton,\n  SkinnedMesh,\n  Sphere,\n  SpotLight,\n  TangentSpaceNormalMap,\n  TextureLoader,\n  TriangleFanDrawMode,\n  TriangleStripDrawMode,\n  Vector2,\n  Vector3,\n  VectorKeyframeTrack,\n  sRGBEncoding\n} from 'three';\n\nconst GLTFLoader = (function () {\n  function GLTFLoader(manager) {\n    Loader.call(this, manager);\n\n    this.dracoLoader = null;\n    this.ddsLoader = null;\n  }\n\n  GLTFLoader.prototype = Object.assign(Object.create(Loader.prototype), {\n    constructor: GLTFLoader,\n\n    load: function (url, onLoad, onProgress, onError) {\n      var scope = this;\n\n      var resourcePath;\n\n      if (this.resourcePath !== '') {\n        resourcePath = this.resourcePath;\n      } else if (this.path !== '') {\n        resourcePath = this.path;\n      } else {\n        resourcePath = LoaderUtils.extractUrlBase(url);\n      }\n\n      // Tells the LoadingManager to track an extra item, which resolves after\n      // the model is fully loaded. This means the count of items loaded will\n      // be incorrect, but ensures manager.onLoad() does not fire early.\n      scope.manager.itemStart(url);\n\n      var _onError = function (e) {\n        if (onError) {\n          onError(e);\n        } else {\n          console.error(e);\n        }\n\n        scope.manager.itemError(url);\n        scope.manager.itemEnd(url);\n      };\n\n      var loader = new FileLoader(scope.manager);\n\n      loader.setPath(this.path);\n      loader.setResponseType('arraybuffer');\n\n      if (scope.crossOrigin === 'use-credentials') {\n        loader.setWithCredentials(true);\n      }\n\n      loader.load(\n        url,\n        function (data) {\n          try {\n            scope.parse(\n              data,\n              resourcePath,\n              function (gltf) {\n                onLoad(gltf);\n\n                scope.manager.itemEnd(url);\n              },\n              _onError\n            );\n          } catch (e) {\n            _onError(e);\n          }\n        },\n        onProgress,\n        _onError\n      );\n    },\n\n    setDRACOLoader: function (dracoLoader) {\n      this.dracoLoader = dracoLoader;\n      return this;\n    },\n\n    setDDSLoader: function (ddsLoader) {\n      this.ddsLoader = ddsLoader;\n      return this;\n    },\n\n    parse: function (data, path, onLoad, onError) {\n      var content;\n      var extensions = {};\n\n      if (typeof data === 'string') {\n        content = data;\n      } else {\n        var magic = LoaderUtils.decodeText(new Uint8Array(data, 0, 4));\n\n        if (magic === BINARY_EXTENSION_HEADER_MAGIC) {\n          try {\n            extensions[EXTENSIONS.KHR_BINARY_GLTF] = new GLTFBinaryExtension(data);\n          } catch (error) {\n            if (onError) onError(error);\n            return;\n          }\n\n          content = extensions[EXTENSIONS.KHR_BINARY_GLTF].content;\n        } else {\n          content = LoaderUtils.decodeText(new Uint8Array(data));\n        }\n      }\n\n      var json = JSON.parse(content);\n\n      if (json.asset === undefined || json.asset.version[0] < 2) {\n        if (onError)\n          onError(\n            new Error('THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.')\n          );\n        return;\n      }\n\n      if (json.extensionsUsed) {\n        for (var i = 0; i < json.extensionsUsed.length; ++i) {\n          var extensionName = json.extensionsUsed[i];\n          var extensionsRequired = json.extensionsRequired || [];\n\n          switch (extensionName) {\n            case EXTENSIONS.KHR_LIGHTS_PUNCTUAL:\n              extensions[extensionName] = new GLTFLightsExtension(json);\n              break;\n\n            case EXTENSIONS.KHR_MATERIALS_CLEARCOAT:\n              extensions[extensionName] = new GLTFMaterialsClearcoatExtension();\n              break;\n\n            case EXTENSIONS.KHR_MATERIALS_UNLIT:\n              extensions[extensionName] = new GLTFMaterialsUnlitExtension();\n              break;\n\n            case EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:\n              extensions[extensionName] = new GLTFMaterialsPbrSpecularGlossinessExtension();\n              break;\n\n            case EXTENSIONS.KHR_DRACO_MESH_COMPRESSION:\n              extensions[extensionName] = new GLTFDracoMeshCompressionExtension(\n                json,\n                this.dracoLoader\n              );\n              break;\n\n            case EXTENSIONS.MSFT_TEXTURE_DDS:\n              extensions[extensionName] = new GLTFTextureDDSExtension(this.ddsLoader);\n              break;\n\n            case EXTENSIONS.KHR_TEXTURE_TRANSFORM:\n              extensions[extensionName] = new GLTFTextureTransformExtension();\n              break;\n\n            case EXTENSIONS.KHR_MESH_QUANTIZATION:\n              extensions[extensionName] = new GLTFMeshQuantizationExtension();\n              break;\n\n            default:\n              if (extensionsRequired.indexOf(extensionName) >= 0) {\n                console.warn('THREE.GLTFLoader: Unknown extension \"' + extensionName + '\".');\n              }\n          }\n        }\n      }\n\n      var parser = new GLTFParser(json, extensions, {\n        path: path || this.resourcePath || '',\n        crossOrigin: this.crossOrigin,\n        manager: this.manager\n      });\n\n      parser.parse(onLoad, onError);\n    },\n  });\n\n  /* GLTFREGISTRY */\n\n  function GLTFRegistry() {\n    var objects = {};\n\n    return {\n      get: function (key) {\n        return objects[key];\n      },\n\n      add: function (key, object) {\n        objects[key] = object;\n      },\n\n      remove: function (key) {\n        delete objects[key];\n      },\n\n      removeAll: function () {\n        objects = {};\n      },\n    };\n  }\n\n  /*********************************/\n  /********** EXTENSIONS ***********/\n  /*********************************/\n\n  var EXTENSIONS = {\n    KHR_BINARY_GLTF: 'KHR_binary_glTF',\n    KHR_DRACO_MESH_COMPRESSION: 'KHR_draco_mesh_compression',\n    KHR_LIGHTS_PUNCTUAL: 'KHR_lights_punctual',\n    KHR_MATERIALS_CLEARCOAT: 'KHR_materials_clearcoat',\n    KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS: 'KHR_materials_pbrSpecularGlossiness',\n    KHR_MATERIALS_UNLIT: 'KHR_materials_unlit',\n    KHR_TEXTURE_TRANSFORM: 'KHR_texture_transform',\n    KHR_MESH_QUANTIZATION: 'KHR_mesh_quantization',\n    MSFT_TEXTURE_DDS: 'MSFT_texture_dds'\n  };\n\n  /**\n   * DDS Texture Extension\n   *\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/MSFT_texture_dds\n   *\n   */\n  function GLTFTextureDDSExtension(ddsLoader) {\n    if (!ddsLoader) {\n      throw new Error(\n        'THREE.GLTFLoader: Attempting to load .dds texture without importing DDSLoader'\n      );\n    }\n\n    this.name = EXTENSIONS.MSFT_TEXTURE_DDS;\n    this.ddsLoader = ddsLoader;\n  }\n\n  /**\n   * Punctual Lights Extension\n   *\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_lights_punctual\n   */\n  function GLTFLightsExtension(json) {\n    this.name = EXTENSIONS.KHR_LIGHTS_PUNCTUAL;\n\n    var extension = (json.extensions && json.extensions[EXTENSIONS.KHR_LIGHTS_PUNCTUAL]) || {};\n    this.lightDefs = extension.lights || [];\n  }\n\n  GLTFLightsExtension.prototype.loadLight = function (lightIndex) {\n    var lightDef = this.lightDefs[lightIndex];\n    var lightNode;\n\n    var color = new Color(0xffffff);\n    if (lightDef.color !== undefined) color.fromArray(lightDef.color);\n\n    var range = lightDef.range !== undefined ? lightDef.range : 0;\n\n    switch (lightDef.type) {\n      case 'directional':\n        lightNode = new DirectionalLight(color);\n        lightNode.target.position.set(0, 0, -1);\n        lightNode.add(lightNode.target);\n        break;\n\n      case 'point':\n        lightNode = new PointLight(color);\n        lightNode.distance = range;\n        break;\n\n      case 'spot':\n        lightNode = new SpotLight(color);\n        lightNode.distance = range;\n        // Handle spotlight properties.\n        lightDef.spot = lightDef.spot || {};\n        lightDef.spot.innerConeAngle =\n          lightDef.spot.innerConeAngle !== undefined ? lightDef.spot.innerConeAngle : 0;\n        lightDef.spot.outerConeAngle =\n          lightDef.spot.outerConeAngle !== undefined ? lightDef.spot.outerConeAngle : Math.PI / 4.0;\n        lightNode.angle = lightDef.spot.outerConeAngle;\n        lightNode.penumbra = 1.0 - lightDef.spot.innerConeAngle / lightDef.spot.outerConeAngle;\n        lightNode.target.position.set(0, 0, -1);\n        lightNode.add(lightNode.target);\n        break;\n\n      default:\n        throw new Error('THREE.GLTFLoader: Unexpected light type, \"' + lightDef.type + '\".');\n    }\n\n    // Some lights (e.g. spot) default to a position other than the origin. Reset the position\n    // here, because node-level parsing will only override position if explicitly specified.\n    lightNode.position.set(0, 0, 0);\n\n    lightNode.decay = 2;\n\n    if (lightDef.intensity !== undefined) lightNode.intensity = lightDef.intensity;\n\n    lightNode.name = lightDef.name || 'light_' + lightIndex;\n\n    return Promise.resolve(lightNode);\n  };\n\n  /**\n   * Unlit Materials Extension\n   *\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_unlit\n   */\n  function GLTFMaterialsUnlitExtension() {\n    this.name = EXTENSIONS.KHR_MATERIALS_UNLIT;\n  }\n\n  GLTFMaterialsUnlitExtension.prototype.getMaterialType = function () {\n    return MeshBasicMaterial;\n  };\n\n  GLTFMaterialsUnlitExtension.prototype.extendParams = function (\n    materialParams,\n    materialDef,\n    parser\n  ) {\n    var pending = [];\n\n    materialParams.color = new Color(1.0, 1.0, 1.0);\n    materialParams.opacity = 1.0;\n\n    var metallicRoughness = materialDef.pbrMetallicRoughness;\n\n    if (metallicRoughness) {\n      if (Array.isArray(metallicRoughness.baseColorFactor)) {\n        var array = metallicRoughness.baseColorFactor;\n\n        materialParams.color.fromArray(array);\n        materialParams.opacity = array[3];\n      }\n\n      if (metallicRoughness.baseColorTexture !== undefined) {\n        pending.push(\n          parser.assignTexture(materialParams, 'map', metallicRoughness.baseColorTexture)\n        );\n      }\n    }\n\n    return Promise.all(pending);\n  };\n\n  /**\n   * Clearcoat Materials Extension\n   *\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_clearcoat\n   */\n  function GLTFMaterialsClearcoatExtension() {\n    this.name = EXTENSIONS.KHR_MATERIALS_CLEARCOAT;\n  }\n\n  GLTFMaterialsClearcoatExtension.prototype.getMaterialType = function () {\n    return MeshPhysicalMaterial;\n  };\n\n  GLTFMaterialsClearcoatExtension.prototype.extendParams = function (\n    materialParams,\n    materialDef,\n    parser\n  ) {\n    var pending = [];\n\n    var extension = materialDef.extensions[this.name];\n\n    if (extension.clearcoatFactor !== undefined) {\n      materialParams.clearcoat = extension.clearcoatFactor;\n    }\n\n    if (extension.clearcoatTexture !== undefined) {\n      pending.push(\n        parser.assignTexture(materialParams, 'clearcoatMap', extension.clearcoatTexture)\n      );\n    }\n\n    if (extension.clearcoatRoughnessFactor !== undefined) {\n      materialParams.clearcoatRoughness = extension.clearcoatRoughnessFactor;\n    }\n\n    if (extension.clearcoatRoughnessTexture !== undefined) {\n      pending.push(\n        parser.assignTexture(\n          materialParams,\n          'clearcoatRoughnessMap',\n          extension.clearcoatRoughnessTexture\n        )\n      );\n    }\n\n    if (extension.clearcoatNormalTexture !== undefined) {\n      pending.push(\n        parser.assignTexture(\n          materialParams,\n          'clearcoatNormalMap',\n          extension.clearcoatNormalTexture\n        )\n      );\n\n      if (extension.clearcoatNormalTexture.scale !== undefined) {\n        var scale = extension.clearcoatNormalTexture.scale;\n\n        materialParams.clearcoatNormalScale = new Vector2(scale, scale);\n      }\n    }\n\n    return Promise.all(pending);\n  };\n\n  /* BINARY EXTENSION */\n  var BINARY_EXTENSION_HEADER_MAGIC = 'glTF';\n  var BINARY_EXTENSION_HEADER_LENGTH = 12;\n  var BINARY_EXTENSION_CHUNK_TYPES = { JSON: 0x4e4f534a, BIN: 0x004e4942 };\n\n  function GLTFBinaryExtension(data) {\n    this.name = EXTENSIONS.KHR_BINARY_GLTF;\n    this.content = null;\n    this.body = null;\n\n    var headerView = new DataView(data, 0, BINARY_EXTENSION_HEADER_LENGTH);\n\n    this.header = {\n      magic: LoaderUtils.decodeText(new Uint8Array(data.slice(0, 4))),\n      version: headerView.getUint32(4, true),\n      length: headerView.getUint32(8, true)\n    };\n\n    if (this.header.magic !== BINARY_EXTENSION_HEADER_MAGIC) {\n      throw new Error('THREE.GLTFLoader: Unsupported glTF-Binary header.');\n    } else if (this.header.version < 2.0) {\n      throw new Error('THREE.GLTFLoader: Legacy binary file detected.');\n    }\n\n    var chunkView = new DataView(data, BINARY_EXTENSION_HEADER_LENGTH);\n    var chunkIndex = 0;\n\n    while (chunkIndex < chunkView.byteLength) {\n      var chunkLength = chunkView.getUint32(chunkIndex, true);\n      chunkIndex += 4;\n\n      var chunkType = chunkView.getUint32(chunkIndex, true);\n      chunkIndex += 4;\n\n      if (chunkType === BINARY_EXTENSION_CHUNK_TYPES.JSON) {\n        var contentArray = new Uint8Array(\n          data,\n          BINARY_EXTENSION_HEADER_LENGTH + chunkIndex,\n          chunkLength\n        );\n        this.content = LoaderUtils.decodeText(contentArray);\n      } else if (chunkType === BINARY_EXTENSION_CHUNK_TYPES.BIN) {\n        var byteOffset = BINARY_EXTENSION_HEADER_LENGTH + chunkIndex;\n        this.body = data.slice(byteOffset, byteOffset + chunkLength);\n      }\n\n      // Clients must ignore chunks with unknown types.\n\n      chunkIndex += chunkLength;\n    }\n\n    if (this.content === null) {\n      throw new Error('THREE.GLTFLoader: JSON content not found.');\n    }\n  }\n\n  /**\n   * DRACO Mesh Compression Extension\n   *\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_draco_mesh_compression\n   */\n  function GLTFDracoMeshCompressionExtension(json, dracoLoader) {\n    if (!dracoLoader) {\n      throw new Error('THREE.GLTFLoader: No DRACOLoader instance provided.');\n    }\n\n    this.name = EXTENSIONS.KHR_DRACO_MESH_COMPRESSION;\n    this.json = json;\n    this.dracoLoader = dracoLoader;\n    this.dracoLoader.preload();\n  }\n\n  GLTFDracoMeshCompressionExtension.prototype.decodePrimitive = function (primitive, parser) {\n    var json = this.json;\n    var dracoLoader = this.dracoLoader;\n    var bufferViewIndex = primitive.extensions[this.name].bufferView;\n    var gltfAttributeMap = primitive.extensions[this.name].attributes;\n    var threeAttributeMap = {};\n    var attributeNormalizedMap = {};\n    var attributeTypeMap = {};\n\n    for (var attributeName in gltfAttributeMap) {\n      var threeAttributeName = ATTRIBUTES[attributeName] || attributeName.toLowerCase();\n\n      threeAttributeMap[threeAttributeName] = gltfAttributeMap[attributeName];\n    }\n\n    for (attributeName in primitive.attributes) {\n      var threeAttributeName = ATTRIBUTES[attributeName] || attributeName.toLowerCase();\n\n      if (gltfAttributeMap[attributeName] !== undefined) {\n        var accessorDef = json.accessors[primitive.attributes[attributeName]];\n        var componentType = WEBGL_COMPONENT_TYPES[accessorDef.componentType];\n\n        attributeTypeMap[threeAttributeName] = componentType;\n        attributeNormalizedMap[threeAttributeName] = accessorDef.normalized === true;\n      }\n    }\n\n    return parser.getDependency('bufferView', bufferViewIndex).then(function (bufferView) {\n      return new Promise(function (resolve) {\n        dracoLoader.decodeDracoFile(\n          bufferView,\n          function (geometry) {\n            for (var attributeName in geometry.attributes) {\n              var attribute = geometry.attributes[attributeName];\n              var normalized = attributeNormalizedMap[attributeName];\n\n              if (normalized !== undefined) attribute.normalized = normalized;\n            }\n\n            resolve(geometry);\n          },\n          threeAttributeMap,\n          attributeTypeMap\n        );\n      });\n    });\n  };\n\n  /**\n   * Texture Transform Extension\n   *\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_texture_transform\n   */\n  function GLTFTextureTransformExtension() {\n    this.name = EXTENSIONS.KHR_TEXTURE_TRANSFORM;\n  }\n\n  GLTFTextureTransformExtension.prototype.extendTexture = function (texture, transform) {\n    texture = texture.clone();\n\n    if (transform.offset !== undefined) {\n      texture.offset.fromArray(transform.offset);\n    }\n\n    if (transform.rotation !== undefined) {\n      texture.rotation = transform.rotation;\n    }\n\n    if (transform.scale !== undefined) {\n      texture.repeat.fromArray(transform.scale);\n    }\n\n    if (transform.texCoord !== undefined) {\n      console.warn(\n        'THREE.GLTFLoader: Custom UV sets in \"' + this.name + '\" extension not yet supported.'\n      );\n    }\n\n    texture.needsUpdate = true;\n\n    return texture;\n  };\n\n  /**\n   * Specular-Glossiness Extension\n   *\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_pbrSpecularGlossiness\n   */\n\n  /**\n   * A sub class of StandardMaterial with some of the functionality\n   * changed via the `onBeforeCompile` callback\n   * @pailhead\n   */\n\n  function GLTFMeshStandardSGMaterial(params) {\n    MeshStandardMaterial.call(this);\n\n    this.isGLTFSpecularGlossinessMaterial = true;\n\n    //various chunks that need replacing\n    var specularMapParsFragmentChunk = [\n      '#ifdef USE_SPECULARMAP',\n      '\tuniform sampler2D specularMap;',\n      '#endif',\n    ].join('\\n');\n\n    var glossinessMapParsFragmentChunk = [\n      '#ifdef USE_GLOSSINESSMAP',\n      '\tuniform sampler2D glossinessMap;',\n      '#endif',\n    ].join('\\n');\n\n    var specularMapFragmentChunk = [\n      'vec3 specularFactor = specular;',\n      '#ifdef USE_SPECULARMAP',\n      '\tvec4 texelSpecular = texture2D( specularMap, vUv );',\n      '\ttexelSpecular = sRGBToLinear( texelSpecular );',\n      '\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture',\n      '\tspecularFactor *= texelSpecular.rgb;',\n      '#endif',\n    ].join('\\n');\n\n    var glossinessMapFragmentChunk = [\n      'float glossinessFactor = glossiness;',\n      '#ifdef USE_GLOSSINESSMAP',\n      '\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );',\n      '\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture',\n      '\tglossinessFactor *= texelGlossiness.a;',\n      '#endif',\n    ].join('\\n');\n\n    var lightPhysicalFragmentChunk = [\n      'PhysicalMaterial material;',\n      'material.diffuseColor = diffuseColor.rgb;',\n      'vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );',\n      'float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );',\n      'material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.',\n      'material.specularRoughness += geometryRoughness;',\n      'material.specularRoughness = min( material.specularRoughness, 1.0 );',\n      'material.specularColor = specularFactor.rgb;',\n    ].join('\\n');\n\n    var uniforms = {\n      specular: { value: new Color().setHex(0xffffff) },\n      glossiness: { value: 1 },\n      specularMap: { value: null },\n      glossinessMap: { value: null },\n    };\n\n    this._extraUniforms = uniforms;\n\n    // please see #14031 or #13198 for an alternate approach\n    this.onBeforeCompile = function (shader) {\n      for (var uniformName in uniforms) {\n        shader.uniforms[uniformName] = uniforms[uniformName];\n      }\n\n      shader.fragmentShader = shader.fragmentShader.replace(\n        'uniform float roughness;',\n        'uniform vec3 specular;'\n      );\n      shader.fragmentShader = shader.fragmentShader.replace(\n        'uniform float metalness;',\n        'uniform float glossiness;'\n      );\n      shader.fragmentShader = shader.fragmentShader.replace(\n        '#include <roughnessmap_pars_fragment>',\n        specularMapParsFragmentChunk\n      );\n      shader.fragmentShader = shader.fragmentShader.replace(\n        '#include <metalnessmap_pars_fragment>',\n        glossinessMapParsFragmentChunk\n      );\n      shader.fragmentShader = shader.fragmentShader.replace(\n        '#include <roughnessmap_fragment>',\n        specularMapFragmentChunk\n      );\n      shader.fragmentShader = shader.fragmentShader.replace(\n        '#include <metalnessmap_fragment>',\n        glossinessMapFragmentChunk\n      );\n      shader.fragmentShader = shader.fragmentShader.replace(\n        '#include <lights_physical_fragment>',\n        lightPhysicalFragmentChunk\n      );\n    };\n\n    /*eslint-disable*/\n    Object.defineProperties(this, {\n      specular: {\n        get: function () {\n          return uniforms.specular.value;\n        },\n        set: function (v) {\n          uniforms.specular.value = v;\n        },\n      },\n      specularMap: {\n        get: function () {\n          return uniforms.specularMap.value;\n        },\n        set: function (v) {\n          uniforms.specularMap.value = v;\n        },\n      },\n      glossiness: {\n        get: function () {\n          return uniforms.glossiness.value;\n        },\n        set: function (v) {\n          uniforms.glossiness.value = v;\n        },\n      },\n      glossinessMap: {\n        get: function () {\n          return uniforms.glossinessMap.value;\n        },\n        set: function (v) {\n          uniforms.glossinessMap.value = v;\n          //how about something like this - @pailhead\n          if (v) {\n            this.defines.USE_GLOSSINESSMAP = '';\n            // set USE_ROUGHNESSMAP to enable vUv\n            this.defines.USE_ROUGHNESSMAP = '';\n          } else {\n            delete this.defines.USE_ROUGHNESSMAP;\n            delete this.defines.USE_GLOSSINESSMAP;\n          }\n        },\n      },\n    });\n\n    /*eslint-enable*/\n    delete this.metalness;\n    delete this.roughness;\n    delete this.metalnessMap;\n    delete this.roughnessMap;\n\n    this.setValues(params);\n  }\n\n  GLTFMeshStandardSGMaterial.prototype = Object.create(MeshStandardMaterial.prototype);\n  GLTFMeshStandardSGMaterial.prototype.constructor = GLTFMeshStandardSGMaterial;\n\n  GLTFMeshStandardSGMaterial.prototype.copy = function (source) {\n    MeshStandardMaterial.prototype.copy.call(this, source);\n    this.specularMap = source.specularMap;\n    this.specular.copy(source.specular);\n    this.glossinessMap = source.glossinessMap;\n    this.glossiness = source.glossiness;\n    delete this.metalness;\n    delete this.roughness;\n    delete this.metalnessMap;\n    delete this.roughnessMap;\n    return this;\n  };\n\n  function GLTFMaterialsPbrSpecularGlossinessExtension() {\n    return {\n      name: EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,\n\n      specularGlossinessParams: [\n        'color',\n        'map',\n        'lightMap',\n        'lightMapIntensity',\n        'aoMap',\n        'aoMapIntensity',\n        'emissive',\n        'emissiveIntensity',\n        'emissiveMap',\n        'bumpMap',\n        'bumpScale',\n        'normalMap',\n        'normalMapType',\n        'displacementMap',\n        'displacementScale',\n        'displacementBias',\n        'specularMap',\n        'specular',\n        'glossinessMap',\n        'glossiness',\n        'alphaMap',\n        'envMap',\n        'envMapIntensity',\n        'refractionRatio',\n      ],\n\n      getMaterialType: function () {\n        return GLTFMeshStandardSGMaterial;\n      },\n\n      extendParams: function (materialParams, materialDef, parser) {\n        var pbrSpecularGlossiness = materialDef.extensions[this.name];\n\n        materialParams.color = new Color(1.0, 1.0, 1.0);\n        materialParams.opacity = 1.0;\n\n        var pending = [];\n\n        if (Array.isArray(pbrSpecularGlossiness.diffuseFactor)) {\n          var array = pbrSpecularGlossiness.diffuseFactor;\n\n          materialParams.color.fromArray(array);\n          materialParams.opacity = array[3];\n        }\n\n        if (pbrSpecularGlossiness.diffuseTexture !== undefined) {\n          pending.push(\n            parser.assignTexture(materialParams, 'map', pbrSpecularGlossiness.diffuseTexture)\n          );\n        }\n\n        materialParams.emissive = new Color(0.0, 0.0, 0.0);\n        materialParams.glossiness =\n          pbrSpecularGlossiness.glossinessFactor !== undefined\n            ? pbrSpecularGlossiness.glossinessFactor\n            : 1.0;\n        materialParams.specular = new Color(1.0, 1.0, 1.0);\n\n        if (Array.isArray(pbrSpecularGlossiness.specularFactor)) {\n          materialParams.specular.fromArray(pbrSpecularGlossiness.specularFactor);\n        }\n\n        if (pbrSpecularGlossiness.specularGlossinessTexture !== undefined) {\n          var specGlossMapDef = pbrSpecularGlossiness.specularGlossinessTexture;\n          pending.push(parser.assignTexture(materialParams, 'glossinessMap', specGlossMapDef));\n          pending.push(parser.assignTexture(materialParams, 'specularMap', specGlossMapDef));\n        }\n\n        return Promise.all(pending);\n      },\n\n      createMaterial: function (materialParams) {\n        var material = new GLTFMeshStandardSGMaterial(materialParams);\n        material.fog = true;\n\n        material.color = materialParams.color;\n\n        material.map = materialParams.map === undefined ? null : materialParams.map;\n\n        material.lightMap = null;\n        material.lightMapIntensity = 1.0;\n\n        material.aoMap = materialParams.aoMap === undefined ? null : materialParams.aoMap;\n        material.aoMapIntensity = 1.0;\n\n        material.emissive = materialParams.emissive;\n        material.emissiveIntensity = 1.0;\n        material.emissiveMap =\n          materialParams.emissiveMap === undefined ? null : materialParams.emissiveMap;\n\n        material.bumpMap = materialParams.bumpMap === undefined ? null : materialParams.bumpMap;\n        material.bumpScale = 1;\n\n        material.normalMap =\n          materialParams.normalMap === undefined ? null : materialParams.normalMap;\n        material.normalMapType = TangentSpaceNormalMap;\n\n        if (materialParams.normalScale) material.normalScale = materialParams.normalScale;\n\n        material.displacementMap = null;\n        material.displacementScale = 1;\n        material.displacementBias = 0;\n\n        material.specularMap =\n          materialParams.specularMap === undefined ? null : materialParams.specularMap;\n        material.specular = materialParams.specular;\n\n        material.glossinessMap =\n          materialParams.glossinessMap === undefined ? null : materialParams.glossinessMap;\n        material.glossiness = materialParams.glossiness;\n\n        material.alphaMap = null;\n\n        material.envMap = materialParams.envMap === undefined ? null : materialParams.envMap;\n        material.envMapIntensity = 1.0;\n\n        material.refractionRatio = 0.98;\n\n        return material;\n      },\n    };\n  }\n\n  /**\n   * Mesh Quantization Extension\n   *\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_mesh_quantization\n   */\n  function GLTFMeshQuantizationExtension() {\n    this.name = EXTENSIONS.KHR_MESH_QUANTIZATION;\n  }\n\n  /*********************************/\n  /********** INTERPOLATION ********/\n  /*********************************/\n\n  // Spline Interpolation\n  // Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#appendix-c-spline-interpolation\n  function GLTFCubicSplineInterpolant(parameterPositions, sampleValues, sampleSize, resultBuffer) {\n    Interpolant.call(this, parameterPositions, sampleValues, sampleSize, resultBuffer);\n  }\n\n  GLTFCubicSplineInterpolant.prototype = Object.create(Interpolant.prototype);\n  GLTFCubicSplineInterpolant.prototype.constructor = GLTFCubicSplineInterpolant;\n\n  GLTFCubicSplineInterpolant.prototype.copySampleValue_ = function (index) {\n    // Copies a sample value to the result buffer. See description of glTF\n    // CUBICSPLINE values layout in interpolate_() function below.\n\n    var result = this.resultBuffer,\n      values = this.sampleValues,\n      valueSize = this.valueSize,\n      offset = index * valueSize * 3 + valueSize;\n\n    for (var i = 0; i !== valueSize; i++) {\n      result[i] = values[offset + i];\n    }\n\n    return result;\n  };\n\n  GLTFCubicSplineInterpolant.prototype.beforeStart_ =\n    GLTFCubicSplineInterpolant.prototype.copySampleValue_;\n\n  GLTFCubicSplineInterpolant.prototype.afterEnd_ =\n    GLTFCubicSplineInterpolant.prototype.copySampleValue_;\n\n  GLTFCubicSplineInterpolant.prototype.interpolate_ = function (i1, t0, t, t1) {\n    var result = this.resultBuffer;\n    var values = this.sampleValues;\n    var stride = this.valueSize;\n\n    var stride2 = stride * 2;\n    var stride3 = stride * 3;\n\n    var td = t1 - t0;\n\n    var p = (t - t0) / td;\n    var pp = p * p;\n    var ppp = pp * p;\n\n    var offset1 = i1 * stride3;\n    var offset0 = offset1 - stride3;\n\n    var s2 = -2 * ppp + 3 * pp;\n    var s3 = ppp - pp;\n    var s0 = 1 - s2;\n    var s1 = s3 - pp + p;\n\n    // Layout of keyframe output values for CUBICSPLINE animations:\n    //   [ inTangent_1, splineVertex_1, outTangent_1, inTangent_2, splineVertex_2, ... ]\n    for (var i = 0; i !== stride; i++) {\n      var p0 = values[offset0 + i + stride]; // splineVertex_k\n      var m0 = values[offset0 + i + stride2] * td; // outTangent_k * (t_k+1 - t_k)\n      var p1 = values[offset1 + i + stride]; // splineVertex_k+1\n      var m1 = values[offset1 + i] * td; // inTangent_k+1 * (t_k+1 - t_k)\n\n      result[i] = s0 * p0 + s1 * m0 + s2 * p1 + s3 * m1;\n    }\n\n    return result;\n  };\n\n  /*********************************/\n  /********** INTERNALS ************/\n  /*********************************/\n\n  /* CONSTANTS */\n\n  var WEBGL_CONSTANTS = {\n    FLOAT: 5126,\n    //FLOAT_MAT2: 35674,\n    FLOAT_MAT3: 35675,\n    FLOAT_MAT4: 35676,\n    FLOAT_VEC2: 35664,\n    FLOAT_VEC3: 35665,\n    FLOAT_VEC4: 35666,\n    LINEAR: 9729,\n    REPEAT: 10497,\n    SAMPLER_2D: 35678,\n    POINTS: 0,\n    LINES: 1,\n    LINE_LOOP: 2,\n    LINE_STRIP: 3,\n    TRIANGLES: 4,\n    TRIANGLE_STRIP: 5,\n    TRIANGLE_FAN: 6,\n    UNSIGNED_BYTE: 5121,\n    UNSIGNED_SHORT: 5123,\n  };\n\n  var WEBGL_COMPONENT_TYPES = {\n    5120: Int8Array,\n    5121: Uint8Array,\n    5122: Int16Array,\n    5123: Uint16Array,\n    5125: Uint32Array,\n    5126: Float32Array,\n  };\n\n  var WEBGL_FILTERS = {\n    9728: NearestFilter,\n    9729: LinearFilter,\n    9984: NearestMipmapNearestFilter,\n    9985: LinearMipmapNearestFilter,\n    9986: NearestMipmapLinearFilter,\n    9987: LinearMipmapLinearFilter,\n  };\n\n  var WEBGL_WRAPPINGS = {\n    33071: ClampToEdgeWrapping,\n    33648: MirroredRepeatWrapping,\n    10497: RepeatWrapping,\n  };\n\n  var WEBGL_TYPE_SIZES = {\n    SCALAR: 1,\n    VEC2: 2,\n    VEC3: 3,\n    VEC4: 4,\n    MAT2: 4,\n    MAT3: 9,\n    MAT4: 16,\n  };\n\n  var ATTRIBUTES = {\n    POSITION: 'position',\n    NORMAL: 'normal',\n    TANGENT: 'tangent',\n    TEXCOORD_0: 'uv',\n    TEXCOORD_1: 'uv2',\n    COLOR_0: 'color',\n    WEIGHTS_0: 'skinWeight',\n    JOINTS_0: 'skinIndex',\n  };\n\n  var PATH_PROPERTIES = {\n    scale: 'scale',\n    translation: 'position',\n    rotation: 'quaternion',\n    weights: 'morphTargetInfluences',\n  };\n\n  var INTERPOLATION = {\n    CUBICSPLINE: undefined, // We use a custom interpolant (GLTFCubicSplineInterpolation) for CUBICSPLINE tracks. Each\n    // keyframe track will be initialized with a default interpolation type, then modified.\n    LINEAR: InterpolateLinear,\n    STEP: InterpolateDiscrete,\n  };\n\n  var ALPHA_MODES = {\n    OPAQUE: 'OPAQUE',\n    MASK: 'MASK',\n    BLEND: 'BLEND',\n  };\n\n  var MIME_TYPE_FORMATS = {\n    'image/png': RGBAFormat,\n    'image/jpeg': RGBFormat,\n  };\n\n  /* UTILITY FUNCTIONS */\n\n  function resolveURL(url, path) {\n    // Invalid URL\n    if (typeof url !== 'string' || url === '') return '';\n\n    // Host Relative URL\n    if (/^https?:\\/\\//i.test(path) && /^\\//.test(url)) {\n      // eslint-disable-next-line no-useless-escape\n      path = path.replace(/(^https?:\\/\\/[^\\/]+).*/i, '$1');\n    }\n\n    // Absolute URL http://,https://,//\n    if (/^(https?:)?\\/\\//i.test(url)) return url;\n\n    // Data URI\n    if (/^data:.*,.*$/i.test(url)) return url;\n\n    // Blob URL\n    if (/^blob:.*$/i.test(url)) return url;\n\n    // Relative URL\n    return path + url;\n  }\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#default-material\n   */\n  function createDefaultMaterial(cache) {\n    if (cache['DefaultMaterial'] === undefined) {\n      cache['DefaultMaterial'] = new MeshStandardMaterial({\n        color: 0xffffff,\n        emissive: 0x000000,\n        metalness: 1,\n        roughness: 1,\n        transparent: false,\n        depthTest: true,\n        side: FrontSide,\n      });\n    }\n\n    return cache['DefaultMaterial'];\n  }\n\n  function addUnknownExtensionsToUserData(knownExtensions, object, objectDef) {\n    // Add unknown glTF extensions to an object's userData.\n\n    for (var name in objectDef.extensions) {\n      if (knownExtensions[name] === undefined) {\n        object.userData.gltfExtensions = object.userData.gltfExtensions || {};\n        object.userData.gltfExtensions[name] = objectDef.extensions[name];\n      }\n    }\n  }\n\n  /**\n   * @param {Object3D|Material|BufferGeometry} object\n   * @param {GLTF.definition} gltfDef\n   */\n  function assignExtrasToUserData(object, gltfDef) {\n    if (gltfDef.extras !== undefined) {\n      if (typeof gltfDef.extras === 'object') {\n        Object.assign(object.userData, gltfDef.extras);\n      } else {\n        console.warn('THREE.GLTFLoader: Ignoring primitive type .extras, ' + gltfDef.extras);\n      }\n    }\n  }\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#morph-targets\n   *\n   * @param {BufferGeometry} geometry\n   * @param {Array<GLTF.Target>} targets\n   * @param {GLTFParser} parser\n   * @return {Promise<BufferGeometry>}\n   */\n  function addMorphTargets(geometry, targets, parser) {\n    var hasMorphPosition = false;\n    var hasMorphNormal = false;\n\n    for (var i = 0, il = targets.length; i < il; i++) {\n      var target = targets[i];\n\n      if (target.POSITION !== undefined) hasMorphPosition = true;\n      if (target.NORMAL !== undefined) hasMorphNormal = true;\n\n      if (hasMorphPosition && hasMorphNormal) break;\n    }\n\n    if (!hasMorphPosition && !hasMorphNormal) return Promise.resolve(geometry);\n\n    var pendingPositionAccessors = [];\n    var pendingNormalAccessors = [];\n\n    for (var i = 0, il = targets.length; i < il; i++) {\n      var target = targets[i];\n\n      if (hasMorphPosition) {\n        var pendingAccessor =\n              target.POSITION !== undefined\n                ? parser.getDependency('accessor', target.POSITION)\n                : geometry.attributes.position;\n\n        pendingPositionAccessors.push(pendingAccessor);\n      }\n\n      if (hasMorphNormal) {\n        var pendingAccessor =\n              target.NORMAL !== undefined\n                ? parser.getDependency('accessor', target.NORMAL)\n                : geometry.attributes.normal;\n\n        pendingNormalAccessors.push(pendingAccessor);\n      }\n    }\n\n    return Promise.all([\n      Promise.all(pendingPositionAccessors),\n      Promise.all(pendingNormalAccessors),\n    ]).then(function (accessors) {\n      var morphPositions = accessors[0];\n      var morphNormals = accessors[1];\n\n      if (hasMorphPosition) geometry.morphAttributes.position = morphPositions;\n      if (hasMorphNormal) geometry.morphAttributes.normal = morphNormals;\n      geometry.morphTargetsRelative = true;\n\n      return geometry;\n    });\n  }\n\n  /**\n   * @param {Mesh} mesh\n   * @param {GLTF.Mesh} meshDef\n   */\n  function updateMorphTargets(mesh, meshDef) {\n    mesh.updateMorphTargets();\n\n    if (meshDef.weights !== undefined) {\n      for (var i = 0, il = meshDef.weights.length; i < il; i++) {\n        mesh.morphTargetInfluences[i] = meshDef.weights[i];\n      }\n    }\n\n    // .extras has user-defined data, so check that .extras.targetNames is an array.\n    if (meshDef.extras && Array.isArray(meshDef.extras.targetNames)) {\n      var targetNames = meshDef.extras.targetNames;\n\n      if (mesh.morphTargetInfluences.length === targetNames.length) {\n        mesh.morphTargetDictionary = {};\n\n        for (var i = 0, il = targetNames.length; i < il; i++) {\n          mesh.morphTargetDictionary[targetNames[i]] = i;\n        }\n      } else {\n        console.warn('THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.');\n      }\n    }\n  }\n\n  function createPrimitiveKey(primitiveDef) {\n    var dracoExtension =\n          primitiveDef.extensions && primitiveDef.extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION];\n    var geometryKey;\n\n    if (dracoExtension) {\n      geometryKey =\n        'draco:' +\n        dracoExtension.bufferView +\n        ':' +\n        dracoExtension.indices +\n        ':' +\n        createAttributesKey(dracoExtension.attributes);\n    } else {\n      geometryKey =\n        primitiveDef.indices +\n        ':' +\n        createAttributesKey(primitiveDef.attributes) +\n        ':' +\n        primitiveDef.mode;\n    }\n\n    return geometryKey;\n  }\n\n  function createAttributesKey(attributes) {\n    var attributesKey = '';\n\n    var keys = Object.keys(attributes).sort();\n\n    for (var i = 0, il = keys.length; i < il; i++) {\n      attributesKey += keys[i] + ':' + attributes[keys[i]] + ';';\n    }\n\n    return attributesKey;\n  }\n\n  /* GLTF PARSER */\n\n  function GLTFParser(json, extensions, options) {\n    this.json = json || {};\n    this.extensions = extensions || {};\n    this.options = options || {};\n\n    // loader object cache\n    this.cache = new GLTFRegistry();\n\n    // BufferGeometry caching\n    this.primitiveCache = {};\n\n    this.textureLoader = new TextureLoader(this.options.manager);\n    this.textureLoader.setCrossOrigin(this.options.crossOrigin);\n\n    this.fileLoader = new FileLoader(this.options.manager);\n    this.fileLoader.setResponseType('arraybuffer');\n\n    if (this.options.crossOrigin === 'use-credentials') {\n      this.fileLoader.setWithCredentials(true);\n    }\n  }\n\n  GLTFParser.prototype.parse = function (onLoad, onError) {\n    var parser = this;\n    var json = this.json;\n    var extensions = this.extensions;\n\n    // Clear the loader cache\n    this.cache.removeAll();\n\n    // Mark the special nodes/meshes in json for efficient parse\n    this.markDefs();\n\n    Promise.all([\n      this.getDependencies('scene'),\n      this.getDependencies('animation'),\n      this.getDependencies('camera'),\n    ])\n      .then(function (dependencies) {\n        var result = {\n          scene: dependencies[0][json.scene || 0],\n          scenes: dependencies[0],\n          animations: dependencies[1],\n          cameras: dependencies[2],\n          asset: json.asset,\n          parser: parser,\n          userData: {},\n        };\n\n        addUnknownExtensionsToUserData(extensions, result, json);\n\n        assignExtrasToUserData(result, json);\n\n        onLoad(result);\n      })\n      .catch(onError);\n  };\n\n  /**\n   * Marks the special nodes/meshes in json for efficient parse.\n   */\n  GLTFParser.prototype.markDefs = function () {\n    var nodeDefs = this.json.nodes || [];\n    var skinDefs = this.json.skins || [];\n    var meshDefs = this.json.meshes || [];\n\n    var meshReferences = {};\n    var meshUses = {};\n\n    // Nothing in the node definition indicates whether it is a Bone or an\n    // Object3D. Use the skins' joint references to mark bones.\n    for (var skinIndex = 0, skinLength = skinDefs.length; skinIndex < skinLength; skinIndex++) {\n      var joints = skinDefs[skinIndex].joints;\n\n      for (var i = 0, il = joints.length; i < il; i++) {\n        nodeDefs[joints[i]].isBone = true;\n      }\n    }\n\n    // Meshes can (and should) be reused by multiple nodes in a glTF asset. To\n    // avoid having more than one Mesh with the same name, count\n    // references and rename instances below.\n    //\n    // Example: CesiumMilkTruck sample model reuses \"Wheel\" meshes.\n    for (var nodeIndex = 0, nodeLength = nodeDefs.length; nodeIndex < nodeLength; nodeIndex++) {\n      var nodeDef = nodeDefs[nodeIndex];\n\n      if (nodeDef.mesh !== undefined) {\n        if (meshReferences[nodeDef.mesh] === undefined) {\n          meshReferences[nodeDef.mesh] = meshUses[nodeDef.mesh] = 0;\n        }\n\n        meshReferences[nodeDef.mesh]++;\n\n        // Nothing in the mesh definition indicates whether it is\n        // a SkinnedMesh or Mesh. Use the node's mesh reference\n        // to mark SkinnedMesh if node has skin.\n        if (nodeDef.skin !== undefined) {\n          meshDefs[nodeDef.mesh].isSkinnedMesh = true;\n        }\n      }\n    }\n\n    this.json.meshReferences = meshReferences;\n    this.json.meshUses = meshUses;\n  };\n\n  /**\n   * Requests the specified dependency asynchronously, with caching.\n   * @param {string} type\n   * @param {number} index\n   * @return {Promise<Object3D|Material|THREE.Texture|AnimationClip|ArrayBuffer|Object>}\n   */\n  GLTFParser.prototype.getDependency = function (type, index) {\n    var cacheKey = type + ':' + index;\n    var dependency = this.cache.get(cacheKey);\n\n    if (!dependency) {\n      switch (type) {\n        case 'scene':\n          dependency = this.loadScene(index);\n          break;\n\n        case 'node':\n          dependency = this.loadNode(index);\n          break;\n\n        case 'mesh':\n          dependency = this.loadMesh(index);\n          break;\n\n        case 'accessor':\n          dependency = this.loadAccessor(index);\n          break;\n\n        case 'bufferView':\n          dependency = this.loadBufferView(index);\n          break;\n\n        case 'buffer':\n          dependency = this.loadBuffer(index);\n          break;\n\n        case 'material':\n          dependency = this.loadMaterial(index);\n          break;\n\n        case 'texture':\n          dependency = this.loadTexture(index);\n          break;\n\n        case 'skin':\n          dependency = this.loadSkin(index);\n          break;\n\n        case 'animation':\n          dependency = this.loadAnimation(index);\n          break;\n\n        case 'camera':\n          dependency = this.loadCamera(index);\n          break;\n\n        case 'light':\n          dependency = this.extensions[EXTENSIONS.KHR_LIGHTS_PUNCTUAL].loadLight(index);\n          break;\n\n        default:\n          throw new Error('Unknown type: ' + type);\n      }\n\n      this.cache.add(cacheKey, dependency);\n    }\n\n    return dependency;\n  };\n\n  /**\n   * Requests all dependencies of the specified type asynchronously, with caching.\n   * @param {string} type\n   * @return {Promise<Array<Object>>}\n   */\n  GLTFParser.prototype.getDependencies = function (type) {\n    var dependencies = this.cache.get(type);\n\n    if (!dependencies) {\n      var parser = this;\n      var defs = this.json[type + (type === 'mesh' ? 'es' : 's')] || [];\n\n      dependencies = Promise.all(\n        defs.map(function (def, index) {\n          return parser.getDependency(type, index);\n        })\n      );\n\n      this.cache.add(type, dependencies);\n    }\n\n    return dependencies;\n  };\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n   * @param {number} bufferIndex\n   * @return {Promise<ArrayBuffer>}\n   */\n  GLTFParser.prototype.loadBuffer = function (bufferIndex) {\n    var bufferDef = this.json.buffers[bufferIndex];\n    var loader = this.fileLoader;\n\n    if (bufferDef.type && bufferDef.type !== 'arraybuffer') {\n      throw new Error('THREE.GLTFLoader: ' + bufferDef.type + ' buffer type is not supported.');\n    }\n\n    // If present, GLB container is required to be the first buffer.\n    if (bufferDef.uri === undefined && bufferIndex === 0) {\n      return Promise.resolve(this.extensions[EXTENSIONS.KHR_BINARY_GLTF].body);\n    }\n\n    var options = this.options;\n\n    return new Promise(function (resolve, reject) {\n      loader.load(resolveURL(bufferDef.uri, options.path), resolve, undefined, function () {\n        reject(new Error('THREE.GLTFLoader: Failed to load buffer \"' + bufferDef.uri + '\".'));\n      });\n    });\n  };\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n   * @param {number} bufferViewIndex\n   * @return {Promise<ArrayBuffer>}\n   */\n  GLTFParser.prototype.loadBufferView = function (bufferViewIndex) {\n    var bufferViewDef = this.json.bufferViews[bufferViewIndex];\n\n    return this.getDependency('buffer', bufferViewDef.buffer).then(function (buffer) {\n      var byteLength = bufferViewDef.byteLength || 0;\n      var byteOffset = bufferViewDef.byteOffset || 0;\n      return buffer.slice(byteOffset, byteOffset + byteLength);\n    });\n  };\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#accessors\n   * @param {number} accessorIndex\n   * @return {Promise<BufferAttribute|InterleavedBufferAttribute>}\n   */\n  GLTFParser.prototype.loadAccessor = function (accessorIndex) {\n    var parser = this;\n    var json = this.json;\n\n    var accessorDef = this.json.accessors[accessorIndex];\n\n    if (accessorDef.bufferView === undefined && accessorDef.sparse === undefined) {\n      // Ignore empty accessors, which may be used to declare runtime\n      // information about attributes coming from another source (e.g. Draco\n      // compression extension).\n      return Promise.resolve(null);\n    }\n\n    var pendingBufferViews = [];\n\n    if (accessorDef.bufferView !== undefined) {\n      pendingBufferViews.push(this.getDependency('bufferView', accessorDef.bufferView));\n    } else {\n      pendingBufferViews.push(null);\n    }\n\n    if (accessorDef.sparse !== undefined) {\n      pendingBufferViews.push(\n        this.getDependency('bufferView', accessorDef.sparse.indices.bufferView)\n      );\n      pendingBufferViews.push(\n        this.getDependency('bufferView', accessorDef.sparse.values.bufferView)\n      );\n    }\n\n    return Promise.all(pendingBufferViews).then(function (bufferViews) {\n      var bufferView = bufferViews[0];\n\n      var itemSize = WEBGL_TYPE_SIZES[accessorDef.type];\n      var TypedArray = WEBGL_COMPONENT_TYPES[accessorDef.componentType];\n\n      // For VEC3: itemSize is 3, elementBytes is 4, itemBytes is 12.\n      var elementBytes = TypedArray.BYTES_PER_ELEMENT;\n      var itemBytes = elementBytes * itemSize;\n      var byteOffset = accessorDef.byteOffset || 0;\n      var byteStride =\n            accessorDef.bufferView !== undefined\n              ? json.bufferViews[accessorDef.bufferView].byteStride\n              : undefined;\n      var normalized = accessorDef.normalized === true;\n      var array, bufferAttribute;\n\n      // The buffer is not interleaved if the stride is the item size in bytes.\n      if (byteStride && byteStride !== itemBytes) {\n        // Each \"slice\" of the buffer, as defined by 'count' elements of 'byteStride' bytes, gets its own InterleavedBuffer\n        // This makes sure that IBA.count reflects accessor.count properly\n        var ibSlice = Math.floor(byteOffset / byteStride);\n        var ibCacheKey =\n              'InterleavedBuffer:' +\n              accessorDef.bufferView +\n              ':' +\n              accessorDef.componentType +\n              ':' +\n              ibSlice +\n              ':' +\n              accessorDef.count;\n        var ib = parser.cache.get(ibCacheKey);\n\n        if (!ib) {\n          array = new TypedArray(\n            bufferView,\n            ibSlice * byteStride,\n            (accessorDef.count * byteStride) / elementBytes\n          );\n\n          // Integer parameters to IB/IBA are in array elements, not bytes.\n          ib = new InterleavedBuffer(array, byteStride / elementBytes);\n\n          parser.cache.add(ibCacheKey, ib);\n        }\n\n        bufferAttribute = new InterleavedBufferAttribute(\n          ib,\n          itemSize,\n          (byteOffset % byteStride) / elementBytes,\n          normalized\n        );\n      } else {\n        if (bufferView === null) {\n          array = new TypedArray(accessorDef.count * itemSize);\n        } else {\n          array = new TypedArray(bufferView, byteOffset, accessorDef.count * itemSize);\n        }\n\n        bufferAttribute = new BufferAttribute(array, itemSize, normalized);\n      }\n\n      // https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#sparse-accessors\n      if (accessorDef.sparse !== undefined) {\n        var itemSizeIndices = WEBGL_TYPE_SIZES.SCALAR;\n        var TypedArrayIndices = WEBGL_COMPONENT_TYPES[accessorDef.sparse.indices.componentType];\n\n        var byteOffsetIndices = accessorDef.sparse.indices.byteOffset || 0;\n        var byteOffsetValues = accessorDef.sparse.values.byteOffset || 0;\n\n        var sparseIndices = new TypedArrayIndices(\n          bufferViews[1],\n          byteOffsetIndices,\n          accessorDef.sparse.count * itemSizeIndices\n        );\n        var sparseValues = new TypedArray(\n          bufferViews[2],\n          byteOffsetValues,\n          accessorDef.sparse.count * itemSize\n        );\n\n        if (bufferView !== null) {\n          // Avoid modifying the original ArrayBuffer, if the bufferView wasn't initialized with zeroes.\n          bufferAttribute = new BufferAttribute(\n            bufferAttribute.array.slice(),\n            bufferAttribute.itemSize,\n            bufferAttribute.normalized\n          );\n        }\n\n        for (var i = 0, il = sparseIndices.length; i < il; i++) {\n          var index = sparseIndices[i];\n\n          bufferAttribute.setX(index, sparseValues[i * itemSize]);\n          if (itemSize >= 2) bufferAttribute.setY(index, sparseValues[i * itemSize + 1]);\n          if (itemSize >= 3) bufferAttribute.setZ(index, sparseValues[i * itemSize + 2]);\n          if (itemSize >= 4) bufferAttribute.setW(index, sparseValues[i * itemSize + 3]);\n          if (itemSize >= 5)\n            throw new Error('THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.');\n        }\n      }\n\n      return bufferAttribute;\n    });\n  };\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#textures\n   * @param {number} textureIndex\n   * @return {Promise<THREE.Texture>}\n   */\n  GLTFParser.prototype.loadTexture = function (textureIndex) {\n    var parser = this;\n    var json = this.json;\n    var options = this.options;\n    var textureLoader = this.textureLoader;\n\n    var URL = self.URL || self.webkitURL;\n\n    var textureDef = json.textures[textureIndex];\n\n    var textureExtensions = textureDef.extensions || {};\n\n    var source;\n\n    if (textureExtensions[EXTENSIONS.MSFT_TEXTURE_DDS]) {\n      source = json.images[textureExtensions[EXTENSIONS.MSFT_TEXTURE_DDS].source];\n    } else {\n      source = json.images[textureDef.source];\n    }\n\n    var sourceURI = source.uri;\n    var isObjectURL = false;\n\n    if (source.bufferView !== undefined) {\n      // Load binary image data from bufferView, if provided.\n\n      sourceURI = parser.getDependency('bufferView', source.bufferView).then(function (bufferView) {\n        isObjectURL = true;\n        var blob = new Blob([bufferView], { type: source.mimeType });\n        sourceURI = URL.createObjectURL(blob);\n        return sourceURI;\n      });\n    }\n\n    return Promise.resolve(sourceURI)\n      .then(function (sourceURI) {\n        // Load Texture resource.\n\n        var loader = options.manager.getHandler(sourceURI);\n\n        if (!loader) {\n          loader = textureExtensions[EXTENSIONS.MSFT_TEXTURE_DDS]\n            ? parser.extensions[EXTENSIONS.MSFT_TEXTURE_DDS].ddsLoader\n            : textureLoader;\n        }\n\n        return new Promise(function (resolve, reject) {\n          loader.load(resolveURL(sourceURI, options.path), resolve, undefined, reject);\n        });\n      })\n      .then(function (texture) {\n        // Clean up resources and configure Texture.\n\n        if (isObjectURL === true) {\n          URL.revokeObjectURL(sourceURI);\n        }\n\n        texture.flipY = false;\n\n        if (textureDef.name) texture.name = textureDef.name;\n\n        // Ignore unknown mime types, like DDS files.\n        if (source.mimeType in MIME_TYPE_FORMATS) {\n          texture.format = MIME_TYPE_FORMATS[source.mimeType];\n        }\n\n        var samplers = json.samplers || {};\n        var sampler = samplers[textureDef.sampler] || {};\n\n        texture.magFilter = WEBGL_FILTERS[sampler.magFilter] || LinearFilter;\n        texture.minFilter = WEBGL_FILTERS[sampler.minFilter] || LinearMipmapLinearFilter;\n        texture.wrapS = WEBGL_WRAPPINGS[sampler.wrapS] || RepeatWrapping;\n        texture.wrapT = WEBGL_WRAPPINGS[sampler.wrapT] || RepeatWrapping;\n\n        return texture;\n      });\n  };\n\n  /**\n   * Asynchronously assigns a texture to the given material parameters.\n   * @param {Object} materialParams\n   * @param {string} mapName\n   * @param {Object} mapDef\n   * @return {Promise}\n   */\n  GLTFParser.prototype.assignTexture = function (materialParams, mapName, mapDef) {\n    var parser = this;\n\n    return this.getDependency('texture', mapDef.index).then(function (texture) {\n      if (!texture.isCompressedTexture) {\n        switch (mapName) {\n          case 'aoMap':\n          case 'emissiveMap':\n          case 'metalnessMap':\n          case 'normalMap':\n          case 'roughnessMap':\n            texture.format = RGBFormat;\n            break;\n        }\n      }\n\n      // Materials sample aoMap from UV set 1 and other maps from UV set 0 - this can't be configured\n      // However, we will copy UV set 0 to UV set 1 on demand for aoMap\n      if (\n        mapDef.texCoord !== undefined &&\n        mapDef.texCoord != 0 &&\n        !(mapName === 'aoMap' && mapDef.texCoord == 1)\n      ) {\n        console.warn(\n          'THREE.GLTFLoader: Custom UV set ' +\n          mapDef.texCoord +\n          ' for texture ' +\n          mapName +\n          ' not yet supported.'\n        );\n      }\n\n      if (parser.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM]) {\n        var transform =\n              mapDef.extensions !== undefined\n                ? mapDef.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM]\n                : undefined;\n\n        if (transform) {\n          texture = parser.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM].extendTexture(\n            texture,\n            transform\n          );\n        }\n      }\n\n      materialParams[mapName] = texture;\n    });\n  };\n\n  /**\n   * Assigns final material to a Mesh, Line, or Points instance. The instance\n   * already has a material (generated from the glTF material options alone)\n   * but reuse of the same glTF material may require multiple threejs materials\n   * to accomodate different primitive types, defines, etc. New materials will\n   * be created if necessary, and reused from a cache.\n   * @param  {Object3D} mesh Mesh, Line, or Points instance.\n   */\n  GLTFParser.prototype.assignFinalMaterial = function (mesh) {\n    var geometry = mesh.geometry;\n    var material = mesh.material;\n\n    var useVertexTangents = geometry.attributes.tangent !== undefined;\n    var useVertexColors = geometry.attributes.color !== undefined;\n    var useFlatShading = geometry.attributes.normal === undefined;\n    var useSkinning = mesh.isSkinnedMesh === true;\n    var useMorphTargets = Object.keys(geometry.morphAttributes).length > 0;\n    var useMorphNormals = useMorphTargets && geometry.morphAttributes.normal !== undefined;\n\n    if (mesh.isPoints) {\n      var cacheKey = 'PointsMaterial:' + material.uuid;\n\n      var pointsMaterial = this.cache.get(cacheKey);\n\n      if (!pointsMaterial) {\n        pointsMaterial = new PointsMaterial();\n        Material.prototype.copy.call(pointsMaterial, material);\n        pointsMaterial.color.copy(material.color);\n        pointsMaterial.map = material.map;\n        pointsMaterial.sizeAttenuation = false; // glTF spec says points should be 1px\n\n        this.cache.add(cacheKey, pointsMaterial);\n      }\n\n      material = pointsMaterial;\n    } else if (mesh.isLine) {\n      var cacheKey = 'LineBasicMaterial:' + material.uuid;\n\n      var lineMaterial = this.cache.get(cacheKey);\n\n      if (!lineMaterial) {\n        lineMaterial = new LineBasicMaterial();\n        Material.prototype.copy.call(lineMaterial, material);\n        lineMaterial.color.copy(material.color);\n\n        this.cache.add(cacheKey, lineMaterial);\n      }\n\n      material = lineMaterial;\n    }\n\n    // Clone the material if it will be modified\n    if (useVertexTangents || useVertexColors || useFlatShading || useSkinning || useMorphTargets) {\n      var cacheKey = 'ClonedMaterial:' + material.uuid + ':';\n\n      if (material.isGLTFSpecularGlossinessMaterial) cacheKey += 'specular-glossiness:';\n      if (useSkinning) cacheKey += 'skinning:';\n      if (useVertexTangents) cacheKey += 'vertex-tangents:';\n      if (useVertexColors) cacheKey += 'vertex-colors:';\n      if (useFlatShading) cacheKey += 'flat-shading:';\n      if (useMorphTargets) cacheKey += 'morph-targets:';\n      if (useMorphNormals) cacheKey += 'morph-normals:';\n\n      var cachedMaterial = this.cache.get(cacheKey);\n\n      if (!cachedMaterial) {\n        cachedMaterial = material.clone();\n\n        if (useSkinning) cachedMaterial.skinning = true;\n        if (useVertexTangents) cachedMaterial.vertexTangents = true;\n        if (useVertexColors) cachedMaterial.vertexColors = true;\n        if (useFlatShading) cachedMaterial.flatShading = true;\n        if (useMorphTargets) cachedMaterial.morphTargets = true;\n        if (useMorphNormals) cachedMaterial.morphNormals = true;\n\n        this.cache.add(cacheKey, cachedMaterial);\n      }\n\n      material = cachedMaterial;\n    }\n\n    // workarounds for mesh and geometry\n\n    if (\n      material.aoMap &&\n      geometry.attributes.uv2 === undefined &&\n      geometry.attributes.uv !== undefined\n    ) {\n      geometry.setAttribute('uv2', geometry.attributes.uv);\n    }\n\n    // https://github.com/mrdoob/three.js/issues/11438#issuecomment-507003995\n    if (material.normalScale && !useVertexTangents) {\n      material.normalScale.y = -material.normalScale.y;\n    }\n\n    if (material.clearcoatNormalScale && !useVertexTangents) {\n      material.clearcoatNormalScale.y = -material.clearcoatNormalScale.y;\n    }\n\n    mesh.material = material;\n  };\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#materials\n   * @param {number} materialIndex\n   * @return {Promise<Material>}\n   */\n  GLTFParser.prototype.loadMaterial = function (materialIndex) {\n    var parser = this;\n    var json = this.json;\n    var extensions = this.extensions;\n    var materialDef = json.materials[materialIndex];\n\n    var materialType;\n    var materialParams = {};\n    var materialExtensions = materialDef.extensions || {};\n\n    var pending = [];\n\n    if (materialExtensions[EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]) {\n      var sgExtension = extensions[EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];\n      materialType = sgExtension.getMaterialType();\n      pending.push(sgExtension.extendParams(materialParams, materialDef, parser));\n    } else if (materialExtensions[EXTENSIONS.KHR_MATERIALS_UNLIT]) {\n      var kmuExtension = extensions[EXTENSIONS.KHR_MATERIALS_UNLIT];\n      materialType = kmuExtension.getMaterialType();\n      pending.push(kmuExtension.extendParams(materialParams, materialDef, parser));\n    } else {\n      // Specification:\n      // https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#metallic-roughness-material\n\n      materialType = MeshStandardMaterial;\n\n      var metallicRoughness = materialDef.pbrMetallicRoughness || {};\n\n      materialParams.color = new Color(1.0, 1.0, 1.0);\n      materialParams.opacity = 1.0;\n\n      if (Array.isArray(metallicRoughness.baseColorFactor)) {\n        var array = metallicRoughness.baseColorFactor;\n\n        materialParams.color.fromArray(array);\n        materialParams.opacity = array[3];\n      }\n\n      if (metallicRoughness.baseColorTexture !== undefined) {\n        pending.push(\n          parser.assignTexture(materialParams, 'map', metallicRoughness.baseColorTexture)\n        );\n      }\n\n      materialParams.metalness =\n        metallicRoughness.metallicFactor !== undefined ? metallicRoughness.metallicFactor : 1.0;\n      materialParams.roughness =\n        metallicRoughness.roughnessFactor !== undefined ? metallicRoughness.roughnessFactor : 1.0;\n\n      if (metallicRoughness.metallicRoughnessTexture !== undefined) {\n        pending.push(\n          parser.assignTexture(\n            materialParams,\n            'metalnessMap',\n            metallicRoughness.metallicRoughnessTexture\n          )\n        );\n        pending.push(\n          parser.assignTexture(\n            materialParams,\n            'roughnessMap',\n            metallicRoughness.metallicRoughnessTexture\n          )\n        );\n      }\n    }\n\n    if (materialDef.doubleSided === true) {\n      materialParams.side = DoubleSide;\n    }\n\n    var alphaMode = materialDef.alphaMode || ALPHA_MODES.OPAQUE;\n\n    if (alphaMode === ALPHA_MODES.BLEND) {\n      materialParams.transparent = true;\n\n      // See: https://github.com/mrdoob/three.js/issues/17706\n      materialParams.depthWrite = false;\n    } else {\n      materialParams.transparent = false;\n\n      if (alphaMode === ALPHA_MODES.MASK) {\n        materialParams.alphaTest =\n          materialDef.alphaCutoff !== undefined ? materialDef.alphaCutoff : 0.5;\n      }\n    }\n\n    if (materialDef.normalTexture !== undefined && materialType !== MeshBasicMaterial) {\n      pending.push(parser.assignTexture(materialParams, 'normalMap', materialDef.normalTexture));\n\n      materialParams.normalScale = new Vector2(1, 1);\n\n      if (materialDef.normalTexture.scale !== undefined) {\n        materialParams.normalScale.set(\n          materialDef.normalTexture.scale,\n          materialDef.normalTexture.scale\n        );\n      }\n    }\n\n    if (materialDef.occlusionTexture !== undefined && materialType !== MeshBasicMaterial) {\n      pending.push(parser.assignTexture(materialParams, 'aoMap', materialDef.occlusionTexture));\n\n      if (materialDef.occlusionTexture.strength !== undefined) {\n        materialParams.aoMapIntensity = materialDef.occlusionTexture.strength;\n      }\n    }\n\n    if (materialDef.emissiveFactor !== undefined && materialType !== MeshBasicMaterial) {\n      materialParams.emissive = new Color().fromArray(materialDef.emissiveFactor);\n    }\n\n    if (materialDef.emissiveTexture !== undefined && materialType !== MeshBasicMaterial) {\n      pending.push(\n        parser.assignTexture(materialParams, 'emissiveMap', materialDef.emissiveTexture)\n      );\n    }\n\n    if (materialExtensions[EXTENSIONS.KHR_MATERIALS_CLEARCOAT]) {\n      var clearcoatExtension = extensions[EXTENSIONS.KHR_MATERIALS_CLEARCOAT];\n      materialType = clearcoatExtension.getMaterialType();\n      pending.push(\n        clearcoatExtension.extendParams(materialParams, { extensions: materialExtensions }, parser)\n      );\n    }\n\n    return Promise.all(pending).then(function () {\n      var material;\n\n      if (materialType === GLTFMeshStandardSGMaterial) {\n        material = extensions[EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(\n          materialParams\n        );\n      } else {\n        material = new materialType(materialParams);\n      }\n\n      if (materialDef.name) material.name = materialDef.name;\n\n      // baseColorTexture, emissiveTexture, and specularGlossinessTexture use sRGB encoding.\n      if (material.map) material.map.encoding = sRGBEncoding;\n      if (material.emissiveMap) material.emissiveMap.encoding = sRGBEncoding;\n\n      assignExtrasToUserData(material, materialDef);\n\n      if (materialDef.extensions) addUnknownExtensionsToUserData(extensions, material, materialDef);\n\n      return material;\n    });\n  };\n\n  /**\n   * @param {BufferGeometry} geometry\n   * @param {GLTF.Primitive} primitiveDef\n   * @param {GLTFParser} parser\n   */\n  function computeBounds(geometry, primitiveDef, parser) {\n    var attributes = primitiveDef.attributes;\n\n    var box = new Box3();\n\n    if (attributes.POSITION !== undefined) {\n      var accessor = parser.json.accessors[attributes.POSITION];\n\n      var min = accessor.min;\n      var max = accessor.max;\n\n      // glTF requires 'min' and 'max', but VRM (which extends glTF) currently ignores that requirement.\n\n      if (min !== undefined && max !== undefined) {\n        box.set(new Vector3(min[0], min[1], min[2]), new Vector3(max[0], max[1], max[2]));\n      } else {\n        console.warn('THREE.GLTFLoader: Missing min/max properties for accessor POSITION.');\n\n        return;\n      }\n    } else {\n      return;\n    }\n\n    var targets = primitiveDef.targets;\n\n    if (targets !== undefined) {\n      var maxDisplacement = new Vector3();\n      var vector = new Vector3();\n\n      for (var i = 0, il = targets.length; i < il; i++) {\n        var target = targets[i];\n\n        if (target.POSITION !== undefined) {\n          var accessor = parser.json.accessors[target.POSITION];\n          var min = accessor.min;\n          var max = accessor.max;\n\n          // glTF requires 'min' and 'max', but VRM (which extends glTF) currently ignores that requirement.\n\n          if (min !== undefined && max !== undefined) {\n            // we need to get max of absolute components because target weight is [-1,1]\n            vector.setX(Math.max(Math.abs(min[0]), Math.abs(max[0])));\n            vector.setY(Math.max(Math.abs(min[1]), Math.abs(max[1])));\n            vector.setZ(Math.max(Math.abs(min[2]), Math.abs(max[2])));\n\n            // Note: this assumes that the sum of all weights is at most 1. This isn't quite correct - it's more conservative\n            // to assume that each target can have a max weight of 1. However, for some use cases - notably, when morph targets\n            // are used to implement key-frame animations and as such only two are active at a time - this results in very large\n            // boxes. So for now we make a box that's sometimes a touch too small but is hopefully mostly of reasonable size.\n            maxDisplacement.max(vector);\n          } else {\n            console.warn('THREE.GLTFLoader: Missing min/max properties for accessor POSITION.');\n          }\n        }\n      }\n\n      // As per comment above this box isn't conservative, but has a reasonable size for a very large number of morph targets.\n      box.expandByVector(maxDisplacement);\n    }\n\n    geometry.boundingBox = box;\n\n    var sphere = new Sphere();\n\n    box.getCenter(sphere.center);\n    sphere.radius = box.min.distanceTo(box.max) / 2;\n\n    geometry.boundingSphere = sphere;\n  }\n\n  /**\n   * @param {BufferGeometry} geometry\n   * @param {GLTF.Primitive} primitiveDef\n   * @param {GLTFParser} parser\n   * @return {Promise<BufferGeometry>}\n   */\n  function addPrimitiveAttributes(geometry, primitiveDef, parser) {\n    var attributes = primitiveDef.attributes;\n\n    var pending = [];\n\n    function assignAttributeAccessor(accessorIndex, attributeName) {\n      return parser.getDependency('accessor', accessorIndex).then(function (accessor) {\n        geometry.setAttribute(attributeName, accessor);\n      });\n    }\n\n    for (var gltfAttributeName in attributes) {\n      var threeAttributeName = ATTRIBUTES[gltfAttributeName] || gltfAttributeName.toLowerCase();\n\n      // Skip attributes already provided by e.g. Draco extension.\n      if (threeAttributeName in geometry.attributes) continue;\n\n      pending.push(assignAttributeAccessor(attributes[gltfAttributeName], threeAttributeName));\n    }\n\n    if (primitiveDef.indices !== undefined && !geometry.index) {\n      var accessor = parser\n        .getDependency('accessor', primitiveDef.indices)\n        .then(function (accessor) {\n          geometry.setIndex(accessor);\n        });\n\n      pending.push(accessor);\n    }\n\n    assignExtrasToUserData(geometry, primitiveDef);\n\n    computeBounds(geometry, primitiveDef, parser);\n\n    return Promise.all(pending).then(function () {\n      return primitiveDef.targets !== undefined\n        ? addMorphTargets(geometry, primitiveDef.targets, parser)\n        : geometry;\n    });\n  }\n\n  /**\n   * @param {BufferGeometry} geometry\n   * @param {Number} drawMode\n   * @return {BufferGeometry}\n   */\n  function toTrianglesDrawMode(geometry, drawMode) {\n    var index = geometry.getIndex();\n\n    // generate index if not present\n\n    if (index === null) {\n      var indices = [];\n\n      var position = geometry.getAttribute('position');\n\n      if (position !== undefined) {\n        for (var i = 0; i < position.count; i++) {\n          indices.push(i);\n        }\n\n        geometry.setIndex(indices);\n        index = geometry.getIndex();\n      } else {\n        console.error(\n          'THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible.'\n        );\n        return geometry;\n      }\n    }\n\n    //\n\n    var numberOfTriangles = index.count - 2;\n    var newIndices = [];\n\n    if (drawMode === TriangleFanDrawMode) {\n      // gl.TRIANGLE_FAN\n\n      for (var i = 1; i <= numberOfTriangles; i++) {\n        newIndices.push(index.getX(0));\n        newIndices.push(index.getX(i));\n        newIndices.push(index.getX(i + 1));\n      }\n    } else {\n      // gl.TRIANGLE_STRIP\n\n      for (var i = 0; i < numberOfTriangles; i++) {\n        if (i % 2 === 0) {\n          newIndices.push(index.getX(i));\n          newIndices.push(index.getX(i + 1));\n          newIndices.push(index.getX(i + 2));\n        } else {\n          newIndices.push(index.getX(i + 2));\n          newIndices.push(index.getX(i + 1));\n          newIndices.push(index.getX(i));\n        }\n      }\n    }\n\n    if (newIndices.length / 3 !== numberOfTriangles) {\n      console.error(\n        'THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.'\n      );\n    }\n\n    // build final geometry\n\n    var newGeometry = geometry.clone();\n    newGeometry.setIndex(newIndices);\n\n    return newGeometry;\n  }\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#geometry\n   *\n   * Creates BufferGeometries from primitives.\n   *\n   * @param {Array<GLTF.Primitive>} primitives\n   * @return {Promise<Array<BufferGeometry>>}\n   */\n  GLTFParser.prototype.loadGeometries = function (primitives) {\n    var parser = this;\n    var extensions = this.extensions;\n    var cache = this.primitiveCache;\n\n    function createDracoPrimitive(primitive) {\n      return extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION]\n        .decodePrimitive(primitive, parser)\n        .then(function (geometry) {\n          return addPrimitiveAttributes(geometry, primitive, parser);\n        });\n    }\n\n    var pending = [];\n\n    for (var i = 0, il = primitives.length; i < il; i++) {\n      var primitive = primitives[i];\n      var cacheKey = createPrimitiveKey(primitive);\n\n      // See if we've already created this geometry\n      var cached = cache[cacheKey];\n\n      if (cached) {\n        // Use the cached geometry if it exists\n        pending.push(cached.promise);\n      } else {\n        var geometryPromise;\n\n        if (primitive.extensions && primitive.extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION]) {\n          // Use DRACO geometry if available\n          geometryPromise = createDracoPrimitive(primitive);\n        } else {\n          // Otherwise create a new geometry\n          geometryPromise = addPrimitiveAttributes(new BufferGeometry(), primitive, parser);\n        }\n\n        // Cache this geometry\n        cache[cacheKey] = { primitive: primitive, promise: geometryPromise };\n\n        pending.push(geometryPromise);\n      }\n    }\n\n    return Promise.all(pending);\n  };\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#meshes\n   * @param {number} meshIndex\n   * @return {Promise<Group|Mesh|SkinnedMesh>}\n   */\n  GLTFParser.prototype.loadMesh = function (meshIndex) {\n    var parser = this;\n    var json = this.json;\n\n    var meshDef = json.meshes[meshIndex];\n    var primitives = meshDef.primitives;\n\n    var pending = [];\n\n    for (var i = 0, il = primitives.length; i < il; i++) {\n      var material =\n            primitives[i].material === undefined\n              ? createDefaultMaterial(this.cache)\n              : this.getDependency('material', primitives[i].material);\n\n      pending.push(material);\n    }\n\n    pending.push(parser.loadGeometries(primitives));\n\n    return Promise.all(pending).then(function (results) {\n      var materials = results.slice(0, results.length - 1);\n      var geometries = results[results.length - 1];\n\n      var meshes = [];\n\n      for (var i = 0, il = geometries.length; i < il; i++) {\n        var geometry = geometries[i];\n        var primitive = primitives[i];\n\n        // 1. create Mesh\n\n        var mesh;\n\n        var material = materials[i];\n\n        if (\n          primitive.mode === WEBGL_CONSTANTS.TRIANGLES ||\n          primitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP ||\n          primitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN ||\n          primitive.mode === undefined\n        ) {\n          // .isSkinnedMesh isn't in glTF spec. See .markDefs()\n          mesh =\n            meshDef.isSkinnedMesh === true\n              ? new SkinnedMesh(geometry, material)\n              : new Mesh(geometry, material);\n\n          if (mesh.isSkinnedMesh === true && !mesh.geometry.attributes.skinWeight.normalized) {\n            // we normalize floating point skin weight array to fix malformed assets (see #15319)\n            // it's important to skip this for non-float32 data since normalizeSkinWeights assumes non-normalized inputs\n            mesh.normalizeSkinWeights();\n          }\n\n          if (primitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP) {\n            mesh.geometry = toTrianglesDrawMode(mesh.geometry, TriangleStripDrawMode);\n          } else if (primitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN) {\n            mesh.geometry = toTrianglesDrawMode(mesh.geometry, TriangleFanDrawMode);\n          }\n        } else if (primitive.mode === WEBGL_CONSTANTS.LINES) {\n          mesh = new LineSegments(geometry, material);\n        } else if (primitive.mode === WEBGL_CONSTANTS.LINE_STRIP) {\n          mesh = new Line(geometry, material);\n        } else if (primitive.mode === WEBGL_CONSTANTS.LINE_LOOP) {\n          mesh = new LineLoop(geometry, material);\n        } else if (primitive.mode === WEBGL_CONSTANTS.POINTS) {\n          mesh = new Points(geometry, material);\n        } else {\n          throw new Error('THREE.GLTFLoader: Primitive mode unsupported: ' + primitive.mode);\n        }\n\n        if (Object.keys(mesh.geometry.morphAttributes).length > 0) {\n          updateMorphTargets(mesh, meshDef);\n        }\n\n        mesh.name = meshDef.name || 'mesh_' + meshIndex;\n\n        if (geometries.length > 1) mesh.name += '_' + i;\n\n        assignExtrasToUserData(mesh, meshDef);\n\n        parser.assignFinalMaterial(mesh);\n\n        meshes.push(mesh);\n      }\n\n      if (meshes.length === 1) {\n        return meshes[0];\n      }\n\n      var group = new Group();\n\n      for (var i = 0, il = meshes.length; i < il; i++) {\n        group.add(meshes[i]);\n      }\n\n      return group;\n    });\n  };\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#cameras\n   * @param {number} cameraIndex\n   * @return {Promise<THREE.Camera>}\n   */\n  GLTFParser.prototype.loadCamera = function (cameraIndex) {\n    var camera;\n    var cameraDef = this.json.cameras[cameraIndex];\n    var params = cameraDef[cameraDef.type];\n\n    if (!params) {\n      console.warn('THREE.GLTFLoader: Missing camera parameters.');\n      return;\n    }\n\n    if (cameraDef.type === 'perspective') {\n      camera = new PerspectiveCamera(\n        MathUtils.radToDeg(params.yfov),\n        params.aspectRatio || 1,\n        params.znear || 1,\n        params.zfar || 2e6\n      );\n    } else if (cameraDef.type === 'orthographic') {\n      camera = new OrthographicCamera(\n        -params.xmag,\n        params.xmag,\n        params.ymag,\n        -params.ymag,\n        params.znear,\n        params.zfar\n      );\n    }\n\n    if (cameraDef.name) camera.name = cameraDef.name;\n\n    assignExtrasToUserData(camera, cameraDef);\n\n    return Promise.resolve(camera);\n  };\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#skins\n   * @param {number} skinIndex\n   * @return {Promise<Object>}\n   */\n  GLTFParser.prototype.loadSkin = function (skinIndex) {\n    var skinDef = this.json.skins[skinIndex];\n\n    var skinEntry = { joints: skinDef.joints };\n\n    if (skinDef.inverseBindMatrices === undefined) {\n      return Promise.resolve(skinEntry);\n    }\n\n    return this.getDependency('accessor', skinDef.inverseBindMatrices).then(function (accessor) {\n      skinEntry.inverseBindMatrices = accessor;\n\n      return skinEntry;\n    });\n  };\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#animations\n   * @param {number} animationIndex\n   * @return {Promise<AnimationClip>}\n   */\n  GLTFParser.prototype.loadAnimation = function (animationIndex) {\n    var json = this.json;\n\n    var animationDef = json.animations[animationIndex];\n\n    var pendingNodes = [];\n    var pendingInputAccessors = [];\n    var pendingOutputAccessors = [];\n    var pendingSamplers = [];\n    var pendingTargets = [];\n\n    for (var i = 0, il = animationDef.channels.length; i < il; i++) {\n      var channel = animationDef.channels[i];\n      var sampler = animationDef.samplers[channel.sampler];\n      var target = channel.target;\n      var name = target.node !== undefined ? target.node : target.id; // NOTE: target.id is deprecated.\n      var input =\n            animationDef.parameters !== undefined\n              ? animationDef.parameters[sampler.input]\n              : sampler.input;\n      var output =\n            animationDef.parameters !== undefined\n              ? animationDef.parameters[sampler.output]\n              : sampler.output;\n\n      pendingNodes.push(this.getDependency('node', name));\n      pendingInputAccessors.push(this.getDependency('accessor', input));\n      pendingOutputAccessors.push(this.getDependency('accessor', output));\n      pendingSamplers.push(sampler);\n      pendingTargets.push(target);\n    }\n\n    return Promise.all([\n      Promise.all(pendingNodes),\n      Promise.all(pendingInputAccessors),\n      Promise.all(pendingOutputAccessors),\n      Promise.all(pendingSamplers),\n      Promise.all(pendingTargets),\n    ]).then(function (dependencies) {\n      var nodes = dependencies[0];\n      var inputAccessors = dependencies[1];\n      var outputAccessors = dependencies[2];\n      var samplers = dependencies[3];\n      var targets = dependencies[4];\n\n      var tracks = [];\n\n      for (var i = 0, il = nodes.length; i < il; i++) {\n        var node = nodes[i];\n        var inputAccessor = inputAccessors[i];\n        var outputAccessor = outputAccessors[i];\n        var sampler = samplers[i];\n        var target = targets[i];\n\n        if (node === undefined) continue;\n\n        node.updateMatrix();\n        node.matrixAutoUpdate = true;\n\n        var TypedKeyframeTrack;\n\n        switch (PATH_PROPERTIES[target.path]) {\n          case PATH_PROPERTIES.weights:\n            TypedKeyframeTrack = NumberKeyframeTrack;\n            break;\n\n          case PATH_PROPERTIES.rotation:\n            TypedKeyframeTrack = QuaternionKeyframeTrack;\n            break;\n\n          case PATH_PROPERTIES.position:\n          case PATH_PROPERTIES.scale:\n          default:\n            TypedKeyframeTrack = VectorKeyframeTrack;\n            break;\n        }\n\n        var targetName = node.name ? node.name : node.uuid;\n\n        var interpolation =\n              sampler.interpolation !== undefined\n                ? INTERPOLATION[sampler.interpolation]\n                : InterpolateLinear;\n\n        var targetNames = [];\n\n        if (PATH_PROPERTIES[target.path] === PATH_PROPERTIES.weights) {\n          // Node may be a Group (glTF mesh with several primitives) or a Mesh.\n          node.traverse(function (object) {\n            if (object.isMesh === true && object.morphTargetInfluences) {\n              targetNames.push(object.name ? object.name : object.uuid);\n            }\n          });\n        } else {\n          targetNames.push(targetName);\n        }\n\n        var outputArray = outputAccessor.array;\n\n        if (outputAccessor.normalized) {\n          var scale;\n\n          if (outputArray.constructor === Int8Array) {\n            scale = 1 / 127;\n          } else if (outputArray.constructor === Uint8Array) {\n            scale = 1 / 255;\n          } else if (outputArray.constructor == Int16Array) {\n            scale = 1 / 32767;\n          } else if (outputArray.constructor === Uint16Array) {\n            scale = 1 / 65535;\n          } else {\n            throw new Error('THREE.GLTFLoader: Unsupported output accessor component type.');\n          }\n\n          var scaled = new Float32Array(outputArray.length);\n\n          for (var j = 0, jl = outputArray.length; j < jl; j++) {\n            scaled[j] = outputArray[j] * scale;\n          }\n\n          outputArray = scaled;\n        }\n\n        for (var j = 0, jl = targetNames.length; j < jl; j++) {\n          var track = new TypedKeyframeTrack(\n            targetNames[j] + '.' + PATH_PROPERTIES[target.path],\n            inputAccessor.array,\n            outputArray,\n            interpolation\n          );\n\n          // Override interpolation with custom factory method.\n          if (sampler.interpolation === 'CUBICSPLINE') {\n            track.createInterpolant = function InterpolantFactoryMethodGLTFCubicSpline(result) {\n              // A CUBICSPLINE keyframe in glTF has three output values for each input value,\n              // representing inTangent, splineVertex, and outTangent. As a result, track.getValueSize()\n              // must be divided by three to get the interpolant's sampleSize argument.\n\n              return new GLTFCubicSplineInterpolant(\n                this.times,\n                this.values,\n                this.getValueSize() / 3,\n                result\n              );\n            };\n\n            // Mark as CUBICSPLINE. `track.getInterpolation()` doesn't support custom interpolants.\n            track.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline = true;\n          }\n\n          tracks.push(track);\n        }\n      }\n\n      var name = animationDef.name ? animationDef.name : 'animation_' + animationIndex;\n\n      return new AnimationClip(name, undefined, tracks);\n    });\n  };\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#nodes-and-hierarchy\n   * @param {number} nodeIndex\n   * @return {Promise<Object3D>}\n   */\n  GLTFParser.prototype.loadNode = function (nodeIndex) {\n    var json = this.json;\n    var extensions = this.extensions;\n    var parser = this;\n\n    var meshReferences = json.meshReferences;\n    var meshUses = json.meshUses;\n\n    var nodeDef = json.nodes[nodeIndex];\n\n    return (function () {\n      var pending = [];\n\n      if (nodeDef.mesh !== undefined) {\n        pending.push(\n          parser.getDependency('mesh', nodeDef.mesh).then(function (mesh) {\n            var node;\n\n            if (meshReferences[nodeDef.mesh] > 1) {\n              var instanceNum = meshUses[nodeDef.mesh]++;\n\n              node = mesh.clone();\n              node.name += '_instance_' + instanceNum;\n            } else {\n              node = mesh;\n            }\n\n            // if weights are provided on the node, override weights on the mesh.\n            if (nodeDef.weights !== undefined) {\n              node.traverse(function (o) {\n                if (!o.isMesh) return;\n\n                for (var i = 0, il = nodeDef.weights.length; i < il; i++) {\n                  o.morphTargetInfluences[i] = nodeDef.weights[i];\n                }\n              });\n            }\n\n            return node;\n          })\n        );\n      }\n\n      if (nodeDef.camera !== undefined) {\n        pending.push(parser.getDependency('camera', nodeDef.camera));\n      }\n\n      if (\n        nodeDef.extensions &&\n        nodeDef.extensions[EXTENSIONS.KHR_LIGHTS_PUNCTUAL] &&\n        nodeDef.extensions[EXTENSIONS.KHR_LIGHTS_PUNCTUAL].light !== undefined\n      ) {\n        pending.push(\n          parser.getDependency('light', nodeDef.extensions[EXTENSIONS.KHR_LIGHTS_PUNCTUAL].light)\n        );\n      }\n\n      return Promise.all(pending);\n    })().then(function (objects) {\n      var node;\n\n      // .isBone isn't in glTF spec. See .markDefs\n      if (nodeDef.isBone === true) {\n        node = new Bone();\n      } else if (objects.length > 1) {\n        node = new Group();\n      } else if (objects.length === 1) {\n        node = objects[0];\n      } else {\n        node = new Object3D();\n      }\n\n      if (node !== objects[0]) {\n        for (var i = 0, il = objects.length; i < il; i++) {\n          node.add(objects[i]);\n        }\n      }\n\n      if (nodeDef.name) {\n        node.userData.name = nodeDef.name;\n        node.name = PropertyBinding.sanitizeNodeName(nodeDef.name);\n      }\n\n      assignExtrasToUserData(node, nodeDef);\n\n      if (nodeDef.extensions) addUnknownExtensionsToUserData(extensions, node, nodeDef);\n\n      if (nodeDef.matrix !== undefined) {\n        var matrix = new Matrix4();\n        matrix.fromArray(nodeDef.matrix);\n        node.applyMatrix4(matrix);\n      } else {\n        if (nodeDef.translation !== undefined) {\n          node.position.fromArray(nodeDef.translation);\n        }\n\n        if (nodeDef.rotation !== undefined) {\n          node.quaternion.fromArray(nodeDef.rotation);\n        }\n\n        if (nodeDef.scale !== undefined) {\n          node.scale.fromArray(nodeDef.scale);\n        }\n      }\n\n      return node;\n    });\n  };\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#scenes\n   * @param {number} sceneIndex\n   * @return {Promise<Group>}\n   */\n  GLTFParser.prototype.loadScene = (function () {\n    // scene node hierachy builder\n\n    function buildNodeHierachy(nodeId, parentObject, json, parser) {\n      var nodeDef = json.nodes[nodeId];\n\n      return parser\n        .getDependency('node', nodeId)\n        .then(function (node) {\n          if (nodeDef.skin === undefined) return node;\n\n          // build skeleton here as well\n\n          var skinEntry;\n\n          return parser\n            .getDependency('skin', nodeDef.skin)\n            .then(function (skin) {\n              skinEntry = skin;\n\n              var pendingJoints = [];\n\n              for (var i = 0, il = skinEntry.joints.length; i < il; i++) {\n                pendingJoints.push(parser.getDependency('node', skinEntry.joints[i]));\n              }\n\n              return Promise.all(pendingJoints);\n            })\n            .then(function (jointNodes) {\n              node.traverse(function (mesh) {\n                if (!mesh.isMesh) return;\n\n                var bones = [];\n                var boneInverses = [];\n\n                for (var j = 0, jl = jointNodes.length; j < jl; j++) {\n                  var jointNode = jointNodes[j];\n\n                  if (jointNode) {\n                    bones.push(jointNode);\n\n                    var mat = new Matrix4();\n\n                    if (skinEntry.inverseBindMatrices !== undefined) {\n                      mat.fromArray(skinEntry.inverseBindMatrices.array, j * 16);\n                    }\n\n                    boneInverses.push(mat);\n                  } else {\n                    console.warn(\n                      'THREE.GLTFLoader: Joint \"%s\" could not be found.',\n                      skinEntry.joints[j]\n                    );\n                  }\n                }\n\n                mesh.bind(new Skeleton(bones, boneInverses), mesh.matrixWorld);\n              });\n\n              return node;\n            });\n        })\n        .then(function (node) {\n          // build node hierachy\n\n          parentObject.add(node);\n\n          var pending = [];\n\n          if (nodeDef.children) {\n            var children = nodeDef.children;\n\n            for (var i = 0, il = children.length; i < il; i++) {\n              var child = children[i];\n              pending.push(buildNodeHierachy(child, node, json, parser));\n            }\n          }\n\n          return Promise.all(pending);\n        });\n    }\n\n    return function loadScene(sceneIndex) {\n      var json = this.json;\n      var extensions = this.extensions;\n      var sceneDef = this.json.scenes[sceneIndex];\n      var parser = this;\n\n      // Loader returns Group, not Scene.\n      // See: https://github.com/mrdoob/three.js/issues/18342#issuecomment-578981172\n      var scene = new Group();\n      if (sceneDef.name) scene.name = sceneDef.name;\n\n      assignExtrasToUserData(scene, sceneDef);\n\n      if (sceneDef.extensions) addUnknownExtensionsToUserData(extensions, scene, sceneDef);\n\n      var nodeIds = sceneDef.nodes || [];\n\n      var pending = [];\n\n      for (var i = 0, il = nodeIds.length; i < il; i++) {\n        pending.push(buildNodeHierachy(nodeIds[i], scene, json, parser));\n      }\n\n      return Promise.all(pending).then(function () {\n        return scene;\n      });\n    };\n  })();\n\n  return GLTFLoader;\n})();\n\nexport { GLTFLoader };\n","import * as THREE from 'three';\n\n// USe this class as a helper to set up some default materials\nexport default class Material {\n  constructor(color) {\n    this.basic = new THREE.MeshBasicMaterial({\n      color,\n      side: THREE.DoubleSide\n    });\n\n    this.standard = new THREE.MeshStandardMaterial({\n      color,\n      flatShading: true,\n      roughness: 1,\n      metalness: 0,\n      side: THREE.DoubleSide\n    });\n\n    this.wire = new THREE.MeshBasicMaterial({color, wireframe: true});\n  }\n}\n\n","// Global imports -\nimport * as THREE from 'three';\nimport Material from '../components/material';\n\nexport default class RectLight {\n  constructor(main, config) {\n    this.init(main, config);\n  }\n  \n  init(main, config) {\n\n    this.scene = main;\n    this.object = new THREE.Object3D();\n    this.lightBox = new THREE.Object3D();\n\n    var width = config.width;\n    var height = config.height;\n    var intensity = config.intensity;\n    var rectLight = new THREE.RectAreaLight(0xfff4d4, intensity, width, height);\n\n    this.lightBox.add(rectLight);\n\n    var rectLightMesh = new THREE.Mesh(new THREE.PlaneBufferGeometry(), new THREE.MeshBasicMaterial({ side: THREE.BackSide, color: 0xfffaed }));\n    rectLightMesh.scale.x = rectLight.width;\n    rectLightMesh.scale.y = rectLight.height;\n    rectLight.add(rectLightMesh);\n\n    var rectLightMeshBack = new THREE.Mesh(new THREE.PlaneBufferGeometry(), new THREE.MeshBasicMaterial({ color: 0xfffaed, side: THREE.FrontSide }));\n    rectLightMesh.add(rectLightMeshBack);\n\n    var rectBox = new THREE.Mesh(\n      new THREE.BoxGeometry(rectLight.width, rectLight.height, (rectLight.height+rectLight.width)*.05),\n      new Material(\"#DCDFE3\").standard\n    )\n        \n    rectBox.position.z = (rectLight.height+rectLight.width)*.05 * .5 + 0.1;\n\n    this.lightBox.add(rectBox);\n    this.object.add(this.lightBox);\n\n    this.scene.add(this.object);\n        \n    //vars.loopFunctions.push([this.animate, \"ANIMATE_EARTH\"]);\n  }\n\n  place(position, rotation) {\n    this.object.position.set(...position);\n    this.object.rotation.set(...rotation);\n  }\n\n  animate(){\n    // animate\n  }\n\n}\n","// Global imports -\nimport * as THREE from 'three';\nimport { GLTFLoader } from '../loaders/GLTFLoader';\nimport { OBJLoader } from 'three/examples/jsm/loaders/OBJLoader';\nimport SimplexNoise from 'simplex-noise';\n\nimport Material from '../components/material';\nimport RectLight from './rectLight';\n\nimport fx from '../fx';\nimport vars from '../vars';\nimport { BufferGeometryUtils } from '../../utils/bufferGeometryUtils';\n\nlet lights;\n\nlet variants = {\n    platform:[\n        {t:25, b:30, h:8, s:64},\n        {t:25, b:30, h:8, s:5},\n        {t:30, b:20, h:8, s:4},\n        {t:30, b:20, h:8, s:8},\n        {t:25, b:30, h:8, s:4},\n    ],\n    light:[\n        {w:5, h:15, c:3},\n        {w:1, h:15, c:6},\n        {w:6, h:12, c:2},\n        {w:8, h:10, c:4},\n        {w:5, h:10, c:3},\n    ]\n}\n\nlet flies = new THREE.Object3D();\n\nlet platformConfig, lightConfig;\nconst simplex = new SimplexNoise();\nvar mixer;\n\nconst modelHolderObject = new THREE.Object3D();\nconst object = new THREE.Object3D();\n\nexport default class Platform {\n    constructor(main) {\n\n        this.lights;\n    }\n  \n    init() {\n\n        const _this = this;\n\n        this.scene = vars.main.scene2;\n        lights = new THREE.Object3D();\n\n        modelHolderObject.position.y = -10;\n        object.add(modelHolderObject);\n\n        platformConfig = variants.platform[Math.floor(variants.platform.length * Math.random())];\n        lightConfig = variants.light[Math.floor(variants.light.length * Math.random())];\n\n        var geometry = new THREE.CylinderGeometry(platformConfig.t, platformConfig.b, platformConfig.h, platformConfig.s);\n        var plane = new THREE.Mesh(\n            geometry,\n            new Material(\"#5AA9DD\").standard\n        );\n        //object.add(plane);\n        //this.scene.add(this.object);\n        //this.scene.add(lights);\n\n        var landGeometry = new THREE.PlaneGeometry(1600, 1600, 20, 32, 32);\n            landGeometry.setAttribute(\"basePosition\", new THREE.BufferAttribute().copy(landGeometry.attributes.position));\n        var landMaterial = new Material('#076CAE').standard;\n        this.land = new THREE.Mesh(landGeometry, landMaterial);\n        this.land.rotation.set(90 * THREE.Math.DEG2RAD, 0, 0);\n        this.land.position.y = -10;\n\n        const basePositionAttribute = this.land.geometry.getAttribute(\"basePosition\");\n        const positionAttribute = this.land.geometry.getAttribute( 'position' );\n        const vertex = new THREE.Vector3();\n\n        for ( let vertexIndex = 0; vertexIndex < positionAttribute.count; vertexIndex++ ) {\n\n            vertex.fromBufferAttribute( basePositionAttribute, vertexIndex );\n\n            //console.log('before', vertex.x);\n\n            var perlin = simplex.noise3D(\n                vertex.x * 0.06 + 1 * 0.002,\n                vertex.y * 0.06 + 1 * 0.003,\n                vertex.z * 0.06 + 1 * 0.005\n            );\n\n            //var ratio = perlin * 0.4 * ( mouse.y + 0.1 ) + 0.8;\n            var ratio = perlin * 0.4 * 0.1 + 0.8;\n            //var ratio = perlin;\n            vertex.multiplyScalar( ratio );\n\n            //console.log('after', vertex.x, ratio);\n\n            positionAttribute.setXYZ(vertexIndex, vertex.x, vertex.y, vertex.z);\n\n        }\n\n        this.land.geometry.attributes.position.needsUpdate = true; // required after the first render\n        this.land.geometry.computeBoundingSphere();\n\n        object.add(this.land);\n\n        this.addGrass();\n        //this.addLights(lights);\n        this.addFireflies();\n        this.addModel();\n        //this.addObject(main);\n\n        object.position.set(-10, -5, 0);\n\n        this.scene.add(object);\n\n        vars.platformIsInitialized = true;\n    }\n\n    dispose(){\n        fx.removeFromLoop(\"ANIMATE_MODEL\");\n        fx.removeFromLoop(\"ANIMATE_FLIES\");\n        \n        this.removeModel();\n\n        for (var j = flies.children.length - 1; j >= 0; j--) {\n            flies.remove(flies.children[j]);\n        }\n\n        vars.platformIsInitialized = false;\n    }\n\n    removeModel(){\n        fx.removeFromLoop(\"ANIMATE_MODEL\");\n        fx.removeFromLoop(\"ANIMATE_FLIES\");\n\n        var parent = modelHolderObject;\n        \n        for (var i = parent.children.length - 1; i >= 0; i--) {\n            parent.remove(parent.children[i]);\n        }\n    }\n\n    addModel(){\n\n        let milestone = vars.currentMilestone;\n\n        const _this = this;\n        \n        const loader = new GLTFLoader().setPath( './assets/models/' );\n\n        //const marble = new THREE.TextureLoader().load( '/assets/textures/marble.jpg' );\n        \n        loader.load(\n            milestone.model,\n            function ( gltf ) {\n\n                var model = gltf.scene;\n                model.traverse((o) => {\n                    if (o.isMesh) o.material = new THREE.MeshPhysicalMaterial({\n                        color:0xFFFFFF,\n                        //map:marble,\n                        roughness:.98,\n                        metalness: .5,\n                    });\n                  });\n\n                gltf.scene.scale.set(1.3, 1.3, 1.3);\n                gltf.scene.position.set(0, 0, 0);\n\n\t\t\t\tmodelHolderObject.add( gltf.scene );\n\n                mixer = new THREE.AnimationMixer( gltf.scene );\n        \n                gltf.animations.forEach( ( clip ) => {\n                    mixer.clipAction( clip ).play();\n                });\n\n                vars.loopFunctions.push([_this.animateModel, \"ANIMATE_MODEL\", 1]);\n                vars.loopFunctions.push([_this.animateFlies, \"ANIMATE_FLIES\", 1]);\n\t\t\t\t\t\t\n            });\n    }\n\n    animateModel(time, delta){\n        if ( mixer ) mixer.update( delta );\n    }\n\n    addFireflies(scene){\n\n        const sphere = new THREE.SphereGeometry( 0.1, 3, 3 );\n\n        //lights\n        let light1 = new THREE.PointLight( 0x9145B6, 2, 30 );\n        light1.add( new THREE.Mesh( sphere, new THREE.MeshBasicMaterial( { color: 0x9145B6 } ) ) );\n        flies.add( light1 );\n\n        let light2 = new THREE.PointLight( 0x0040ff, 2, 30 );\n        light2.add( new THREE.Mesh( sphere, new THREE.MeshBasicMaterial( { color: 0x0040ff } ) ) );\n        flies.add( light2 );\n\n        let light3 = new THREE.PointLight( 0x80ff80, 2, 30 );\n        light3.add( new THREE.Mesh( sphere, new THREE.MeshBasicMaterial( { color: 0x80ff80 } ) ) );\n        flies.add( light3 );\n\n        let light4 = new THREE.PointLight( 0xffaa00, 2, 30 );\n        light4.add( new THREE.Mesh( sphere, new THREE.MeshBasicMaterial( { color: 0xffaa00 } ) ) );\n        flies.add( light4 );\n\n        flies.position.y = 15;\n\n        object.add( flies );\n\n        this.animateFlies(1);\n        //vars.loopFunctions.push([this.animateFlies, \"ANIMATE_FLIES\", 1]);\n    }\n\n    animateFlies(time){\n        \n        time = time * 0.0005;\n        \n        let light1 = flies.children[0];\n        let light2 = flies.children[1];\n        let light3 = flies.children[2];\n        let light4 = flies.children[3];\n\n        let radius = 20;\n\n        light1.position.x = Math.sin( time * 0.7 ) * radius;\n        light1.position.y = Math.cos( time * 0.5 ) * radius;\n        light1.position.z = Math.cos( time * 0.3 ) * radius;\n\n        light2.position.x = Math.cos( time * 0.3 ) * radius;\n        light2.position.y = Math.sin( time * 0.5 ) * radius;\n        light2.position.z = Math.sin( time * 0.7 ) * radius;\n\n        light3.position.x = Math.sin( time * 0.7 ) * radius;\n        light3.position.y = Math.cos( time * 0.3 ) * radius;\n        light3.position.z = Math.sin( time * 0.5 ) * radius;\n\n        light4.position.x = Math.sin( time * 0.3 ) * radius;\n        light4.position.y = Math.cos( time * 0.7 ) * radius;\n        light4.position.z = Math.sin( time * 0.5 ) * radius;\n    }\n\n    addGrass(scene){\n\n        const matrix = new THREE.Matrix4();\n\n        const radius = 30;\n        const gap = 5;\n\n        let mergedGeometry = new THREE.BufferGeometry();\n        let saplingGeometry = new THREE.CylinderBufferGeometry(.5,.5,6,3);\n        \n        \n        let grassMaterial = new THREE.ShaderMaterial({\n            uniforms: {\n                color2: {\n                  value: new THREE.Color(\"#193498\")\n                },\n                color1: {\n                  value: new THREE.Color(\"#B958A5\")\n                }\n              },\n              vertexShader: `\n                varying vec2 vUv;\n            \n                void main() {\n                  vUv = uv;\n                  gl_Position = projectionMatrix * modelViewMatrix * vec4(position,1.0);\n                }\n              `,\n              fragmentShader: `\n                uniform vec3 color1;\n                uniform vec3 color2;\n              \n                varying vec2 vUv;\n                \n                void main() {\n                  \n                  gl_FragColor = vec4(mix(color1, color2, vUv.y), 1.0);\n                }\n              `\n        });\n        \n        //let grassMaterial = new Material(\"#B958A5\").standard;\n\n        const geometries = [];\n\n        for(var i=0; i<Math.pow(radius, 2); i++){\n\n            let row = Math.floor( i / radius );\n\n            var perlin = simplex.noise2D( i - row * radius * 0.000000001, row * 0.000000001 );\n\n            var ratio = perlin * 2;\n\n            matrix.makeTranslation((i - row * radius) * gap, -ratio, row * gap);\n\n            /*\n            matrix.makeTranslation(\n                radius * Math.random() - radius * .5,\n                0,\n                radius * Math.random() - radius * .5,\n            )\n            */\n\n            if(fx.isPointInsideCircle(radius * gap * .5, radius * gap * .5, radius * gap * .5, (i - row * radius) * gap, row * gap)\n            && !fx.isPointInsideCircle(radius * gap * .5, radius * gap * .5, 35, (i - row * radius) * gap, row * gap)\n            )\n                geometries.push(saplingGeometry.clone().applyMatrix4(matrix));\n            \n        }\n\n        mergedGeometry = BufferGeometryUtils.mergeBufferGeometries(geometries);\n\n        let grass = new THREE.Mesh(mergedGeometry, grassMaterial);\n            grass.position.set(-radius * gap * .5, -12, -radius * gap * .5);\n\n        object.add(grass);\n\n    }\n\n    addLights(main){\n        let segment = 360/lightConfig.c;\n        let radius = platformConfig.t;\n\n        for(var i=0; i<lightConfig.c; ++i){\n\n            let alpha = segment * THREE.MathUtils.DEG2RAD * i;\n            let random = Math.random();\n\n            //console.log(segment, alpha, THREE.MathUtils.DEG2RAD, Math.PI / 180);\n\n            var light = new RectLight(main, {width:lightConfig.w, height:lightConfig.h, intensity:8});\n                light.place(\n                    [Math.cos(alpha) * radius, random * 0 + 15, Math.sin(alpha) * radius], \n                    [ 0, (-segment*i + 90) * THREE.MathUtils.DEG2RAD, 0]\n                );\n\n                light.lightBox.rotation.x = ( -15 - ( random * 0) ) * THREE.MathUtils.DEG2RAD;\n\n        }\n\n    }\n  }\n","import anime from \"animejs\";\n\nimport vars from \"./vars\";\nimport Events from \"./events\";\n\nvar events = new Events();\nvar curtain = null;\n\nexport default class Overlay {\n  constructor() {\n    this.container = document.getElementById('overlay');\n\n    this.initText(document);\n    this.initGlobe();\n  }\n\n  initText(ID){\n    var textWrappers = ID.querySelectorAll(\".off\");\n    for(var i=0; i<textWrappers.length; ++i){\n      const text = textWrappers[i];\n\n      text.setAttribute(\"data-count\", text.textContent.split(' ').length);\n\n      if(!text.classList.contains(\"made\")){\n        if(text.classList.contains(\"anim-letters\")){\n          text.innerHTML = \"<span class='word'>\" + text.textContent.replaceAll(\" \", \"</span> <span class='word'>\") + \"</span>\";\n          const words = text.querySelectorAll(\"span.word\");\n          for(var k=0; k<words.length; ++k){\n            words[k].innerHTML = words[k].textContent.replace(/\\S/g, \"<span class='letter'><span>$&</span></span>\");\n          }\n        }\n        else if(text.classList.contains(\"anim-words\")){\n          //text.innerHTML = \"<span class='letter'><span>\" + text.textContent.replaceAll(\" \", \"</span></span> <span class='letter'><span>\") + \"</span></span>\";\n          let arr = text.textContent.split(\" \");\n          arr = arr.map(n=>n.replaceAll('<$', '<i>').replaceAll('$>', '</i>'));\n          text.innerHTML = '<span class=\"letter\"><span>' + arr.join(\"</span></span> <span class='letter'><span>\") + \"</span></span>\";\n        }\n      }\n    }\n  }\n\n  initGlobe(){\n    const ul = document.querySelector(\"ul.milestones\");\n    for(var i=0; i<vars.milestones.length; ++i){\n      const li = document.createElement(\"li\");\n      const an = document.createElement(\"a\");\n      an.setAttribute(\"href\", \"javascript:void(0);\");\n      an.id = i;\n      an.addEventListener('click', (e)=>{ events.milestoneClickHandler(e); }, false);\n      an.addEventListener('mouseenter', (e)=>{ events.buttonHoverHandler(e); }, false);\n      an.innerHTML = '<svg width=\"100\" height=\"100\"><defs><linearGradient id=\"gradient\" x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\"><stop offset=\"0%\" stop-color=\"#B3DBF5\"></stop><stop offset=\"10%\" stop-color=\"#38B0FF\"></stop><stop offset=\"100%\" stop-color=\"transparent\"></stop></linearGradient></defs><circle cx=\"50\" cy=\"50\" r=\"49\" stroke=\"url(#gradient)\" stroke-width=\"1\" fill=\"none\"></circle></svg><span>'+vars.milestones[i].city+'<i>'+vars.milestones[i].year+'</i></span>';\n      li.appendChild(an);\n      ul.appendChild(li);\n    }\n  }\n\n  initStatue(){\n    const milestone = vars.currentMilestone;\n\n    const container = document.querySelector(\".statue\");\n    container.querySelector(\".where\").innerHTML = milestone.city;\n    container.querySelector(\".when\").innerHTML = milestone.year;\n    container.querySelector(\"h3\").innerHTML =  milestone.title;\n    container.querySelector(\"p\").innerHTML = milestone.description;\n    container.querySelector(\"audio\").setAttribute(\"data-time\", milestone.time);\n    container.querySelector(\"audio\").setAttribute(\"src\", \"/assets/audios/\" + milestone.sound);\n\n    this.initText(container);\n  }\n\n  startGlobe(){\n    const inside = document.querySelector(\".globe .inside\");\n    const texts = document.querySelectorAll(\".globe .off span.letter span\");\n    const svg = document.querySelectorAll(\".globe .inside svg\");\n    const stones = document.querySelectorAll(\".globe .milestones li\");\n\n    anime.timeline({loop:false})\n      .add({\n        targets: texts,\n        translateY: [0, '100%'],\n        easing: \"easeInCubic\",\n        duration: 555,\n        delay: (el, i) => 55 * i,\n        complete: () => inside.classList.add(\"hide\")\n      }).add({\n        targets: svg,\n        opacity: 0,\n        translateY: [0, 30],\n        duration: 555,\n        easing: \"easeInCubic\",\n            \n      }, 0).add({\n        targets: stones,\n        translateY: [0, -10, 10, 0],\n        easing: \"easeInOutSine\",\n        duration: 777,\n        delay: (el, i) => 55 * i\n      });\n  }\n\n  initCurtain(milestone){\n    curtain = document.querySelector(\".curtain\");\n    curtain.classList.remove(\"hide\");\n\n    const ms = document.querySelector(\".milestones li:nth-child(\"+(milestone.id+1)+\")\");\n    ms.classList.add(\"visited\");\n        \n    const h2 = document.querySelector(\".curtain h2\");\n    const bubble = document.querySelector(\".yearBubble span\");\n    h2.innerText = milestone.city;\n    const _h = h2.getBoundingClientRect().height;\n    const text = milestone.city;\n\n    h2.innerHTML = \"\";\n    bubble.innerHTML = milestone.year;\n\n    for (var i = 0; i < 6; ++i) {\n      const div = document.createElement(\"div\");\n      const ratio = (10 - i * 1.2) / 10;\n      div.style.cssText = \"height:\" + (_h * ratio) + \"px; \" + (i == 1 ? \" color:#DCDFE3;\" : \"\");\n      div.innerHTML = \"<span>\" + text + \"</span>\";\n\n      h2.appendChild(div);\n    }\n  }\n\n  animateCurtain(DIRECTION, callback){\n    if(DIRECTION == \"IN\"){\n      curtain.classList.add(\"in\");\n      anime.timeline().add({\n        targets: '.curtain h2 span',\n        translateY: [\"100%\", 0],\n        easing: \"easeOutExpo\",\n        duration: (el, i) => 950 + 150 * i,\n        delay: (el, i) => 66 * i\n      }).add({\n        targets: '.curtain .yearBubble',\n        translateY: [1000, 0],\n        rotate: [\"-90deg\", 0],\n        easing: \"easeOutCubic\",\n        duration: 999,\n      }, 0);\n    }else{\n      anime.timeline().add({\n        targets: '.curtain .yearBubble',\n        translateY: [0, -1000],\n        rotate: [0, \"90deg\"],\n        easing: \"easeInCubic\",\n        duration: 999,\n      }).add({\n        targets: '.curtain h2 span',\n        translateY: [0, \"-120%\"],\n        easing: \"easeInCubic\",\n        duration: (el, i) => 1150 - 160 * i,\n        complete:()=>{\n          curtain.classList.remove(\"in\");\n          if(callback) callback();\n        }\n      })\n    }\n  }\n\n  animateGlobe(section){\n    const _this = this;\n    _this.animate(section);\n    const svg = document.querySelectorAll(\".globe .inside svg\");\n    const stones = document.querySelectorAll(\".globe .milestones li\");\n    anime.timeline().add({\n        targets: stones,\n        translateY: [-70, 0],\n        opacity: [0, 1],\n        easing: \"easeInOutCubic\",\n        duration: 999,\n        delay: (el, i) => 55 * i,\n      }).add({\n          targets: svg,\n          opacity: [0, 1],\n          duration: 999,\n          delay: 555,\n      }, 0);\n  }\n\n  animateAbout(){\n    const about = document.querySelector(\"section.about\");\n    const intro = document.querySelector(\"section.intro\");\n    const ps = document.querySelectorAll(\"section.about p\");\n    const btn = document.querySelectorAll(\"section.about button\");\n\n    about.classList.remove(\"hide\");\n\n    anime.timeline().add({\n      targets: ps,\n      translateY: [60, 0],\n      scaleY: [1.2, 1],\n      opacity: [0, 1],\n      easing: \"easeOutCubic\",\n      duration: 999,\n      delay: (el, i) => 99 * i\n    }).add({\n      targets:btn,\n      opacity: [0, 1],\n      duration: 555\n    });\n  }\n\n  animateAboutClose(){\n    const about = document.querySelector(\"section.about\");\n    const intro = document.querySelector(\"section.intro\");\n    const ps = document.querySelectorAll(\"section.about p\");\n    const btn = document.querySelectorAll(\"section.about button\");\n    \n    about.classList.add(\"hide\");\n  }\n\n  animate(section){\n    const texts = section.querySelectorAll(\".off\");\n\n    for(var i=0; i<texts.length; ++i){\n      texts[i].style.opacity = 1;\n      anime.timeline({loop:false})\n        .add({\n          targets: texts[i].querySelectorAll(\".letter span\"),\n          translateY: ['100%',0],\n          easing: \"easeOutExpo\",\n          duration: 999,\n          delay: (el, i) => 99 * i\n        }).add({\n          targets: texts[i],\n          translateY: ['40%', 0],\n          //scale:[1.2, 1],\n          easing: \"easeOutCubic\",\n          duration: 2222,\n        }, 0);\n    }\n  }\n\n}\n","import * as THREE from 'three';\nimport anime from \"animejs\";\n\nimport Overlay from './overlay';\n\nimport Config from \"../data/config\";\nimport vars from \"./vars\";\nimport fx from \"./fx\";\n\nconst color = {r:Config.colors.night.r, g:Config.colors.night.g, b:Config.colors.night.b};\nlet sections, section;\n\nexport default class Timeline {\n  constructor(main) {\n\n    const _this = this;\n    sections = document.querySelectorAll('main section');\n\n    // init the overlay\n    this.overlay = new Overlay();\n    vars.overlay = this.overlay;\n\n    // animate stars\n    vars.loopFunctions.push([main.stars.animate, \"ANIMATE_STARS\", 0]);\n        \n    this.goto = {\n      preloader: (callback) => {\n\n        //console.log('[ timeline : preloader ]');\n        this.fixSections([0]);\n\n        anime({\n          targets: color,\n          r: Config.colors.day.r,\n          g: Config.colors.day.g,\n          b: Config.colors.day.b,\n          duration: 1000,\n          delay:10,\n          easing: 'linear',\n          update: function(){\n            const c = \"rgb(\"+Math.floor(color.r)+\", \"+Math.floor(color.g)+\", \"+Math.floor(color.b)+\")\";\n            main.scene.fog = new THREE.FogExp2(c, Config.fog.near);\n            main.scene.background = new THREE.Color(c);\n          },\n          complete:function(){\n                        \n            section.classList.add(\"play\");\n            \n            setTimeout(() => {\n                section.classList.add(\"full\");\n            }, 1444);\n\n            setTimeout(() => {\n                section.classList.add(\"done\");\n                setTimeout(() => { \n                  \n                  _this.goto.intro();\n\n                  anime.timeline()\n                    .add({\n                        targets: main.earth.object.position,\n                        z: 0,\n                        duration:3000,\n                        delay: 555,\n                        easing:\"easeInOutQuad\",\n                        complete:()=>{\n                            fx.removeFromLoop(\"ANIMATE_STARS\");\n                        }\n                    }).add({\n                        targets: main.earth.object.rotation,\n                        y: 0,\n                        duration:4000,\n                        easing: \"easeInOutQuad\",\n                        complete:()=>{\n                            vars.isMouseActive = true;\n                        }\n                    }, 0);\n\n\n                }, 1333);\n            }, 3000);\n          }\n        });\n\n      },\n      intro: (callback) => {\n\n        //console.log('[ timeline : intro ]');\n        this.fixSections([1]);\n        this.overlay.animate(section);\n\n        //vars.main.globe.addMarkers();\n\n        setTimeout(() => {\n            //vars.main.globe.showMarkers();\n\n            //vars.main.earth.animateCut();\n            vars.main.addGlobe();\n\n            anime({\n                targets:vars.localPlanes,\n                constant: 0,\n                duration: 666,\n                easing: \"easeInOutCubic\",\n                complete:()=>{\n                    vars.isCutActive = true;\n                }\n            })\n\n        }, 4000);\n\n        /*\n        anime.timeline({loop:false,})\n          .add({\n            targets:main.camera.threeCamera.position,\n            z:250,\n            y:0,\n            duration:2000,\n            easing:\"easeInOutCubic\",\n            delay:1000,\n          }).add({\n            targets:main.camera.threeCamera.rotation,\n            x:0,\n            duration:2000,\n            easing:\"easeInOutCubic\"\n          }, '-=2000').add({\n            targets: main.earth.object.rotation,\n            y: -110 * THREE.Math.DEG2RAD,\n            x: 30 * THREE.Math.DEG2RAD,\n            duration:6000,\n            easing:\"easeInOutQuad\"\n          }, '-=2000');\n          */\n                \n      },\n      globe: (callback) => {\n        //console.log('[ timeline : globe ]');\n        this.fixSections([2]);\n        this.overlay.animateGlobe(section);\n\n        document.body.classList.add(\"ready\");\n\n        setTimeout(() => {\n            this.overlay.startGlobe();\n        }, 5555);\n\n        anime({\n            targets: color,\n            r: Config.colors.globe.r,\n            g: Config.colors.globe.g,\n            b: Config.colors.globe.b,\n            duration: 1000,\n            easing: 'linear',\n            update: function(){\n              const c = \"rgb(\"+Math.floor(color.r)+\", \"+Math.floor(color.g)+\", \"+Math.floor(color.b)+\")\";\n              main.scene.fog = new THREE.FogExp2(c, Config.fog.near);\n              main.scene.background = new THREE.Color(c);\n            },\n        });\n        //vars.isPaused = true;\n        //fx.removeFromLoop(\"ANIMATE_STARS\");\n      },\n      curtain: (n, callback) => {\n        //console.log('[ timeline : transition curtain ]');\n        this.fixSections([3]);\n        this.overlay.animateCurtain(\"IN\");\n        document.body.classList.remove(\"hold\");\n      },\n      section: (n, callback) => {\n        //console.log('[ timeline : section'+n+' ]');\n        this.fixSections([2, 4]);\n        this.overlay.animate(section);\n      },\n      about: (n, callback) => {\n        //console.log('[ timeline : section'+n+' ]');\n        this.fixSections([5]);\n        this.overlay.animate(section);\n      }\n    };\n\n    const getTextures = ()=> new Promise((resolve, reject)=>{\n      const loader = new THREE.TextureLoader();\n      THREE.DefaultLoadingManager.onProgress = (url, loaded, total) => {\n        //console.log(url, loaded, total);\n      }\n      THREE.DefaultLoadingManager.onLoad = ()=>resolve(textures);\n      const textures = [\n        vars.path.textures + 'map2.jpg',\n        vars.path.textures + 'elevation2.jpg',\n        vars.path.textures + 'water.png',\n        vars.path.textures + 'clouds.png'\n      ].map(filename=>loader.load(filename));\n    });\n          \n    getTextures().then(result=>{\n      vars.textures = result;\n      //console.log(\"We received,\", result);\n      setTimeout(() => { \n        main.addEarth();\n        _this.goto.preloader();\n        //vars.main.flipScene(1);\n        //vars.main.initPlatform();\n      }, 333);\n    });\n\n  }\n\n  fixSections(n){\n    for(var i=0; i<sections.length; ++i){\n      if(n.includes(i)){\n        sections[i].classList.remove(\"hide\");\n        section = sections[i];\n      }else{\n        sections[i].classList.add(\"hide\");\n      }\n    }\n  }\n}\n","// Global imports -\nimport * as THREE from 'three';\nimport anime from 'animejs';\n\n// Local imports -\n// Components\nimport Renderer from './components/renderer';\nimport Camera from './components/camera';\nimport Light from './components/light';\nimport Controls from './components/controls';\n\n//Other\nimport Events from './events';\nimport vars from './vars';\n\n//Elements\nimport Globe from './elements/globe';\nimport Earth from './elements/earth';\nimport Stars from './elements/stars';\nimport Platform from './elements/platform';\nimport Timeline from './timeline';\n\n// data\nimport Config from './../data/config';\n// -- End of imports\n\nimport { RenderPass } from 'three/examples/jsm/postprocessing/RenderPass';\nimport { ShaderPass } from 'three/examples/jsm/postprocessing/ShaderPass';\nimport { EffectComposer } from 'three/examples/jsm/postprocessing/EffectComposer.js';\nimport { FXAAShader } from 'three/examples/jsm/shaders/FXAAShader.js';\nimport { FilmGrainShader } from './helpers/FilmGrainShader.js';\nimport { LensDistortionShader } from './helpers/LensDistortionShader.js';\n\nvar composer, composer2, renderPass, renderPass2, distortPass, grainPass, fxaaPass, bloomPass, bokehPass;\n\nvar params = {\n  enableNoise: true,\n  noiseSpeed: 0.0,\n  noiseIntensity: 0.0,\n\n  enableDistortion: true,\n  baseIor: 1.0,\n  bandOffset: 0.0,\n  jitterIntensity: 1.0,\n  samples: 7,\n\n  exposure: .01,\n  bloomStrength: .05,\n  bloomThreshold: 0.1,\n  bloomRadius: 0.1,\n};\n\nvar activeScene = 0, scenes = [], composers = [];\n\nexport default class Main {\n  constructor(container) {\n\n    vars.main = this;\n    \n    this.container = container;\n\n    // Start Three clock\n    this.clock = new THREE.Clock();\n\n    let startColor = \"rgb(\"+Config.colors.night.r+\", \"+Config.colors.night.g+\", \"+Config.colors.night.b+\")\";\n\n    // Main scene creation\n    this.scene = new THREE.Scene();\n    this.scene.fog = new THREE.FogExp2(startColor, Config.fog.near);\n    scenes.push(this.scene);\n\n    // Main scene creation\n    this.scene2 = new THREE.Scene();\n    this.scene2.fog = new THREE.FogExp2(Config.fog2.color, Config.fog2.near);\n    scenes.push(this.scene2);\n\n    // Get Device Pixel Ratio first for retina\n    if(window.devicePixelRatio) {\n      Config.dpr = window.devicePixelRatio;\n    }\n\n    // Main renderer constructor\n    this.renderer = new Renderer(this.scene, container);\n\n    // Components instantiations\n    this.camera = new Camera(this.renderer.threeRenderer);\n    this.controls = new Controls(this.camera.threeCamera, container);\n    this.controls.threeControls.enabled = false;\n    this.light = new Light(this.scene);\n    this.light2 = new Light(this.scene2);\n\n    // Render Pass Setup\n    renderPass = new RenderPass( this.scene, this.camera.threeCamera );\n    renderPass2 = new RenderPass( this.scene2, this.camera.threeCamera );\n    grainPass = new ShaderPass( FilmGrainShader );\n    fxaaPass = new ShaderPass( FXAAShader );\n    distortPass = new ShaderPass( LensDistortionShader );\n    \n    //grainPass.material.uniforms.intensity.value = 0.05;\n    distortPass.material.defines.CHROMA_SAMPLES = 7;\n    distortPass.material.uniforms.jitterIntensity.value = params.jitterIntensity;\n\n    composer = new EffectComposer( this.renderer.threeRenderer );\n    composer.setSize( window.innerWidth, window.innerHeight );\n    composer.setPixelRatio( window.devicePixelRatio );\n    composer.addPass( renderPass );\n    composer.addPass( fxaaPass );\n    composer.addPass( distortPass );\n    composer.addPass( grainPass );\n    \n    composers.push(composer);\n\n    composer2 = new EffectComposer( this.renderer.threeRenderer );\n    composer2.setSize( window.innerWidth, window.innerHeight );\n    composer2.setPixelRatio( window.devicePixelRatio );\n    composer2.addPass( renderPass2 );\n    composer2.addPass( fxaaPass );\n    composer2.addPass( distortPass );\n    composer2.addPass( grainPass );\n\n    composers.push(composer2);\n\n\n    // Create and place lights in scene\n    const lights = ['ambient', 'directional', 'point', 'hemi'];\n    lights.forEach((light) => this.light.place(light));\n    \n    const lights2 = ['hemi', 'point', 'directional', 'ambient'];\n    lights2.forEach((light) => this.light2.place(light));\n\n\n    //this.globe = new Globe(this);\n    //this.earth = new Earth(this);\n    this.stars = new Stars(this);\n    this.platform = new Platform(this);\n\n    this.camera.threeCamera.position.set(0, 0, 270);\n    //this.camera.threeCamera.rotation.set(-30 * THREE.Math.DEG2RAD, 0, 0);\n    \n    //this.overlay = new Overlay();\n    this.timeline = new Timeline(this);\n\n    this.events = new Events(this);\n    this.events.init(this);\n\n    this.render();\n  }\n\n  addGlobe(){\n    this.globe = new Globe(this);\n  }\n\n  addEarth(){\n    this.earth = new Earth(this);\n  }\n\n  warp(DIRECTION, callback){\n\n    const wrapDuration = 2000;\n    const easingIn = 'easeInQuad';\n\n    if(DIRECTION == \"IN\"){\n      anime({\n        targets: params,\n        baseIor: [1.0, 0.5], bandOffset: [0.0, 0.05],\n        easing: easingIn,\n        duration: wrapDuration,\n        complete: ()=>{ if(callback) callback(); }\n      });\n    }else if(DIRECTION == \"OUT\"){\n      anime({\n        targets: params,\n        baseIor: [1.4, 1.0], bandOffset: [0.08, 0.0],\n        easing: \"easeOutCubic\",\n        duration: wrapDuration,\n        complete: ()=>{ if(callback) callback(); },\n      });\n    }else if(DIRECTION == \"RIN\"){\n      anime({\n        targets: params,\n        baseIor: [1.0, 1.4], bandOffset: [0.0, 0.08],\n        easing: \"easeInCubic\",\n        duration: wrapDuration * .5,\n        complete: ()=>{ if(callback) callback(); }\n      });\n    }else if(DIRECTION == \"ROUT\"){\n      anime({\n        targets: params,\n        baseIor: [0.5, 1.0], bandOffset: [0.05, 0.0],\n        easing: \"easeInCubic\",\n        duration: wrapDuration * .5,\n        complete: ()=>{ if(callback) callback(); }\n      });\n    }\n  }\n\n  flipScene(K){\n    activeScene = K;\n    if( activeScene == 0 ){\n      this.renderer.threeRenderer.setClearColor(Config.fog.color);\n      this.controls.threeControls.enabled = true;\n    }else{\n      this.controls.threeControls.enabled = false;\n      this.renderer.threeRenderer.setClearColor(Config.fog2.color);\n    }\n  }\n\n  initPlatform(){\n    this.camera.threeCamera.position.set(Config.platformCamera.posX, Config.platformCamera.posY, Config.platformCamera.posZ);\n    this.camera.threeCamera.lookAt(0,0,0);\n    this.platform.init();\n    vars.platformIsInitialized = true;\n  }\n\n  resetPlatform(){\n    this.platform.removeModel();\n  }\n\n  disposePlatform(){\n    this.platform.dispose();\n  }\n\n  render() {\n\n    // Call render function and pass in created scene and camera\n    //this.renderer.render(this.scene, this.camera.threeCamera);\n\n    distortPass.material.uniforms.baseIor.value = params.baseIor;\n    distortPass.material.uniforms.bandOffset.value = params.bandOffset;\n    \n    composers[activeScene].render();\n    \n    const delta = this.clock.getDelta();\n\n    // loop functions\n    if(!vars.isPauseLoopFunctions){\n      var time = Date.now();\n      for (var i in vars.loopFunctions){\n        if( vars.loopFunctions[i][2] == activeScene ) vars.loopFunctions[i][0](time, delta);\n      }\n    }\n    \n    if(vars.isMouseActive){\n      scenes[activeScene].rotation.y = THREE.MathUtils.lerp(scenes[activeScene].rotation.y, (vars.mouseCoords.x * Math.PI) / 10, 0.05);\n      scenes[activeScene].rotation.x = THREE.MathUtils.lerp(scenes[activeScene].rotation.x, (vars.mouseCoords.y * Math.PI) / 10, 0.05);\n    }\n\n    if(vars.isCutActive){\n      let vec = ((.5 - vars.mouseCoords.x) * 100) - vars.localPlanes[0].constant;\n      vars.localPlanes[0].constant += vec / 30;\n      vars.localPlanes[1].constant += -vec / 30;\n    }\n\n    // RAF\n    if(!vars.isPaused)\n      requestAnimationFrame(this.render.bind(this)); // Bind the main class instead of window object\n  }\n}\n","// https://www.shadertoy.com/view/4t2fRz\n\nexport const FilmGrainShader = {\n\n  uniforms: {\n\n    tDiffuse: { value: null },\n    intensity: { value: 0.075 },\n    noiseOffset: { value: 0.0 },\n\n  },\n\n  vertexShader: /* glsl */`\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}\n\n\t`,\n\n  fragmentShader: /* glsl */`\n\n\t\t// 0: Addition, 1: Screen, 2: Overlay, 3: Soft Light, 4: Lighten-Only\n\t\t#define BLEND_MODE 0\n\n\t\t// What gray level noise should tend to.\n\t\t#define MEAN 0.0\n\n\t\t// Controls the contrast/variance of noise.\n\t\t#define VARIANCE 0.5\n\n\t\tvarying vec2 vUv;\n\t\tuniform float intensity;\n\t\tuniform float noiseOffset;\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvec3 channel_mix( vec3 a, vec3 b, vec3 w ) {\n\n\t\t\treturn vec3(\n\t\t\t\tmix( a.r, b.r, w.r ),\n\t\t\t\tmix( a.g, b.g, w.g ),\n\t\t\t\tmix( a.b, b.b, w.b )\n\t\t\t);\n\n\t\t}\n\n\t\tfloat gaussian( float z, float u, float o ) {\n\n\t\t\treturn (\n\t\t\t\t1.0 / ( o * sqrt( 2.0 * 3.1415 ) ) ) * exp( - ( ( ( z - u ) * ( z - u ) ) / ( 2.0 * ( o * o ) ) )\n\t\t\t);\n\n\t\t}\n\n\t\tvec3 madd( vec3 a, vec3 b, float w ) {\n\n\t\t\treturn a + a * b * w;\n\n\t\t}\n\n\t\tvec3 screen( vec3 a, vec3 b, float w ) {\n\n\t\t\treturn mix(\n\t\t\t\ta,\n\t\t\t\tvec3( 1.0 ) - ( vec3( 1.0 ) - a ) * ( vec3( 1.0 ) - b ),\n\t\t\t\tw\n\t\t\t);\n\n\t\t}\n\n\t\tvec3 overlay( vec3 a, vec3 b, float w ) {\n\n\t\t\treturn mix(\n\t\t\t\ta,\n\t\t\t\tchannel_mix(\n\t\t\t\t\t2.0 * a * b,\n\t\t\t\t\tvec3( 1.0 ) - 2.0 * ( vec3( 1.0 ) - a ) * ( vec3( 1.0 ) - b ),\n\t\t\t\t\tstep( vec3( 0.5 ), a )\n\t\t\t\t),\n\t\t\t\tw\n\t\t\t);\n\n\t\t}\n\n\t\tvec3 soft_light( vec3 a, vec3 b, float w ) {\n\n\t\t\treturn mix(\n\t\t\t\ta,\n\t\t\t\tpow(\n\t\t\t\t\ta,\n\t\t\t\t\tpow( vec3( 2.0 ), 2.0 * ( vec3( 0.5 ) - b) )\n\t\t\t\t),\n\t\t\t\tw\n\t\t\t);\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvec4 color;\n\n\t\t\tvec2 uv = vUv;\n\t\t\tcolor = texture2D( tDiffuse, uv );\n\n\t\t\tfloat t = noiseOffset;\n\t\t\tfloat seed = dot( uv, vec2( 12.9898, 78.233 ) );\n\t\t\tfloat noise = fract( sin( seed ) * 43758.5453 + t );\n\t\t\tnoise = gaussian( noise, float( MEAN ), float( VARIANCE ) * float( VARIANCE ) );\n\n\t\t\t// Ignore these mouse stuff if you're porting this\n\t\t\t// and just use an arbitrary intensity value.\n\t\t\tfloat w = intensity;\n\t\t\tvec3 grain = vec3( noise ) * ( 1.0 - color.rgb );\n\n\t\t\t// addition\n\t\t\t#if BLEND_MODE == 0\n\t\t\tcolor.rgb += grain * w;\n\n\t\t\t// screen\n\t\t\t#elif BLEND_MODE == 1\n\t\t\tcolor.rgb = screen(color.rgb, grain, w);\n\n\t\t\t// overlay\n\t\t\t#elif BLEND_MODE == 2\n\t\t\tcolor.rgb = overlay(color.rgb, grain, w);\n\n\t\t\t// soft light\n\t\t\t#elif BLEND_MODE == 3\n\t\t\tcolor.rgb = soft_light(color.rgb, grain, w);\n\n\t\t\t// lighten only\n\t\t\t#elif BLEND_MODE == 4\n\t\t\tcolor.rgb = max(color.rgb, grain * w);\n\t\t\t#endif\n\n\t\t\tgl_FragColor = color;\n\n\t\t}\n\n\t`,\n\n};\n","// https://www.shadertoy.com/view/4t2fRz\n\nexport const LensDistortionShader = {\n\n  defines: {\n\n    // 0: NONE, 1: RGB, 2: RYGCBV\n    BAND_MODE: 2,\n\n    CHROMA_SAMPLES: 1,\n\n  },\n\n  uniforms: {\n\n    tDiffuse: { value: null },\n    baseIor: { value: 0.075 },\n    bandOffset: { value: 0.003 },\n    jitterIntensity: { value: 1.0 },\n    jitterOffset: { value: 0.0 },\n\n  },\n\n  vertexShader: /* glsl */`\n\n\t\tvarying vec2 vUv;\n\t\tvarying vec3 viewDir;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\tviewDir = normalize( ( modelViewMatrix * vec4( position, 1.0 ) ).xyz );\n\n\t\t}\n\n\t`,\n\n  fragmentShader: /* glsl */`\n\n\t\tvarying vec2 vUv;\n\t\tvarying vec3 viewDir;\n\t\tuniform float baseIor;\n\t\tuniform float bandOffset;\n\t\tuniform float jitterIntensity;\n\t\tuniform float jitterOffset;\n\t\tuniform sampler2D tDiffuse;\n\n\t\t#include <common>\n\t\tvoid main() {\n\n\t\t\tvec3 normal = vec3( ( 2.0 * vUv - vec2( 1.0 ) ), 1.0 );\n\t\t\tnormal.z = 1.0;\n\t\t\tnormal = normalize( normal );\n\n\t\t\tvec3 color;\n\n\t\t\t// if NO BANDS\n\t\t\t#if BAND_MODE == 0\n\n\t\t\tvec3 refracted = refract( vec3( 0.0, 0.0, - 1.0 ), normal, baseIor );\n\t\t\tcolor = texture2D( tDiffuse, vUv + refracted.xy ).rgb;\n\n\t\t\t// if RGB or RYGCBV BANDS\n\t\t\t#else\n\n\t\t\tfloat index, randValue, offsetValue;\n\t\t\tfloat r, g, b, r_ior, g_ior, b_ior;\n\t\t\tvec3 r_refracted, g_refracted, b_refracted;\n\t\t\tvec4 r_sample, g_sample, b_sample;\n\n\t\t\t#if BAND_MODE == 2\n\t\t\tfloat y, c, v, y_ior, c_ior, v_ior;\n\t\t\tvec3 y_refracted, c_refracted, v_refracted;\n\t\t\tvec4 y_sample, c_sample, v_sample;\n\t\t\t#endif\n\n\t\t\tfor ( int i = 0; i < CHROMA_SAMPLES; i ++ ) {\n\n\t\t\t\tindex = float( i );\n\t\t\t\trandValue = rand( sin( index + 1. ) * gl_FragCoord.xy + vec2( jitterOffset, - jitterOffset ) ) - 0.5;\n\t\t\t\toffsetValue = index / float( CHROMA_SAMPLES ) + randValue * jitterIntensity;\n\t\t\t\t#if BAND_MODE == 1\n\t\t\t\trandValue *= 2.0;\n\t\t\t\t#endif\n\n\t\t\t\t// Paper describing functions for creating yellow, cyan, and violet bands and reforming\n\t\t\t\t// them into RGB:\n\t\t\t\t// https://web.archive.org/web/20061108181225/http://home.iitk.ac.in/~shankars/reports/dispersionraytrace.pdf\n\t\t\t\tr_ior = 1.0 + bandOffset * ( 0.0 + offsetValue );\n\t\t\t\tg_ior = 1.0 + bandOffset * ( 2.0 + offsetValue );\n\t\t\t\tb_ior = 1.0 + bandOffset * ( 4.0 + offsetValue );\n\n\t\t\t\tr_refracted = refract( vec3( 0.0, 0.0, - 1.0 ), normal, baseIor / r_ior );\n\t\t\t\tg_refracted = refract( vec3( 0.0, 0.0, - 1.0 ), normal, baseIor / g_ior );\n\t\t\t\tb_refracted = refract( vec3( 0.0, 0.0, - 1.0 ), normal, baseIor / b_ior );\n\n\t\t\t\tr_sample = texture2D( tDiffuse, vUv + r_refracted.xy );\n\t\t\t\tg_sample = texture2D( tDiffuse, vUv + g_refracted.xy );\n\t\t\t\tb_sample = texture2D( tDiffuse, vUv + b_refracted.xy );\n\n\t\t\t\t#if BAND_MODE == 2\n\t\t\t\ty_ior = 1.0 + bandOffset * ( 1.0 + offsetValue );\n\t\t\t\tc_ior = 1.0 + bandOffset * ( 3.0 + offsetValue );\n\t\t\t\tv_ior = 1.0 + bandOffset * ( 5.0 + offsetValue );\n\n\t\t\t\ty_refracted = refract( vec3( 0.0, 0.0, - 1.0 ), normal, baseIor / y_ior );\n\t\t\t\tc_refracted = refract( vec3( 0.0, 0.0, - 1.0 ), normal, baseIor / c_ior );\n\t\t\t\tv_refracted = refract( vec3( 0.0, 0.0, - 1.0 ), normal, baseIor / v_ior );\n\n\t\t\t\ty_sample = texture2D( tDiffuse, vUv + y_refracted.xy );\n\t\t\t\tc_sample = texture2D( tDiffuse, vUv + c_refracted.xy );\n\t\t\t\tv_sample = texture2D( tDiffuse, vUv + v_refracted.xy );\n\n\t\t\t\tr = r_sample.r / 2.0;\n\t\t\t\ty = ( 2.0 * y_sample.r + 2.0 * y_sample.g - y_sample.b ) / 6.0;\n\t\t\t\tg = g_sample.g / 2.0;\n\t\t\t\tc = ( 2.0 * c_sample.g + 2.0 * c_sample.b - c_sample.r ) / 6.0;\n\t\t\t\tb = b_sample.b / 2.0;\n\t\t\t\tv = ( 2.0 * v_sample.b + 2.0 * v_sample.r - v_sample.g ) / 6.0;\n\n\t\t\t\tcolor.r += r + ( 2.0 * v + 2.0 * y - c ) / 3.0;\n\t\t\t\tcolor.g += g + ( 2.0 * y + 2.0 * c - v ) / 3.0;\n\t\t\t\tcolor.b += b + ( 2.0 * c + 2.0 * v - y ) / 3.0;\n\t\t\t\t#else\n\t\t\t\tcolor.r += r_sample.r;\n\t\t\t\tcolor.g += g_sample.g;\n\t\t\t\tcolor.b += b_sample.b;\n\t\t\t\t#endif\n\n\t\t\t}\n\n\t\t\tcolor /= float( CHROMA_SAMPLES );\n\n\t\t\t#endif\n\n\t\t\tgl_FragColor = vec4( color, 1.0 );\n\n\t\t}\n\n\t`,\n\n};\n","import Config from './data/config';\nimport Detector from './utils/detector';\nimport Main from './app/main';\n\n// Styles\nimport './../css/app.scss';\n\n// Check environment and set the Config helper\nif(__ENV__ === 'dev') {\n  console.log('----- RUNNING IN DEV ENVIRONMENT! -----');\n\n  Config.isDev = true;\n}\n\nfunction init() {\n  // Check for webGL capabilities\n  if(!Detector.webgl) {\n    Detector.addGetWebGLMessage();\n  } else {\n    const container = document.getElementById('appContainer');\n    new Main(container);\n  }\n}\n\ninit();\n","module.exports = function (THREE) {\n  var MOUSE = THREE.MOUSE;\n  if (!MOUSE) MOUSE = { LEFT: 0, MIDDLE: 1, RIGHT: 2 };\n\n  /**\n   * @author qiao / https://github.com/qiao\n   * @author mrdoob / http://mrdoob.com\n   * @author alteredq / http://alteredqualia.com/\n   * @author WestLangley / http://github.com/WestLangley\n   * @author erich666 / http://erichaines.com\n   */\n  /*global THREE, console */\n\n  function OrbitConstraint(object) {\n    this.object = object;\n\n    // \"target\" sets the location of focus, where the object orbits around\n    // and where it pans with respect to.\n    this.target = new THREE.Vector3();\n\n    // Limits to how far you can dolly in and out ( PerspectiveCamera only )\n    this.minDistance = 0;\n    this.maxDistance = Infinity;\n\n    // Limits to how far you can zoom in and out ( OrthographicCamera only )\n    this.minZoom = 0;\n    this.maxZoom = Infinity;\n\n    // How far you can orbit vertically, upper and lower limits.\n    // Range is 0 to Math.PI radians.\n    this.minPolarAngle = 0; // radians\n    this.maxPolarAngle = Math.PI; // radians\n\n    // How far you can orbit horizontally, upper and lower limits.\n    // If set, must be a sub-interval of the interval [ - Math.PI, Math.PI ].\n    this.minAzimuthAngle = -Infinity; // radians\n    this.maxAzimuthAngle = Infinity; // radians\n\n    // Set to true to enable damping (inertia)\n    // If damping is enabled, you must call controls.update() in your animation loop\n    this.enableDamping = false;\n    this.dampingFactor = 0.25;\n\n    ////////////\n    // internals\n\n    var scope = this;\n\n    var EPS = 0.000001;\n\n    // Current position in spherical coordinate system.\n    var theta;\n    var phi;\n\n    // Pending changes\n    var phiDelta = 0;\n    var thetaDelta = 0;\n    var scale = 1;\n    var panOffset = new THREE.Vector3();\n    var zoomChanged = false;\n\n    // API\n\n    this.getPolarAngle = function () {\n      return phi;\n    };\n\n    this.getAzimuthalAngle = function () {\n      return theta;\n    };\n\n    this.rotateLeft = function (angle) {\n      thetaDelta -= angle;\n    };\n\n    this.rotateUp = function (angle) {\n      phiDelta -= angle;\n    };\n\n    // pass in distance in world space to move left\n    this.panLeft = (function () {\n      var v = new THREE.Vector3();\n\n      return function panLeft(distance) {\n        var te = this.object.matrix.elements;\n\n        // get X column of matrix\n        v.set(te[0], te[1], te[2]);\n        v.multiplyScalar(-distance);\n\n        panOffset.add(v);\n      };\n    })();\n\n    // pass in distance in world space to move up\n    this.panUp = (function () {\n      var v = new THREE.Vector3();\n\n      return function panUp(distance) {\n        var te = this.object.matrix.elements;\n\n        // get Y column of matrix\n        v.set(te[4], te[5], te[6]);\n        v.multiplyScalar(distance);\n\n        panOffset.add(v);\n      };\n    })();\n\n    // pass in x,y of change desired in pixel space,\n    // right and down are positive\n    this.pan = function (deltaX, deltaY, screenWidth, screenHeight) {\n      if (scope.object instanceof THREE.PerspectiveCamera) {\n        // perspective\n        var position = scope.object.position;\n        var offset = position.clone().sub(scope.target);\n        var targetDistance = offset.length();\n\n        // half of the fov is center to top of screen\n        targetDistance *= Math.tan(((scope.object.fov / 2) * Math.PI) / 180.0);\n\n        // we actually don't use screenWidth, since perspective camera is fixed to screen height\n        scope.panLeft((2 * deltaX * targetDistance) / screenHeight);\n        scope.panUp((2 * deltaY * targetDistance) / screenHeight);\n      } else if (scope.object instanceof THREE.OrthographicCamera) {\n        // orthographic\n        scope.panLeft((deltaX * (scope.object.right - scope.object.left)) / screenWidth);\n        scope.panUp((deltaY * (scope.object.top - scope.object.bottom)) / screenHeight);\n      } else {\n        // camera neither orthographic or perspective\n        console.warn(\n          'WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.'\n        );\n      }\n    };\n\n    this.dollyIn = function (dollyScale) {\n      if (scope.object instanceof THREE.PerspectiveCamera) {\n        scale /= dollyScale;\n      } else if (scope.object instanceof THREE.OrthographicCamera) {\n        scope.object.zoom = Math.max(\n          this.minZoom,\n          Math.min(this.maxZoom, this.object.zoom * dollyScale)\n        );\n        scope.object.updateProjectionMatrix();\n        zoomChanged = true;\n      } else {\n        console.warn(\n          'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.'\n        );\n      }\n    };\n\n    this.dollyOut = function (dollyScale) {\n      if (scope.object instanceof THREE.PerspectiveCamera) {\n        scale *= dollyScale;\n      } else if (scope.object instanceof THREE.OrthographicCamera) {\n        scope.object.zoom = Math.max(\n          this.minZoom,\n          Math.min(this.maxZoom, this.object.zoom / dollyScale)\n        );\n        scope.object.updateProjectionMatrix();\n        zoomChanged = true;\n      } else {\n        console.warn(\n          'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.'\n        );\n      }\n    };\n\n    this.update = (function () {\n      var offset = new THREE.Vector3();\n\n      // so camera.up is the orbit axis\n      var quat = new THREE.Quaternion().setFromUnitVectors(object.up, new THREE.Vector3(0, 1, 0));\n      var quatInverse = quat.clone().inverse();\n\n      var lastPosition = new THREE.Vector3();\n      var lastQuaternion = new THREE.Quaternion();\n\n      return function () {\n        var position = this.object.position;\n\n        offset.copy(position).sub(this.target);\n\n        // rotate offset to \"y-axis-is-up\" space\n        offset.applyQuaternion(quat);\n\n        // angle from z-axis around y-axis\n\n        theta = Math.atan2(offset.x, offset.z);\n\n        // angle from y-axis\n\n        phi = Math.atan2(Math.sqrt(offset.x * offset.x + offset.z * offset.z), offset.y);\n\n        theta += thetaDelta;\n        phi += phiDelta;\n\n        // restrict theta to be between desired limits\n        theta = Math.max(this.minAzimuthAngle, Math.min(this.maxAzimuthAngle, theta));\n\n        // restrict phi to be between desired limits\n        phi = Math.max(this.minPolarAngle, Math.min(this.maxPolarAngle, phi));\n\n        // restrict phi to be betwee EPS and PI-EPS\n        phi = Math.max(EPS, Math.min(Math.PI - EPS, phi));\n\n        var radius = offset.length() * scale;\n\n        // restrict radius to be between desired limits\n        radius = Math.max(this.minDistance, Math.min(this.maxDistance, radius));\n\n        // move target to panned location\n        this.target.add(panOffset);\n\n        offset.x = radius * Math.sin(phi) * Math.sin(theta);\n        offset.y = radius * Math.cos(phi);\n        offset.z = radius * Math.sin(phi) * Math.cos(theta);\n\n        // rotate offset back to \"camera-up-vector-is-up\" space\n        offset.applyQuaternion(quatInverse);\n\n        position.copy(this.target).add(offset);\n\n        this.object.lookAt(this.target);\n\n        if (this.enableDamping === true) {\n          thetaDelta *= 1 - this.dampingFactor;\n          phiDelta *= 1 - this.dampingFactor;\n        } else {\n          thetaDelta = 0;\n          phiDelta = 0;\n        }\n\n        scale = 1;\n        panOffset.set(0, 0, 0);\n\n        // update condition is:\n        // min(camera displacement, camera rotation in radians)^2 > EPS\n        // using small-angle approximation cos(x/2) = 1 - x^2 / 8\n\n        if (\n          zoomChanged ||\n          lastPosition.distanceToSquared(this.object.position) > EPS ||\n          8 * (1 - lastQuaternion.dot(this.object.quaternion)) > EPS\n        ) {\n          lastPosition.copy(this.object.position);\n          lastQuaternion.copy(this.object.quaternion);\n          zoomChanged = false;\n\n          return true;\n        }\n\n        return false;\n      };\n    })();\n  }\n\n  // This set of controls performs orbiting, dollying (zooming), and panning. It maintains\n  // the \"up\" direction as +Y, unlike the TrackballControls. Touch on tablet and phones is\n  // supported.\n  //\n  //    Orbit - left mouse / touch: one finger move\n  //    Zoom - middle mouse, or mousewheel / touch: two finger spread or squish\n  //    Pan - right mouse, or arrow keys / touch: three finter swipe\n\n  function OrbitControls(object, domElement) {\n    var constraint = new OrbitConstraint(object);\n\n    this.domElement = domElement !== undefined ? domElement : document;\n\n    // API\n\n    Object.defineProperty(this, 'constraint', {\n      get: function () {\n        return constraint;\n      },\n    });\n\n    this.getPolarAngle = function () {\n      return constraint.getPolarAngle();\n    };\n\n    this.getAzimuthalAngle = function () {\n      return constraint.getAzimuthalAngle();\n    };\n\n    // Set to false to disable this control\n    this.enabled = true;\n\n    // center is old, deprecated; use \"target\" instead\n    this.center = this.target;\n\n    // This option actually enables dollying in and out; left as \"zoom\" for\n    // backwards compatibility.\n    // Set to false to disable zooming\n    this.enableZoom = true;\n    this.zoomSpeed = 1.0;\n\n    // Set to false to disable rotating\n    this.enableRotate = true;\n    this.rotateSpeed = 1.0;\n\n    // Set to false to disable panning\n    this.enablePan = true;\n    this.keyPanSpeed = 7.0; // pixels moved per arrow key push\n\n    // Set to true to automatically rotate around the target\n    // If auto-rotate is enabled, you must call controls.update() in your animation loop\n    this.autoRotate = false;\n    this.autoRotateSpeed = 2.0; // 30 seconds per round when fps is 60\n\n    // Set to false to disable use of the keys\n    this.enableKeys = true;\n\n    // The four arrow keys\n    this.keys = { LEFT: 37, UP: 38, RIGHT: 39, BOTTOM: 40 };\n\n    // Mouse buttons\n    this.mouseButtons = {\n      ORBIT: THREE.MOUSE.LEFT,\n      ZOOM: THREE.MOUSE.MIDDLE,\n      PAN: THREE.MOUSE.RIGHT,\n    };\n\n    ////////////\n    // internals\n\n    var scope = this;\n\n    var rotateStart = new THREE.Vector2();\n    var rotateEnd = new THREE.Vector2();\n    var rotateDelta = new THREE.Vector2();\n\n    var panStart = new THREE.Vector2();\n    var panEnd = new THREE.Vector2();\n    var panDelta = new THREE.Vector2();\n\n    var dollyStart = new THREE.Vector2();\n    var dollyEnd = new THREE.Vector2();\n    var dollyDelta = new THREE.Vector2();\n\n    var STATE = {\n      NONE: -1,\n      ROTATE: 0,\n      DOLLY: 1,\n      PAN: 2,\n      TOUCH_ROTATE: 3,\n      TOUCH_DOLLY: 4,\n      TOUCH_PAN: 5,\n    };\n\n    var state = STATE.NONE;\n\n    // for reset\n\n    this.target0 = this.target.clone();\n    this.position0 = this.object.position.clone();\n    this.zoom0 = this.object.zoom;\n\n    // events\n\n    var changeEvent = { type: 'change' };\n    var startEvent = { type: 'start' };\n    var endEvent = { type: 'end' };\n\n    // pass in x,y of change desired in pixel space,\n    // right and down are positive\n    function pan(deltaX, deltaY) {\n      var element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\n      constraint.pan(deltaX, deltaY, element.clientWidth, element.clientHeight);\n    }\n\n    this.update = function () {\n      if (this.autoRotate && state === STATE.NONE) {\n        constraint.rotateLeft(getAutoRotationAngle());\n      }\n\n      if (constraint.update() === true) {\n        this.dispatchEvent(changeEvent);\n      }\n    };\n\n    this.reset = function () {\n      state = STATE.NONE;\n\n      this.target.copy(this.target0);\n      this.object.position.copy(this.position0);\n      this.object.zoom = this.zoom0;\n\n      this.object.updateProjectionMatrix();\n      this.dispatchEvent(changeEvent);\n\n      this.update();\n    };\n\n    function getAutoRotationAngle() {\n      return ((2 * Math.PI) / 60 / 60) * scope.autoRotateSpeed;\n    }\n\n    function getZoomScale() {\n      return Math.pow(0.95, scope.zoomSpeed);\n    }\n\n    function onMouseDown(event) {\n      if (scope.enabled === false) return;\n\n      event.preventDefault();\n\n      if (event.button === scope.mouseButtons.ORBIT) {\n        if (scope.enableRotate === false) return;\n\n        state = STATE.ROTATE;\n\n        rotateStart.set(event.clientX, event.clientY);\n      } else if (event.button === scope.mouseButtons.ZOOM) {\n        if (scope.enableZoom === false) return;\n\n        state = STATE.DOLLY;\n\n        dollyStart.set(event.clientX, event.clientY);\n      } else if (event.button === scope.mouseButtons.PAN) {\n        if (scope.enablePan === false) return;\n\n        state = STATE.PAN;\n\n        panStart.set(event.clientX, event.clientY);\n      }\n\n      if (state !== STATE.NONE) {\n        document.addEventListener('mousemove', onMouseMove, false);\n        document.addEventListener('mouseup', onMouseUp, false);\n        scope.dispatchEvent(startEvent);\n      }\n    }\n\n    function onMouseMove(event) {\n      if (scope.enabled === false) return;\n\n      event.preventDefault();\n\n      var element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\n      if (state === STATE.ROTATE) {\n        if (scope.enableRotate === false) return;\n\n        rotateEnd.set(event.clientX, event.clientY);\n        rotateDelta.subVectors(rotateEnd, rotateStart);\n\n        // rotating across whole screen goes 360 degrees around\n        constraint.rotateLeft(\n          ((2 * Math.PI * rotateDelta.x) / element.clientWidth) * scope.rotateSpeed\n        );\n\n        // rotating up and down along whole screen attempts to go 360, but limited to 180\n        constraint.rotateUp(\n          ((2 * Math.PI * rotateDelta.y) / element.clientHeight) * scope.rotateSpeed\n        );\n\n        rotateStart.copy(rotateEnd);\n      } else if (state === STATE.DOLLY) {\n        if (scope.enableZoom === false) return;\n\n        dollyEnd.set(event.clientX, event.clientY);\n        dollyDelta.subVectors(dollyEnd, dollyStart);\n\n        if (dollyDelta.y > 0) {\n          constraint.dollyIn(getZoomScale());\n        } else if (dollyDelta.y < 0) {\n          constraint.dollyOut(getZoomScale());\n        }\n\n        dollyStart.copy(dollyEnd);\n      } else if (state === STATE.PAN) {\n        if (scope.enablePan === false) return;\n\n        panEnd.set(event.clientX, event.clientY);\n        panDelta.subVectors(panEnd, panStart);\n\n        pan(panDelta.x, panDelta.y);\n\n        panStart.copy(panEnd);\n      }\n\n      if (state !== STATE.NONE) scope.update();\n    }\n\n    function onMouseUp(/* event */) {\n      if (scope.enabled === false) return;\n\n      document.removeEventListener('mousemove', onMouseMove, false);\n      document.removeEventListener('mouseup', onMouseUp, false);\n      scope.dispatchEvent(endEvent);\n      state = STATE.NONE;\n    }\n\n    function onMouseWheel(event) {\n      if (scope.enabled === false || scope.enableZoom === false || state !== STATE.NONE) return;\n\n      event.preventDefault();\n      event.stopPropagation();\n\n      var delta = 0;\n\n      if (event.wheelDelta !== undefined) {\n        // WebKit / Opera / Explorer 9\n\n        delta = event.wheelDelta;\n      } else if (event.detail !== undefined) {\n        // Firefox\n\n        delta = -event.detail;\n      }\n\n      if (delta > 0) {\n        constraint.dollyOut(getZoomScale());\n      } else if (delta < 0) {\n        constraint.dollyIn(getZoomScale());\n      }\n\n      scope.update();\n      scope.dispatchEvent(startEvent);\n      scope.dispatchEvent(endEvent);\n    }\n\n    function onKeyDown(event) {\n      if (scope.enabled === false || scope.enableKeys === false || scope.enablePan === false)\n        return;\n\n      switch (event.keyCode) {\n        case scope.keys.UP:\n          pan(0, scope.keyPanSpeed);\n          scope.update();\n          break;\n\n        case scope.keys.BOTTOM:\n          pan(0, -scope.keyPanSpeed);\n          scope.update();\n          break;\n\n        case scope.keys.LEFT:\n          pan(scope.keyPanSpeed, 0);\n          scope.update();\n          break;\n\n        case scope.keys.RIGHT:\n          pan(-scope.keyPanSpeed, 0);\n          scope.update();\n          break;\n      }\n    }\n\n    function touchstart(event) {\n      if (scope.enabled === false) return;\n\n      switch (event.touches.length) {\n        case 1: // one-fingered touch: rotate\n          if (scope.enableRotate === false) return;\n\n          state = STATE.TOUCH_ROTATE;\n\n          rotateStart.set(event.touches[0].pageX, event.touches[0].pageY);\n          break;\n\n        case 2: // two-fingered touch: dolly\n          if (scope.enableZoom === false) return;\n\n          state = STATE.TOUCH_DOLLY;\n\n          var dx = event.touches[0].pageX - event.touches[1].pageX;\n          var dy = event.touches[0].pageY - event.touches[1].pageY;\n          var distance = Math.sqrt(dx * dx + dy * dy);\n          dollyStart.set(0, distance);\n          break;\n\n        case 3: // three-fingered touch: pan\n          if (scope.enablePan === false) return;\n\n          state = STATE.TOUCH_PAN;\n\n          panStart.set(event.touches[0].pageX, event.touches[0].pageY);\n          break;\n\n        default:\n          state = STATE.NONE;\n      }\n\n      if (state !== STATE.NONE) scope.dispatchEvent(startEvent);\n    }\n\n    function touchmove(event) {\n      if (scope.enabled === false) return;\n\n      event.preventDefault();\n      event.stopPropagation();\n\n      var element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\n      switch (event.touches.length) {\n        case 1: // one-fingered touch: rotate\n          if (scope.enableRotate === false) return;\n          if (state !== STATE.TOUCH_ROTATE) return;\n\n          rotateEnd.set(event.touches[0].pageX, event.touches[0].pageY);\n          rotateDelta.subVectors(rotateEnd, rotateStart);\n\n          // rotating across whole screen goes 360 degrees around\n          constraint.rotateLeft(\n            ((2 * Math.PI * rotateDelta.x) / element.clientWidth) * scope.rotateSpeed\n          );\n          // rotating up and down along whole screen attempts to go 360, but limited to 180\n          constraint.rotateUp(\n            ((2 * Math.PI * rotateDelta.y) / element.clientHeight) * scope.rotateSpeed\n          );\n\n          rotateStart.copy(rotateEnd);\n\n          scope.update();\n          break;\n\n        case 2: // two-fingered touch: dolly\n          if (scope.enableZoom === false) return;\n          if (state !== STATE.TOUCH_DOLLY) return;\n\n          var dx = event.touches[0].pageX - event.touches[1].pageX;\n          var dy = event.touches[0].pageY - event.touches[1].pageY;\n          var distance = Math.sqrt(dx * dx + dy * dy);\n\n          dollyEnd.set(0, distance);\n          dollyDelta.subVectors(dollyEnd, dollyStart);\n\n          if (dollyDelta.y > 0) {\n            constraint.dollyOut(getZoomScale());\n          } else if (dollyDelta.y < 0) {\n            constraint.dollyIn(getZoomScale());\n          }\n\n          dollyStart.copy(dollyEnd);\n\n          scope.update();\n          break;\n\n        case 3: // three-fingered touch: pan\n          if (scope.enablePan === false) return;\n          if (state !== STATE.TOUCH_PAN) return;\n\n          panEnd.set(event.touches[0].pageX, event.touches[0].pageY);\n          panDelta.subVectors(panEnd, panStart);\n\n          pan(panDelta.x, panDelta.y);\n\n          panStart.copy(panEnd);\n\n          scope.update();\n          break;\n\n        default:\n          state = STATE.NONE;\n      }\n    }\n\n    function touchend(/* event */) {\n      if (scope.enabled === false) return;\n\n      scope.dispatchEvent(endEvent);\n      state = STATE.NONE;\n    }\n\n    function contextmenu(event) {\n      event.preventDefault();\n    }\n\n    this.dispose = function () {\n      this.domElement.removeEventListener('contextmenu', contextmenu, false);\n      this.domElement.removeEventListener('mousedown', onMouseDown, false);\n      this.domElement.removeEventListener('mousewheel', onMouseWheel, false);\n      this.domElement.removeEventListener('MozMousePixelScroll', onMouseWheel, false); // firefox\n\n      this.domElement.removeEventListener('touchstart', touchstart, false);\n      this.domElement.removeEventListener('touchend', touchend, false);\n      this.domElement.removeEventListener('touchmove', touchmove, false);\n\n      document.removeEventListener('mousemove', onMouseMove, false);\n      document.removeEventListener('mouseup', onMouseUp, false);\n\n      window.removeEventListener('keydown', onKeyDown, false);\n    };\n\n    this.domElement.addEventListener('contextmenu', contextmenu, false);\n\n    this.domElement.addEventListener('mousedown', onMouseDown, false);\n    this.domElement.addEventListener('mousewheel', onMouseWheel, false);\n    this.domElement.addEventListener('MozMousePixelScroll', onMouseWheel, false); // firefox\n\n    this.domElement.addEventListener('touchstart', touchstart, false);\n    this.domElement.addEventListener('touchend', touchend, false);\n    this.domElement.addEventListener('touchmove', touchmove, false);\n\n    window.addEventListener('keydown', onKeyDown, false);\n\n    // force an update at start\n    this.update();\n  }\n\n  OrbitControls.prototype = Object.create(THREE.EventDispatcher.prototype);\n  OrbitControls.prototype.constructor = OrbitControls;\n\n  Object.defineProperties(OrbitControls.prototype, {\n    object: {\n      get: function () {\n        return this.constraint.object;\n      },\n    },\n\n    target: {\n      get: function () {\n        return this.constraint.target;\n      },\n\n      set: function (value) {\n        console.warn('THREE.OrbitControls: target is now immutable. Use target.set() instead.');\n        this.constraint.target.copy(value);\n      },\n    },\n\n    minDistance: {\n      get: function () {\n        return this.constraint.minDistance;\n      },\n\n      set: function (value) {\n        this.constraint.minDistance = value;\n      },\n    },\n\n    maxDistance: {\n      get: function () {\n        return this.constraint.maxDistance;\n      },\n\n      set: function (value) {\n        this.constraint.maxDistance = value;\n      },\n    },\n\n    minZoom: {\n      get: function () {\n        return this.constraint.minZoom;\n      },\n\n      set: function (value) {\n        this.constraint.minZoom = value;\n      },\n    },\n\n    maxZoom: {\n      get: function () {\n        return this.constraint.maxZoom;\n      },\n\n      set: function (value) {\n        this.constraint.maxZoom = value;\n      },\n    },\n\n    minPolarAngle: {\n      get: function () {\n        return this.constraint.minPolarAngle;\n      },\n\n      set: function (value) {\n        this.constraint.minPolarAngle = value;\n      },\n    },\n\n    maxPolarAngle: {\n      get: function () {\n        return this.constraint.maxPolarAngle;\n      },\n\n      set: function (value) {\n        this.constraint.maxPolarAngle = value;\n      },\n    },\n\n    minAzimuthAngle: {\n      get: function () {\n        return this.constraint.minAzimuthAngle;\n      },\n\n      set: function (value) {\n        this.constraint.minAzimuthAngle = value;\n      },\n    },\n\n    maxAzimuthAngle: {\n      get: function () {\n        return this.constraint.maxAzimuthAngle;\n      },\n\n      set: function (value) {\n        this.constraint.maxAzimuthAngle = value;\n      },\n    },\n\n    enableDamping: {\n      get: function () {\n        return this.constraint.enableDamping;\n      },\n\n      set: function (value) {\n        this.constraint.enableDamping = value;\n      },\n    },\n\n    dampingFactor: {\n      get: function () {\n        return this.constraint.dampingFactor;\n      },\n\n      set: function (value) {\n        this.constraint.dampingFactor = value;\n      },\n    },\n\n    // backward compatibility\n\n    noZoom: {\n      get: function () {\n        console.warn('THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.');\n        return !this.enableZoom;\n      },\n\n      set: function (value) {\n        console.warn('THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.');\n        this.enableZoom = !value;\n      },\n    },\n\n    noRotate: {\n      get: function () {\n        console.warn(\n          'THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.'\n        );\n        return !this.enableRotate;\n      },\n\n      set: function (value) {\n        console.warn(\n          'THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.'\n        );\n        this.enableRotate = !value;\n      },\n    },\n\n    noPan: {\n      get: function () {\n        console.warn('THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.');\n        return !this.enablePan;\n      },\n\n      set: function (value) {\n        console.warn('THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.');\n        this.enablePan = !value;\n      },\n    },\n\n    noKeys: {\n      get: function () {\n        console.warn('THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.');\n        return !this.enableKeys;\n      },\n\n      set: function (value) {\n        console.warn('THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.');\n        this.enableKeys = !value;\n      },\n    },\n\n    staticMoving: {\n      get: function () {\n        console.warn(\n          'THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.'\n        );\n        return !this.constraint.enableDamping;\n      },\n\n      set: function (value) {\n        console.warn(\n          'THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.'\n        );\n        this.constraint.enableDamping = !value;\n      },\n    },\n\n    dynamicDampingFactor: {\n      get: function () {\n        console.warn(\n          'THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.'\n        );\n        return this.constraint.dampingFactor;\n      },\n\n      set: function (value) {\n        console.warn(\n          'THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.'\n        );\n        this.constraint.dampingFactor = value;\n      },\n    },\n  });\n\n  return OrbitControls;\n};\n"],"sourceRoot":""}